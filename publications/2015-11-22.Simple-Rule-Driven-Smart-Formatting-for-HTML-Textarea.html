<!DOCTYPE html>
<!-- saved from url=(0095)https://www.codeproject.com/Articles/1058628/Simple-Rule-Driven-Smart-Formatting-for-HTML-Texta -->
<html lang="en" data-lt-installed="true"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

	
	<link rel="preconnect" href="https://www.google-analytics.com/">

	<link rel="preconnect" href="https://www.codeproject.com/">


	<link rel="preload" href="./Resources/logo250x135.gif" as="image">


	<link rel="preload" href="https://www.codeproject.com/App_Themes/CodeProject/Img/logo135-bg.gif" as="image">
	<link rel="preload" href="./Resources/jquery-3.4.1.min.js.download" as="script" type="text/javascript">


	<title>Simple Rule-Driven Smart Formatting for HTML Textarea- CodeProject</title> 
    
	<link type="text/css" rel="stylesheet" href="./Resources/Article.min.css">


    <script type="text/javascript" async="" src="./Resources/analytics.js.download"></script><script type="text/javascript" src="./Resources/jquery-3.4.1.min.js.download" defer=""></script>
<script type="text/javascript" src="./Resources/article.min.js.download" defer=""></script>

	
<meta http-equiv="content-language" content="en-US">

<meta name="Description" content="JavaScript helps to write code without the usual irritation">
<meta name="Keywords" content="Javascript, HTML">
<meta name="Author" content="Sergey Alexandrovich Kryukov">
<meta name="Rating" content="General">
<meta name="Revisit-After" content="1 days">
<meta name="application-name" content="CodeProject">
<meta name="google-translate-customization" content="d908bb7ce7aff658-4c2f3a504525c916-g629383f736781a8a-13">



<link rel="dns-prefetch" href="https://ajax.googleapis.com/"> 
<link rel="canonical" href="https://www.codeproject.com/Articles/1058628/Simple-Rule-Driven-Smart-Formatting-for-HTML-Texta">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@CodeProject">
<meta name="og:site_name" content="CodeProject">
<meta name="twitter:creator" content="@CodeProject">
<meta property="og:type" content="article">
<meta property="article:published_time" content="11/22/2015 7:01:00 PM">
<meta property="article:modified_time" content="2/3/2021 2:03:00 PM">
<meta name="twitter:label1" content="Written by">
<meta name="twitter:data1" content="Sergey Alexandrovich Kryukov">
<meta name="twitter:label2" content="Reading time">
<meta name="twitter:data2" content="11 min read">
<meta property="og:url" content="https://www.codeproject.com/Articles/1058628/Simple-Rule-Driven-Smart-Formatting-for-HTML-Texta">
<meta property="og:title" content="Simple Rule-Driven Smart Formatting for HTML Textarea">
<meta property="og:description" content="JavaScript helps to write code without the usual irritation">


<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="apple-touch-icon" sizes="144x144" href="https://www.codeproject.com/favicon/apple-touch-icon.png"> 
<link rel="icon" type="image/png" sizes="32x32" href="https://www.codeproject.com/favicon/favicon-32x32.png"> 
<link rel="icon" type="image/png" sizes="16x16" href="https://www.codeproject.com/favicon/favicon-16x16.png"> 
<link rel="manifest" href="https://www.codeproject.com/favicon/manifest.json"> 
<link rel="mask-icon" href="https://www.codeproject.com/favicon/safari-pinned-tab.svg" color="#ff9900">
	<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "TechArticle",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.codeproject.com/Articles/1058628/Simple-Rule-Driven-Smart-Formatting-for-HTML-Texta"
   },
  "name": "Simple Rule-Driven Smart Formatting for HTML Textarea",
  "headline": "Simple Rule-Driven Smart Formatting for HTML Textarea",
  "url": "https://www.codeproject.com/Articles/1058628/Simple-Rule-Driven-Smart-Formatting-for-HTML-Texta",
  "discussionUrl": "#_comments",
  "isFamilyFriendly": "true",
  "image": "https://www.codeproject.com/App_Themes/CodeProject/Img/Article100.png",
  "keywords": "Javascript,HTML",
  "commentCount": "0",
  "editor" : {
    "@type" : "Person",
    "name" : "Editor",
    "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=2291164"
  },
  "license": "http://www.codeproject.com/info/cpol10.aspx",
  "publisher" : {
    "@type" : "Organization",
    "name" : "CodeProject"
  },
  "description": "JavaScript helps to write code without the usual irritation",
  "articleSection": "HTML",
  "author" : [{
      "@type" : "Person",
      "name" : "Sergey Alexandrovich Kryukov",
      "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=2291164"
    }],
  "datePublished": "2015-11-22",
  "dateCreated": "2015-11-22",
  "dateModified": "2021-02-03"
,
  "contentRating" : {
    "@type" : "Rating",
    "ratingValue" : 5.00,
    "bestRating" : 5,
    "worstRating" : 1
  }
}</script>

<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
    "@type": "ListItem",
    "position": 1,
    "item" : {
      "@id" : "/script/Content/Tag.aspx?tags=web",
      "name" : "web"
    }
  },{
    "@type": "ListItem",
    "position": 2,
    "item" : {
      "@id" : "/script/Content/Tag.aspx?tags=HTML",
      "name" : "HTML"
    }
  }]
}</script>

<script type="text/javascript">
function defrm () { /* thanks twitter */
    document.write = '';
    window.top.location = window.self.location;
    setTimeout(function() { document.body.innerHTML = ''; }, 0);
    window.self.onload = function(evt) { document.body.innerHTML = ''; };
}

if (window.top !== window.self) {
    try {
        if (window.top.location.host) { /* will throw for all except chrome */ }
        else { defrm(); /* chrome */ }
    } catch (ex) { defrm(); /* everyone else */ }
}

// Specific case where a site is screwing with us.
if (typeof(DemoUrl) !== 'undefined') {
    document.write(unescape('%3Cme') + 'ta http' + '-equiv="re' + 'fresh con' +
                           'tent="1;url=' + DemoUrl + unescape('"%3CE'));
}
</script>
	





    <script async="" type="text/javascript" src="./Resources/js"></script>
    <script type="text/javascript">
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-1735123-1' , {'user_id': '42a7d533-9829-4f88-8fc6-84dc936250c9'});
    </script>

<style type="text/css"></style></head>	

<body class="chrome chrome120" data-new-gr-c-s-check-loaded="14.1215.0" data-gr-ext-installed="">



<a class="access-link" href="#Main"><img alt="Click here to Skip to main content" src="./Resources/t.gif"></a>




<div class="page-background">

	
	

	

	
    <div id="ctl00_STM" class="site-top-menu fixed narrow">
        <div class="main-content">
            

<div class="container memberbar clearfix flex-container flex-extend">

	<div id="ctl00_MemberBar_GenInfo" class="flex-item align-left">65,938 articles</div>
	
	<div id="ctl00_MemberBar_ChangeNotice" class="flex-item align-left">CodeProject
	is changing. <a href="https://www.codeproject.com/info/Changes.aspx">Read more</a>.</div>

	<div class="flex-item">
		
	</div>

	<div class="flex-item align-right">

		

		

		
	</div>
</div>
        </div>
    </div>

	
    <div id="ctl00_SH" class="site-header fixed narrow">
        <div class="main-content">
            <div class="logo"><a href="https://www.codeproject.com/"><img id="ctl00_Logo" tabindex="1" title="CodeProject" src="./Resources/logo250x135.gif" alt="Home" style="height:135px;width:250px;border-width:0px;"></a></div>
            <div class="promo"></div>
        </div>
    </div>

	
			
	

	<div id="A" class="container-content-wrap fixed narrow"> 

	<div class="container-content">

        
		<div class="clearfix">
			<div class="container-breadcrumb float-left ">
				<div><a rel="nofollow" href="https://www.codeproject.com/script/Content/SiteMap.aspx">Articles</a> / <a rel="nofollow" href="https://www.codeproject.com/script/Content/Tag.aspx?tags=web">web</a> / <a rel="nofollow" href="https://www.codeproject.com/script/Content/Tag.aspx?tags=HTML">HTML</a></div>
			</div>

            <div class="float-left">
				
			</div>

			<div class="edit-links float-right">
				



 
&nbsp;










			</div>

			<div class="article-nav float-right">
				


<div style="display:inline-block;position:relative;top:-6px;margin-right:20px">
    
</div>



 

<a id="ctl00_ActionLinks_PrintMd" data-tooltip="Print" data-enabletooltip="true" data-width="auto" href="https://www.codeproject.com/Articles/1058628/Simple-Rule-Driven-Smart-Formatting-for-HTML-Texta?display=Print" class="tooltip" title="">
   <img src="./Resources/print48.png" width="24" height="24" style="border:0">
<div class="speech-bubble-container-up" style="width:auto">  <div class="speech-bubble-up" style="text-align:center"> Print</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>



<span id="ctl00_ActionLinks_R">
    
    
</span>
			</div>
		</div>

        
		<div class="extended article-container-parts">

			
		    
            

			
			<div id="AT" class="article-container  fixed narrow" style="max-width:inherit;"> 

				<div class="article">

					<form name="aspnetForm" method="post" action="https://www.codeproject.com/Articles/1058628/View.aspx" id="aspnetForm" style="margin:0;padding:0">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="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">
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="10C1FD69">
</div>

					
					 
					<div class="header">
					    <a name="Main"></a>
					    <a name="_articleTop" id="_articleTop"></a>

					    
						<div>
							<span id="ctl00_TagListHorz_TagWrp" class="tags horizontal">

	
	

	
	<span id="ctl00_TagListHorz_VisibleTags"><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/Javascript" data-id="87">Javascript</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/HTML" data-id="104">HTML</a></div></span> 

	
	
</span>


						</div>
					    <div class="title">
					        <h1 id="ctl00_ArticleTitle">Simple Rule-Driven Smart Formatting for HTML Textarea</h1>
					    </div>

                        <div>
					        
					        <div class="entry flex-container">

								

                                <div class="flex-item" style="flex:1 1 auto">
                                    <div class="flex-container" style="justify-content:space-between;flex-wrap:wrap-reverse">
                                       <span id="ctl00_Authors" class="author flex-item"><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=2291164" rel="author">Sergey Alexandrovich Kryukov</a></span> 

                                        <div class="flex-item" style="margin-top:-4px;">
                                            <div id="ctl00_RateArticle_RatingTable" class="small-text" data-objectref="2_1058628">

	<meta itemprop="upvoteCount" content="16">


	<div id="ctl00_RateArticle_RatingRow" class="flex-container rating-container large-stars">

					
		

		
		<div class="nowrap tooltip">

			
			<div id="ctl00_RateArticle_ResultNoHist" class="rating-result"><div class="flex-container rating-stars large-stars"><div><img src="./Resources/star-fill-lg.png" style="width:24px;height:24px"></div><div><img src="./Resources/star-fill-lg.png" style="width:24px;height:24px"></div><div><img src="./Resources/star-fill-lg.png" style="width:24px;height:24px"></div><div><img src="./Resources/star-fill-lg.png" style="width:24px;height:24px"></div><div><img src="./Resources/star-fill-lg.png" style="width:24px;height:24px"></div></div></div>
			

			
			

			
            

			
                

		</div>
		
	
		
		<div id="ctl00_RateArticle_VoteCountNoHist" class="rating-votes nowrap">5.00/5  (16 votes)</div>	

		

		
		<div class="rating-undo" title="Undo vote" style="margin-left:5px;display:none"></div>

		
		
	</div>

	
	

</div>

                                        </div>
                                    </div>

                                    <div class="flex-container" style="color:#666;font-size:smaller">
                                        <span id="ctl00_LastUpdated" class="date flex-item-tight" title="Date last updated">22 Nov 2015</span><a id="ctl00_LicenseLink" title="The Code Project Open License (CPOL)" class="license flex-item-tight" href="http://www.codeproject.com/info/cpol10.aspx">CPOL</a><span id="ctl00_ReadingTime" class="stats flex-item-tight">11 min read</span><span id="ctl00_HorizontalStats" class="stats flex-item-tight"><span class="stats"><span title="Views"><img src="./Resources/views32.png" style="width:16px"> 30.6K</span> &nbsp; <span title="Downloads"><img src="./Resources/download32.webp" style="width:16px"> 265</span> &nbsp; </span></span>
                                    </div>
                                </div>
					        </div>

                            

                        </div>

                        <div id="ctl00_DescriptionSpot" class="summary">JavaScript helps to write code without the usual irritation</div><span id="ctl00_ThumbnailUrl" class="date" content="https://www.codeproject.com/script/Articles/Images/article100x80.png"></span>			

                    </div>
                    
					
					

					

					
					

					
					

						
					

					

						
						<div id="contentdiv" class="text">
						



<!-- Article Starts -->

<ul class="download">
	<li><a href="Simple-Rule-Driven-Smart-Formatting-for-HTML-Textarea.zip" style="outline-width: 0px !important; user-select: auto !important;">Download SmartFormatting.zip — 5.9 KB</a></li></ul>

<p><img title="Visual Studio view" alt="2015-11-22.Simple-Rule-Driven-Smart-Formatting-for-HTML-Textarea.webp" src="./Resources-articles/2015-11-22.Simple-Rule-Driven-Smart-Formatting-for-HTML-Textarea.webp"/></p>

<h2>Contents</h2>

<ol>
    <li><a href="#a1">Motivation</a></li>    <li><a href="#a2">Rule Set</a></li>    <li><a href="#a3">Bra and Ket</a></li>    <li><a href="#a4">Indent</a></li>    <li><a href="#a5">Auto Bracket</a></li>    <li><a href="#a6">Tidy</a></li>    <li><a href="#a7">Auto-Completion</a></li>    <li><a href="#a8">Features</a></li>    <li><a href="#a9">Live Demo</a></li>    <li><a href="#a10">Conclusion</a></li></ol>

<h2 id="a1">1 Motivation</h2>

<p>In one interesting book on industrial design, I found an advice which did not look too obvious: make <code>textarea</code> elements on a Web page bigger, because most users are not software engineers; they won't just paste text in the <code>textarea</code> as you would do, most of them will actually type text there. At that time, I did not expect that I would be spending considerable time at typing text into a <code>textarea</code> myself, but present days I really do it pretty often: I enter and test some JavaScript code, as if Visual Studio wasn't enough :-). On a regular basis, I use my JavaScript calculator, because it helps me writing small scripts and trying them out faster. I really made it convenient enough, at least for myself.</p>

<p>And yet, I finally lost my patience, and quickly figured out the reason of my irritation. This is the lack of so called "smart indent", like in Visual Studio and some other IDE (hence the picture on the top of the present article). One small thing, one would say, but it really makes the difference. Note the lack of the tabulator, because Tab is busy with navigation on the page, and taking this function out would be a totally wrong thing. With "smart indent", such problem becomes insignificant. And, with this important feature, some less important ones would come in nicely, first of all, some tidy-up of the entered text, which is, first of all, fixing the blank spaces.</p>

<p>So, with my patience supply depleted, I decided to fill in the gap. I did not find available code which would satisfy me, not even remotely, only some ideas. But, come to think about, <code>textarea</code> is used everywhere, and yet it provides too rudimentary text entering facility to be bearable; at the same time, it's not at all hard to manipulate text input with JavaScript. Let's see how simple it can be.</p>

<p>But first of all,</p>

<blockquote class="FQ">
<div class="FQA"><big>Disclaimer:</big></div>

<p>The script presented in this article is extremely simple and does not pretend to play the role of any comprehensive text or language processor for any programming language. It is not context-sensitive, is fully unaware of language syntax or semantics and does not provide anything like syntax coloring. It applies to a pure-text <code>textarea</code>. The main goal is simplicity, rudimentary level of convenience, the ease of customization and absence of any 3rd-party code.</p>
</blockquote>

<p>I used the code described in the present article in the second version of my <a href="http://www.codeproject.com/Articles/890109/JavaScript-Calculator,%20http://sakryukov.org/freeware/calculator"><u>JavaScript Calculator</u></a>. Also, I used it in its spin-off "JavaScript Playground" I use for demonstration of JavaScript code samples. Such sample demonstrations can be found in my recent articles on passing function arguments by name: <a href="http://www.codeproject.com/Articles/1045966/Named-Arguments-for-JavaScript-Functions-Yet-Anoth"><u>Named Arguments for JavaScript Functions</u></a> and <a href="http://www.codeproject.com/Articles/1047623/Named-Arguments-for-JavaScript-Functions-Part-Two"><u>Yet Another Approach and Named Arguments for JavaScript Functions, Part Two: Going Structured</u></a>.</p>

<h2 id="a2">2 Rule Set</h2>

<p>The whole solution can be found in the code provided with this article. It is presented in just two files, "index.html" and "smartFormatting.js", where all the universal part of code is placed in the JavaScript file, as just one function, <code>setSmartFormatting</code>, and "index.html", also with some JavaScript code, is only the usage sample.</p>

<p>As all the text handling is set up in this only function, there is no a function used to switch text handling off, and there is no any need for that. Instead, this function can be called again and again with the same <code>textarea</code> argument, with different options. All <code>textarea</code> event handlers will be removed if the so is defined by the option set.</p>

<p>All the implemented formatted behavior is controlled by the set of rules described by the object <code>defaultOptions</code>. Some or all rules of this default rule set can be overridden by the user. The key to the understanding of the procedure of such customization is explained in my previous article, <a href="http://www.codeproject.com/Articles/1045966/Named-Arguments-for-JavaScript-Functions-Yet-Anoth"><u>Named Arguments for JavaScript Functions</u></a>, but the basis usage can be understood on the usage example shown in "index.html".</p>

<p>By customization of the rules, the user can adopt the rules pretty widely to different needs, first of all, to different languages or coding styles. My default option set is oriented to JavaScript programming.</p>

<p>The outline of the rule sets can be shown like this:</p>

<div class="pre-lang" id="premain667276"><div>JavaScript</div><div class="pre-action-link"><span class="code-collapse" data-index="667276" id="preShrink667276">Shrink ▲</span> &nbsp; <span id="copycode667276" class="copy-code" data-index="667276" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre667276" style="margin-top:0;" class="lang-javascript notranslate" data-language="JavaScript" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-keyword">const</span> defaultOptions = {
    features: {
        <span class="code-comment">//</span><span class="code-comment"> the members define which sets of rules to apply</span>
        <span class="code-comment">//</span><span class="code-comment"> also define tab characters</span>
    },
    formattingRules: {
        indent: [
            <span class="code-comment">//</span><span class="code-comment"> smart indent rules</span>
        ],
        autoBracket: [
            <span class="code-comment">//</span><span class="code-comment"> automatically adding closing brackets</span>
        ],
        tidy: [
            <span class="code-comment">//</span><span class="code-comment"> replacement of some characters/words with other words</span>
            <span class="code-comment">//</span><span class="code-comment"> to improve readability of text</span>
        ],
        tidyVerbatim: [
            <span class="code-comment">//</span><span class="code-comment"> define exclusions for tidy rule,</span>
            <span class="code-comment">//</span><span class="code-comment"> to treat content inside string literals verbatim </span>
        ],
        autoComplete: [
            <span class="code-comment">//</span><span class="code-comment"> define text patterns which can optionally be auto-completed</span>
            <span class="code-comment">//</span><span class="code-comment"> after some part of them is entered</span>
        ]
    }
}</pre>

<p>See the full rule set in "smartFormatting.js" for all the detail. Below, I'll explain the usage of each rule.</p>

<h2 id="a3">3 Bra and Ket</h2>

<p>First, I wanted to clarify on the object naming used in big part of the rules. Not only it's just convenient naming for parts of brackets, but also it's a tribute to the notation used in quantum mechanics, introduced in 1939 by <a href="https://en.wikipedia.org/wiki/Paul_Dirac"><u>Paul Dirac</u></a>: <a href="https://en.wikipedia.org/wiki/Bra%E2%80%93ket_notation"><u>https://en.wikipedia.org/wiki/Bra%E2%80%93ket_notation</u></a>.</p>

<h2 id="a4">4 Indent</h2>

<p>Indent rules are the most practically important rules, those I started this whole activity. This is a couple of rules for the same very "smart indent" feature. The default rule shows two identical rules for pair of brackets: [] and {}:</p>

<div class="pre-lang" id="premain471210"><div>JavaScript</div><div class="pre-action-link"><span id="copycode471210" class="copy-code" data-index="471210" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre471210" style="margin-top:0;" class="lang-javascript notranslate" data-language="JavaScript" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true">{
    bra: <span class="code-string">"</span><span class="code-string">["</span>, ket: <span class="code-string">"</span><span class="code-string">]"</span>,
    endOfLineKet: <span class="code-keyword">true</span>, matchLeftWord: <span class="code-keyword">false</span>, matchRightWord: <span class="code-keyword">false</span>
}</pre>

<p>These rules define smart indent created on the press of the Enter key when the text <i>insertion point</i>. Boolean elements of the rule certainly need some explanations.</p>

<p>First one, <code>endOfLineKet</code>, means that the second pair of bracket (<code>bra</code>, ']' in this example) can be missing, and yet smart indent will be applied if the insertion point is located exactly at the end of line. In other words, the line ends with '[' and the insertion point is placed at the end line. I hope the need for this option is obvious: it is needed when one need to add a new indented line after the bracket, such as in</p>

<p>&nbsp;</p>

<div class="pre-lang" id="premain245390"><div> </div><div class="pre-action-link"><span id="copycode245390" class="copy-code" data-index="245390" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre245390" style="margin-top:0;" data-language="text" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">const myArray = [
    |
    2,
    3];</pre>

<p>In all input text samples, I will denote insertion point with the symbol '|'. In this example, it shows the result of smart formatting, just after the key Enter is pressed. It is helpful when you first added 2 and 3 to some array, and decided to add 1 later.</p>

<p>The other two rule elements, <code>matchLeftWord</code> and <code>matchRightWord</code>, are related to the concept "<i>match whole world</i>". When such option is set to true, it means that the bra or key words would only enable smart indent if they stay separate, separated by one of <i>space characters</i> from the rest of text. In other words, for example,</p>

<div class="pre-lang" id="premain823590"><div> </div><div class="pre-action-link"><span id="copycode823590" class="copy-code" data-index="823590" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre823590" style="margin-top:0;" data-language="text" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">// If matchLeftWord and matchRightWord are true,
// smart indent won't be done with this
const myObject = someArray[|]
// or this line:
const myObject = someArray [|];
// but will be applied to 
const myObject = someArray [|] ?</pre>

<p>In my default rule set, I don't use these two options, that is, always use smart indent when Enter is pressed between <code>bra</code> and <code>ket</code>.</p>

<p>Now, how this kind of formatting can produce smart indentation, and, importantly, nested indentation usually used in program texts? This is done based on the indentation of present or the next line, which is determined by the set of leftmost blank space and/or tab characters in that line. When you press Enter between <code>bra</code> and <code>ket</code> on a line without indentation, it creates two new lines, with indentation of the first one and <code>ket</code> on the last one. Type on this line and Enter between bra and key again, and new indentation is added to existing indentation. The added indentation is defined by the property <code>features</code> of the option set, see the section <a href="#a8"><u>Features</u></a>.</p>

<p>The implementation of smart indentation is fairly simple. The existing indentation is detected by the function <code>countTabs(string)</code>. All the rules are implemented based on parsing of the existing <code>textarea</code> text into the object which carries the insertion point location and text elements on left and write to this point: character, word and line. This is done be the function <code>parseCursorContext</code>:</p>

<div class="pre-lang" id="premain810087"><div>JavaScript</div><div class="pre-action-link"><span id="copycode810087" class="copy-code" data-index="810087" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre810087" style="margin-top:0;" class="lang-javascript notranslate" data-language="JavaScript" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-keyword">const</span> parseCursorContext = editor =&gt; {
    <span class="code-keyword">const</span> pos = getCursor(editor);
    <span class="code-keyword">const</span> allText = editor.value;
    <span class="code-keyword">let</span> leftChar = allText[pos - <span class="code-digit">1</span>];
    <span class="code-keyword">let</span> rightChar = allText[pos];
    leftChar = allText[pos - <span class="code-digit">1</span>];
    rightChar = allText[pos];
    <span class="code-keyword">if</span> (!leftChar) <span class="code-keyword">return</span>;
    <span class="code-keyword">let</span> left = allText.substring(<span class="code-digit">0</span>, pos);
    <span class="code-keyword">let</span> right = allText.substring(pos);
    <span class="code-keyword">const</span> rightmost = right.indexOf(newLine);
    <span class="code-keyword">if</span> (rightmost &gt;= <span class="code-digit">0</span>)
        right = right.substr(<span class="code-digit">0</span>, rightmost);
    <span class="code-keyword">const</span> leftmost = left.lastIndexOf(newLine);
    <span class="code-keyword">if</span> (leftmost &gt;= <span class="code-digit">0</span>)
	left = left.substr(leftmost + newLine.length, pos);
    <span class="code-keyword">const</span> leftWord = findWords(left, <span class="code-keyword">false</span>);
    <span class="code-keyword">const</span> rightWord = findWords(right, <span class="code-keyword">true</span>);
    <span class="code-keyword">return</span> {
        cursor: pos,
        left: { char: leftChar, word: leftWord, line: left },
        right: { char: rightChar, word: rightWord, line: right }
    };
};</pre>

<p>The most of the rules, including smart formatting, are applied in the event handler <code>keyDownHandler</code>, but the whole set of rules uses the events <code>keydown</code>, <code>keypress</code>, <code>keyup</code>, <code>click</code> and <code>paste</code>. Please see "smartFormatting.js" for complete implementation.</p>

<h2 id="a5">5 Auto Bracket</h2>

<p>Auto bracket rules simply add a ket word immediately after a <code>bra</code> word is entered. It has one additional rule element, <code>endOfLineOnly</code>. I found it very annoying if you already have, for example, the text like "[]" and try to insert index expression inside it. So, in my default rule set, the two formatting rules only apply if one types <code>bra</code> at the end of line.</p>

<h2 id="a6">6 Tidy</h2>

<p>The "tidy" feature, by default, just modifies the set of blank space characters, to make the code look nicer and more readable, but it can define a number of different kinds of replacements. Tidy rules are represented with two arrays of rule objects: <code>tidy</code> and <code>tidyVerbatim</code>. First array is an array of rules for replacement of certain strings with modified strings; in my default set, I use three array elements, for adding a blank space before, after and both sides of target string defined using the array <code>before</code>. The set of rules <code>tidyVerbatim</code> is the set of rules "blocking" application of <code>tidy</code> rules. As my default rule set is designed for JavaScript code, it has just to such rules blocking application of <code>tidy</code> rules inside expressions in quotation marks, ordinary and double. But this is not a very trivial thing.</p>

<p>I use Regular Expression via the native JavaScript <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp"><u>RegExp</u></a> object. However, Regular Expression can be nice to write in many cases, but they are notoriously unreadable and, hence, unsuitable for rule-driven (read: highly customizable) approach. Therefore, I generate Regular Expressions for these rule on the fly, during initialization (once per the call to <code>setSmartFormatting</code>) for each <code>before</code> element of the rule, but I leave Regular Expression syntax in the after element, the one which should substitute the before element when the rule is applied. For example, <code>" $1 "</code> means that the blank space should be added before and after original before word, and <code>" $1"</code> or <code>"$1 "</code> add the blank space only before and after, correspondently. Note that actually one untold rule is applied at the very end: all the blank character is "normalized" to eliminate any duplications. This the implementation of generation of the <code>RegExp</code> objects on the fly out of the array of <code>before</code> elements:</p>

<div class="pre-lang" id="premain463856"><div>JavaScript</div><div class="pre-action-link"><span id="copycode463856" class="copy-code" data-index="463856" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre463856" style="margin-top:0;" class="lang-javascript notranslate" data-language="JavaScript" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-keyword">const</span> tidyRegex = (<span class="code-keyword">function</span> createRegexTidyRules(rules) {
    <span class="code-keyword">const</span> regex = [];
    <span class="code-keyword">for</span> (<span class="code-keyword">let</span> rule <span class="code-keyword">in</span> rules) {
        <span class="code-keyword">const</span> newRule = { before: constants.empty, after: rules[rule].after };
        <span class="code-keyword">for</span> (<span class="code-keyword">let</span> wordIndex = <span class="code-digit">0</span>; wordIndex &lt; rules[rule].before.length; ++wordIndex) {
            <span class="code-keyword">let</span> word = constants.empty;
            <span class="code-keyword">for</span> (<span class="code-keyword">let</span> charIndex <span class="code-keyword">in</span> rules[rule].before[wordIndex])
                word += <span class="code-string">"</span><span class="code-string">\\"</span> + rules[rule].before[wordIndex][charIndex];
            <span class="code-keyword">if</span> (newRule.before != constants.empty)
                newRule.before += <span class="code-string">"</span><span class="code-string">|"</span>;
            newRule.before += word;
        } <span class="code-comment">//</span><span class="code-comment">loop word</span>
        newRule.before = <span class="code-string">"</span><span class="code-string">("</span> + newRule.before + <span class="code-string">"</span><span class="code-string">)"</span>;
        newRule.before = <span class="code-keyword">new</span> RegExp(newRule.before, <span class="code-string">"</span><span class="code-string">g"</span>);
        regex.push(newRule);
    } <span class="code-comment">//</span><span class="code-comment">loop rule</span>
    <span class="code-keyword">return</span> regex;
})(options.formattingRules.tidy);</pre>

<p>These rules are also applied on the press of the Enter key.</p>

<p>Likewise, Regular Expressions are generated on the fly out of the <code>tidyVerbatim</code> rules. These rules just define the brackets marking the context where the tidy rules should not be applied:</p>

<div class="pre-lang" id="premain475251"><div>JavaScript</div><div class="pre-action-link"><span id="copycode475251" class="copy-code" data-index="475251" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre475251" style="margin-top:0;" class="lang-javascript notranslate" data-language="JavaScript" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true">{ bra: <span class="code-string">"</span><span class="code-string">/*"</span>, ket: <span class="code-string">"</span><span class="code-string">*/"</span> },
{ bra: <span class="code-string">"</span><span class="code-string">//"</span>, ket: <span class="code-keyword">null</span> },
{ bra: <span class="code-string">"</span><span class="code-string">'"</span>, ket: <span class="code-string">"</span><span class="code-string">'"</span> },
{ bra: <span class="code-string">"</span><span class="code-string">`"</span>, ket: <span class="code-string">"</span><span class="code-string">`"</span> },
{ bra: <span class="code-string">"</span><span class="code-string">\""</span>, ket: <span class="code-string">"</span><span class="code-string">\""</span> }</pre>

<p>When a Regular Expression is created out of these declarations,
it is assumed that <code>bra == null</code> denotes the match with the start of a line and <code>key == null</code> — with the end of a line.
In these cases, unescaped <i>line anchors</i> are used, caret (^) or dollar ($), respectively.
</p>

<h2 id="a7">7 Auto-Completion</h2>

<p>Auto-complete rules define the pattern which can be complete based on partially entered text. Let's consider just one example:</p>

<div class="pre-lang" id="premain124401"><div>JavaScript</div><div class="pre-action-link"><span id="copycode124401" class="copy-code" data-index="124401" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre124401" style="margin-top:0;" class="lang-javascript notranslate" data-language="JavaScript" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true">{ pattern: <span class="code-string">"</span><span class="code-string">do* {|} while ()"</span>, breakPoint: <span class="code-string">"</span><span class="code-string">*"</span>, insertPoint: <span class="code-string">"</span><span class="code-string">|"</span> }</pre>

<p>This is just the desired complete text defined by the rule element <code>pattern</code>. In its string values, two "special" characters are used: '*' is used to mark the place where the feature becomes available after the left part of pattern is entered; then the write part is added; and '|' character defines where the insertion point should be moved after auto-completed text is added. But what to do if one or both of these characters needs to be a part of the pattern? For this purpose, they are made optional, through two other rule elements, <code>breakPoint</code> and <code>insertPoint</code>.</p>

<p>Auto-completion is also performed on the press on the Enter key. To show the user when this option is active, the function <code>setSmartFormatting</code> has the function parameter <code>autoCompleteMatchNotification</code>. Then the user has three options: 1) ignore it and keep typing; if the pattern is still matching, auto-completion still can be used, 2) press Enter to perform auto-complete; 3) press Escape. The only practical need to Escape is actually the need to allow the user to press Enter without auto-completion, to utilize the default Enter function.</p>

<h2 id="a8">8 Features</h2>

<p>This element of the rule set simply defines which sets of rules should be applied. For smart indentation rules, the indentation characters are also defined. Notably, they are only applied for newly entered text. In other words, already typed text is never modified. However, it looks can change, in case tab characters are contained in existing text. It happens because <code>tabSize</code> is also set for tab characters; and this is done via the <code>textarea</code> style. I hope the structure of this object is self-explanatory:</p>

<div class="pre-lang" id="premain516768"><div>JavaScript</div><div class="pre-action-link"><span id="copycode516768" class="copy-code" data-index="516768" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre516768" style="margin-top:0;" class="lang-javascript notranslate" data-language="JavaScript" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true">features: {
    useSmartIndent: <span class="code-keyword">true</span>, useTabs: <span class="code-keyword">true</span>, tabSize: <span class="code-digit">4</span>,
    useAutoBracket: <span class="code-keyword">true</span>, useTidy: <span class="code-keyword">true</span>, useCodeCompletion: <span class="code-keyword">true</span>
}</pre>

<h2 id="a9">9 Live Demo</h2>

<p>For the application of the Smart Formatting, please see the Live Demo of <a href="https://sakryukov.github.io/javascript-playground/JavaScript.Playground">JavaScript Playground</a>
and <a href="https://sakryukov.github.io/javascript-playground/demo.playgroundAPI/">Playground API demo</a>.</p>

<p>See also the Code Project article <i><a href="https://www.codeproject.com/Articles/5291705/JavaScript-Playground">JavaScript Playground</a></i>.</p>

<h2 id="a10">10 Conclusion</h2>

<p>It just works. My irritation vanished as I refined the rules and their implementation step by step. I hope the behavior won't irritate my readers and even may look convenient. I will be much grateful for reasonably argumentative criticism (not necessarily constructive) and any suggestions.</p>

<!-- Article Ends -->


						</div>
						

						
						<h2>License</h2>
						<div id="LicenseTerms"><p>This article, along with any associated source code and files, is licensed under <a href="http://www.codeproject.com/info/cpol10.aspx" rel="license">The Code Project Open License (CPOL)</a></p></div>
						

						
						<br>
						
						    <br>
						
						

						<div class="clearfix"></div>

						<div style="padding-top:8px">
							
						</div>

					

				    
					</form>

				</div>

				
				<div class="bottom-promo"> 
				    
				</div>
				
                
                

				
				
				

			</div>
			

            
            
            

        </div>
        

		
		<div class="site-footer">
			<div class="align-left">
				<a id="ctl00_PermaLink" href="https://www.codeproject.com/Articles/1058628/Simple-Rule-Driven-Smart-Formatting-for-HTML-Texta">Permalink</a><br>
				<br>
				<a id="ctl00_PrivacyLink" href="https://www.codeproject.com/info/privacy.aspx">Privacy</a><br>
    			<a id="ctl00_CookiePolicyLink" href="https://www.codeproject.com/info/cookie.aspx">Cookies</a><br>
                <a id="ctl00_TermsOfUseLink" href="https://www.codeproject.com/info/TermsOfUse.aspx">Terms of Use</a><br>
			</div>

            <div class="align-center">
				


<div class="page-width">
    Layout: <a id="ctl00_PageWidth_FixedT" title="Fixed width layout" rel="nofollow" class=" active" href="https://www.codeproject.com/Articles/1058628/Simple-Rule-Driven-Smart-Formatting-for-HTML-Texta?PageFlow=FixedWidth">fixed</a>
    |
    <a id="ctl00_PageWidth_FluidT" title="Fluid layout" rel="nofollow" href="https://www.codeproject.com/Articles/1058628/Simple-Rule-Driven-Smart-Formatting-for-HTML-Texta?PageFlow=Fluid">fluid</a>
</div>


				

				

	            

                <br>
			</div>
                
			<div class="align-right">
				Article Copyright 2015 by Sergey Alexandrovich Kryukov<br>Everything else
				Copyright © <a href="mailto:webmaster@codeproject.com">CodeProject</a>, 1999-2024<br>
                <br>
				Web01 
				2.8:2024-12-08:1<br>
			</div>
		</div>
		

		<br clear="all">
		
			

	</div> 
	</div> 
</div>







<script type="text/javascript"> // DEFERRED script

document.addEventListener('DOMContentLoaded', function() {

	new CodeBlocks().initialise('#contentdiv');
	
	$('.author-wrapper .description').shorten({showChars: 400});
	
	anchorAnimate();
	
	$('#__EVENTVALIDATION').attr('autocomplete', 'off');

})
</script>










<style type="text/css">.copied::after {  position: absolute;  right: 0;  display: inline-block; white-space: nowrap; content: 'copied'; color: #fff; background-color: #f90;  border-radius: 3px; padding:1px 8px; opacity: 0;  will-change: opacity, transform; animation: showcopied 1.5s ease; } @keyframes showcopied { 0% { opacity: 0; } 70% { opacity: 1; } 100% { opacity: 0; } } </style><canvas id="cv1" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas><canvas id="cv2" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas></body><grammarly-desktop-integration data-grammarly-shadow-root="true"><template shadowrootmode="open"><style>
      div.grammarly-desktop-integration {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
        -moz-user-select: none;
        -webkit-user-select: none;
        -ms-user-select:none;
        user-select:none;
      }

      div.grammarly-desktop-integration:before {
        content: attr(data-content);
      }
    </style><div aria-label="grammarly-integration" role="group" tabindex="-1" class="grammarly-desktop-integration" data-content="{&quot;mode&quot;:&quot;full&quot;,&quot;isActive&quot;:true,&quot;isUserDisabled&quot;:false}"></div></template></grammarly-desktop-integration></html>