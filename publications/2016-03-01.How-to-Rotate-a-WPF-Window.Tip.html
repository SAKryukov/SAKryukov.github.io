<!DOCTYPE html>
<!-- saved from url=(0067)https://www.codeproject.com/Tips/1082137/How-to-Rotate-a-WPF-Window -->
<html lang="en" data-lt-installed="true"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

	
	<link rel="preconnect" href="https://www.google-analytics.com/">

	<link rel="preconnect" href="https://www.codeproject.com/">


	<link rel="preload" href="./Resources/logo250x135.gif" as="image">


	<link rel="preload" href="https://www.codeproject.com/App_Themes/CodeProject/Img/logo135-bg.gif" as="image">
	<link rel="preload" href="./Resources/jquery-3.4.1.min.js.download" as="script" type="text/javascript">


	<title>How to Rotate a WPF Window?- CodeProject</title> 
    
	<link type="text/css" rel="stylesheet" href="./Resources/Article.min.css">


    <script type="text/javascript" async="" src="./Resources/analytics.js.download"></script><script type="text/javascript" src="./Resources/jquery-3.4.1.min.js.download" defer=""></script>
<script type="text/javascript" src="./Resources/article.min.js.download" defer=""></script>

	
<meta http-equiv="content-language" content="en-US">

<meta name="Description" content="In response to an interesting Quick Questions &amp; Answers Inquirer&#39;s request, I&#39;m showing how to create an impression of window rotation in a simple way">
<meta name="Keywords" content="">
<meta name="Author" content="Sergey Alexandrovich Kryukov">
<meta name="Rating" content="General">
<meta name="Revisit-After" content="1 days">
<meta name="application-name" content="CodeProject">
<meta name="google-translate-customization" content="d908bb7ce7aff658-4c2f3a504525c916-g629383f736781a8a-13">



<link rel="dns-prefetch" href="https://ajax.googleapis.com/"> 
<link rel="canonical" href="https://www.codeproject.com/Articles/1082137/How-to-Rotate-a-WPF-Window">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@CodeProject">
<meta name="og:site_name" content="CodeProject">
<meta name="twitter:creator" content="@CodeProject">
<meta property="og:type" content="article">
<meta property="article:published_time" content="3/1/2016 7:27:00 PM">
<meta property="article:modified_time" content="3/1/2016 7:27:00 PM">
<meta name="twitter:label1" content="Written by">
<meta name="twitter:data1" content="Sergey Alexandrovich Kryukov">
<meta property="og:url" content="https://www.codeproject.com/Articles/1082137/How-to-Rotate-a-WPF-Window">
<meta property="og:title" content="How to Rotate a WPF Window?">
<meta property="og:description" content="In response to an interesting Quick Questions &amp; Answers Inquirer&#39;s request, I&#39;m showing how to create an impression of window rotation in a simple way">


<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="apple-touch-icon" sizes="144x144" href="https://www.codeproject.com/favicon/apple-touch-icon.png"> 
<link rel="icon" type="image/png" sizes="32x32" href="https://www.codeproject.com/favicon/favicon-32x32.png"> 
<link rel="icon" type="image/png" sizes="16x16" href="https://www.codeproject.com/favicon/favicon-16x16.png"> 
<link rel="manifest" href="https://www.codeproject.com/favicon/manifest.json"> 
<link rel="mask-icon" href="https://www.codeproject.com/favicon/safari-pinned-tab.svg" color="#ff9900">
	<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "TechArticle",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.codeproject.com/Articles/1082137/How-to-Rotate-a-WPF-Window"
   },
  "name": "How to Rotate a WPF Window?",
  "headline": "How to Rotate a WPF Window?",
  "url": "https://www.codeproject.com/Articles/1082137/How-to-Rotate-a-WPF-Window",
  "discussionUrl": "https://www.codeproject.com/Articles/1082137/How-to-Rotate-a-WPF-Window#_comments",
  "isFamilyFriendly": "true",
  "image": "https://www.codeproject.com/App_Themes/CodeProject/Img/Article100.png",
  "commentCount": "0",
  "editor" : {
    "@type" : "Person",
    "name" : "Editor",
    "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=2291164"
  },
  "publisher" : {
    "@type" : "Organization",
    "name" : "CodeProject"
  },
  "description": "In response to an interesting Quick Questions & Answers Inquirer's request, I'm showing how to create an impression of window rotation in a simple way",
  "author" : [{
      "@type" : "Person",
      "name" : "Sergey Alexandrovich Kryukov",
      "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=2291164"
    }],
  "datePublished": "2016-03-01",
  "dateCreated": "2016-03-01",
  "dateModified": "2016-03-01"
}</script>

<script type="text/javascript">
function defrm () { /* thanks twitter */
    document.write = '';
    window.top.location = window.self.location;
    setTimeout(function() { document.body.innerHTML = ''; }, 0);
    window.self.onload = function(evt) { document.body.innerHTML = ''; };
}

if (window.top !== window.self) {
    try {
        if (window.top.location.host) { /* will throw for all except chrome */ }
        else { defrm(); /* chrome */ }
    } catch (ex) { defrm(); /* everyone else */ }
}

// Specific case where a site is screwing with us.
if (typeof(DemoUrl) !== 'undefined') {
    document.write(unescape('%3Cme') + 'ta http' + '-equiv="re' + 'fresh con' +
                           'tent="1;url=' + DemoUrl + unescape('"%3CE'));
}
</script>
	





    <script async="" type="text/javascript" src="./Resources/js"></script>
    <script type="text/javascript">
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-1735123-1' , {'user_id': '42a7d533-9829-4f88-8fc6-84dc936250c9'});
    </script>

<style type="text/css"></style></head>	

<body class="chrome chrome120" data-new-gr-c-s-check-loaded="14.1215.0" data-gr-ext-installed="">



<a class="access-link" href="#Main"><img alt="Click here to Skip to main content" src="./Resources/t.gif"></a>




<div class="page-background">

	
	

	

	
    <div id="ctl00_STM" class="site-top-menu fixed narrow">
        <div class="main-content">
            

<div class="container memberbar clearfix flex-container flex-extend">

	<div id="ctl00_MemberBar_GenInfo" class="flex-item align-left">65,938 articles</div>
	
	<div id="ctl00_MemberBar_ChangeNotice" class="flex-item align-left">CodeProject
	is changing. <a href="https://www.codeproject.com/info/Changes.aspx">Read more</a>.</div>

	<div class="flex-item">
		
	</div>

	<div class="flex-item align-right">

		

		

		
	</div>
</div>
        </div>
    </div>

	
    <div id="ctl00_SH" class="site-header fixed narrow">
        <div class="main-content">
            <div class="logo"><a href="https://www.codeproject.com/"><img id="ctl00_Logo" tabindex="1" title="CodeProject" src="./Resources/logo250x135.gif" alt="Home" style="height:135px;width:250px;border-width:0px;"></a></div>
            <div class="promo"></div>
        </div>
    </div>

	
			
	

	<div id="A" class="container-content-wrap fixed narrow"> 

	<div class="container-content">

        
		<div class="clearfix">
			<div class="container-breadcrumb float-left ">
				<div><a rel="nofollow" href="https://www.codeproject.com/script/Content/SiteMap.aspx">Articles</a></div>
			</div>

            <div class="float-left">
				
			</div>

			<div class="edit-links float-right">
				



 
&nbsp;










			</div>

			<div class="article-nav float-right">
				


<div style="display:inline-block;position:relative;top:-6px;margin-right:20px">
    
</div>



 

<a id="ctl00_ActionLinks_PrintMd" data-tooltip="Print" data-enabletooltip="true" data-width="auto" href="https://www.codeproject.com/Articles/1082137/How-to-Rotate-a-WPF-Window?display=Print" class="tooltip" title="">
   <img src="./Resources/print48.png" width="24" height="24" style="border:0">
<div class="speech-bubble-container-up" style="width:auto">  <div class="speech-bubble-up" style="text-align:center"> Print</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>



<span id="ctl00_ActionLinks_R">
    
    
</span>
			</div>
		</div>

        
		<div class="extended article-container-parts">

			
		    
            

			
			<div id="AT" class="article-container  fixed narrow" style="max-width:inherit;"> 

				<div class="article">

					<form name="aspnetForm" method="post" action="https://www.codeproject.com/Tips/1082137/View.aspx" id="aspnetForm" style="margin:0;padding:0">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="Z819knmsmrUaEN02v31X15pQVXjQ+GWoFcKrT1rj4DS65ujnLWCanFTEO+InVEauA1g6O0+D5i64hCQ9XlAkUCVz5SF2rCWO+yfta6H/iDSzy5bBK5HaEvNHhrvtnWKyyM5q4m85Amahd/HqCAUmBqacQnfOZgncvGUkiViwvdJ1fvMFK8h8c18JHB+H7d0eUgg8y2/0cZ3F98I1YI14KlEEoPGTNvZSrv9N0ay8LObSvOS+Gw67NNaw/WvRrCJXEK+vhtcOgFonPtmr3Oqc4orA1YsROQzbVcQw3RevDZUrScV0d83rRS9HRMtx3yx22RJ2xMGOEZPsSP0jaSlEkMHiP3GibFweI8xkm0YUP+jkrv8LE2jFtD1X4leYnPGercffpv8A6PuFLWMthqra6IaUNeWAuis03G6fp4Z4RLuing/5RCcY0hlSBlhpJUNWdpuf44xVpqqjc3vPSz+FnrEDR9WlnxRqmZaHz8+5EhDp3INiZ1scvKKpo3IEA2Ce6f6042LotGUBLhr1wimPLPumhSikY6SodUt46IWxYlmh/E/a2PLiyBmowitcs3vNZjNacvkyObu+Esvx++l88BFie6OQ1hGKMnfMxZONPwuleBIBRuWyxALHr0h2o1U3+S5/TIOv00QCeNHr2U5o18ewFDjNVZEKI2DPUKWNSgDT8WLqlgPoFByDJ5vNEV9udJX5DKOmJJkhUC33tmhu/gVmZ4wq0KqVHo1RLdIMEhEgVuS7bE5C6obbXsI+jeT6MphZgki0gNDFShqV9JnN8b295xcLsEy+bGgyc4Z/9bVRCbiroc+HouTIZczvUNYPIew8gfHjt9+C/oasA4MpL4Empb3XacO6T4Ouci7uV8gIV4BRjhElVKYQAe+QxvY7Wz4OAqLnlr0DhxQ6LM5xpPDgIRVnEylEy+ixK4x9zwvW+7dN9CyNxHyvkQKimKbVBAv2w/YIQcef941QBYj79ngdu4vhS/r4HubUBhXkjDqrjHPuF2Fj/1JaTMK6zPUo5F/OBNeB3UbLGxseD5q8lXRV+3OiKIqhsqAEkPRzvNCxhxF7gF5sUZR9EOkXSaHaytl/ln0K28EARTFGPxGhMj+6WpAhbT63T/mp1ehsU1kS4IKOhVrBn/9wtQVsaOuqaLkv8CM2y4EelY7xs6KMg4dy6t4tCnayM4Vi6OPe2fW7J23WY71/WTLnfAT98C6nRp4lNUNrQ/kgRrZ3okFG84Oww3t2QPbsM9ndlpByi9+Vrqv3opyonIRE7BbCu7rkFdkJacyL5OJgvx3YTtvWp8tsE2RMWdLcm76KkEd3ekcUiVSFNjHjels/CaTdIaFL1PIAPbMn/vQteSKb2pbpOgXBlW9O+txCbJJ/MAwJH06MG4OJXYTSZ4wdQGLslG9PAOVWqL6LCYrxYqOtgnMn8M6zTjDkgQG9HLd9ZUR1hq90NINP1EIYMPIbA1Ag2mD0SGC93Vu3QSWK0yqBc2y4Ao+GXY1y05ZwK1SM3Jf3HVfLmQ03NXP20fgQvcVwq/xPIo/lilF/l5ik0aKIgrMnuNmeW0JKksh0tFvoyYSS/QPpuhMSaVSezS6/+5v5qBCvErDArUQeZaTY6cdw+9bDg9dmEEZ1PqAp58qkFAPgSkMDzSpfdKYtm2YlG+y74R9xaHZdG49PbhjIcm8goWJIhy+/2qxc3LzX7CR9zx08NtJgguLS">
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="10C1FD69">
</div>

					
					 
					<div class="header">
					    <a name="Main"></a>
					    <a name="_articleTop" id="_articleTop"></a>

					    
						<div>
							<span id="ctl00_TagListHorz_TagWrp">

	
	

	
	<span id="ctl00_TagListHorz_VisibleTags" class="subdue">(untagged)</span> 

	
	
</span>


						</div>
					    <div class="title">
					        <h1 id="ctl00_ArticleTitle">How to Rotate a WPF Window?</h1>
					    </div>

                        <div>
					        
					        <div class="entry flex-container">

								

                                <div class="flex-item" style="flex:1 1 auto">
                                    <div class="flex-container" style="justify-content:space-between;flex-wrap:wrap-reverse">
                                       <span id="ctl00_Authors" class="author flex-item"><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=2291164" rel="author">Sergey Alexandrovich Kryukov</a></span> 

                                        <div class="flex-item" style="margin-top:-4px;">
                                            <div id="ctl00_RateArticle_RatingTable" class="small-text" data-objectref="2_1082137">

	<meta itemprop="upvoteCount" content="0">


	<div id="ctl00_RateArticle_RatingRow" class="flex-container rating-container large-stars">

					
		

		
		<div class="nowrap tooltip">

			
			<div id="ctl00_RateArticle_ResultNoHist" class="rating-result"><div class="flex-container rating-stars large-stars"><div style="width:24px;position:relative" class="clipped"><img src="./Resources/star-empty-lg.png" style="width:24px;height:24px;position:absolute;top:0px;right:0"></div><div><img src="./Resources/star-empty-lg.png" style="width:24px;height:24px"></div><div><img src="./Resources/star-empty-lg.png" style="width:24px;height:24px"></div><div><img src="./Resources/star-empty-lg.png" style="width:24px;height:24px"></div><div><img src="./Resources/star-empty-lg.png" style="width:24px;height:24px"></div></div></div>
			

			
			

			
            

			
                

		</div>
		
	
		
		<div id="ctl00_RateArticle_VoteCountNoHist" class="rating-votes nowrap">0.00/5  (No votes)</div>	

		

		
		<div class="rating-undo" title="Undo vote" style="margin-left:5px;display:none"></div>

		
		
	</div>

	
	

</div>

                                        </div>
                                    </div>

                                    <div class="flex-container" style="color:#666;font-size:smaller">
                                        <span id="ctl00_LastUpdated" class="date flex-item-tight" title="Date last updated">1 Mar 2016</span><span id="ctl00_HorizontalStats" class="stats flex-item-tight"><span class="stats"><span title="Views"><img src="./Resources/views32.png" style="width:16px"> 17</span> &nbsp; </span></span>
                                    </div>
                                </div>
					        </div>

                            

                        </div>

                        <div id="ctl00_DescriptionSpot" class="summary">In response to an interesting Quick Questions &amp; Answers Inquirer's request, I'm showing how to create an impression of window rotation in a simple way</div><span id="ctl00_ThumbnailUrl" class="date" content="https://www.codeproject.com/script/Articles/Images/article100x80.png"></span>			

                    </div>
                    
					
					

					

					
					

					
					

						
					

					

						
						<div id="contentdiv" class="text">
						



<!-- Article Starts -->

<ul class="download">
	<li><a href="How-to-Rotate-a-WPF-Window.Tip.html.zip">Download source code — 8.3 KB</a></li>
</ul>

<h2>The Question</h2>

<p>This short tip is written in response to this question: <a href="http://www.codeproject.com/Questions/1081789/How-to-spin-window-in-wpf">http://www.codeproject.com/Questions/1081789/How-to-spin-window-in-wpf</a>.</p>

<p>Being a pure decorative trick, not a very important one, it still may deserve a short article and a ready to use code sample. I answered the question (<a href="http://www.codeproject.com/Answers/1081829/How-to-spin-window-in-wpf#answer1">http://www.codeproject.com/Answers/1081829/How-to-spin-window-in-wpf#answer1</a>), but using my answer might not be as easy as one may think at first glance. First of all, the problem can be naturally solved use true WPF 3D model (<a href="https://msdn.microsoft.com/library/ms747437%28v=vs.100%29.aspx">https://msdn.microsoft.com/library/ms747437%28v=vs.100%29.aspx</a>), but to show tips and tricks, it would be more interesting to show something which is a really easy trick. But for that, we cannot rotate a window (and we cannot do it with 3D ether), and we cannot do real rotation, but just a dirty imitation of the rotation, but still good enough for the purpose, just good enough. So, how to prepare such a window?</p>

<h2>Not a Real Window, a "Pseudo-Window"</h2>

<p>First of all, it's good to use not the real main window of an application, but a temporary "effect" window, which would be shown while a main one is hidden, and then that "effect" window can be closed and discarded. Main reason for that is that we cannot rotate a real window with all its non-client areas; and the reason for that is because those non-client areas don't really belong to WPF; and WPF is based on DirectX, which has really nothing to do with Windows API, which rules in the area of non-client areas (pun unintended). So, we have to have at least two different windows.</p>

<p>Another approach is to execute <code>Application.Run</code> twice in the entry point method (<code>Main</code>): first with "rotating" window, and then with a main one. I think it's a matter of taste. In the code sample I provide, the entry point method is exposed, so anyone can use this trick. However, I'll show the variant playing with the visibility of the main window.</p>

<p>So, let's get to a rotating window, the one without client areas. This is how it can be prepared:</p>

<div class="pre-lang" id="premain381627"><div>C#</div><div class="pre-action-link"><span class="copy-code" data-index="381627" id="copycode381627" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve">
<g>
<path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272
    c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729
    c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path>
<path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272
    c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068
    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001
    C291.206,428.715,289.92,430,288.341,430z"></path>	
</g>
</svg></span></div></div><pre lang="cs" data-codeblock-processed="true" id="pre381627" style="margin-top: 0px;" class="notranslate"><span class="code-keyword">public</span> <span class="code-keyword">partial</span> <span class="code-keyword">class</span> RotatingWindow : Window {

    <span class="code-keyword">public</span> RotatingWindow(Window mainWindow) {
        <span class="code-keyword">this</span>.mainWindow = mainWindow;
        InitializeComponent();
        AllowsTransparency = <span class="code-keyword">true</span>;
        Background = Brushes.Transparent;
        WindowStyle = WindowStyle.None;
    } <span class="code-comment">//</span><span class="code-comment">class RotatingWindow</span>

    <span class="code-comment">//</span><span class="code-comment"> ...</span>

} <span class="code-comment">//</span><span class="code-comment">class RotatingWindow</span></pre>

<p>Note that in the code shown above, I passed a reference to the main window to this window. I'll need it later, to pass to a thread, which should perform its "rotating" work and later restore the main window's visibility, which is the only purpose of this reference.</p>

<p>Now, we cannot rotate not the window (one reason is: an attempt to assign an instance to its property <code>RenderTransform</code> will throw an exception), so we need to rotate some content inside it, in my example, an instance of a <code>Grid</code>. We need at least two of them: one should be made transparent, and inner one has to be colored. When we scale down an outer one, the inner one will show the background. For the code shown below, however, the inner content does not matter at all; I put some random controls in it; it's only important to know that the <b>immediate child of a window is some grid taking all its client area</b>.</p>

<h2>Not Rotation, "Pseudo-Rotation": an Element Viewed at an Angle</h2>

<p>We need to show rotation the way that all the elements of the window content would be seen at an angle, all controls, all characters shown in all fonts, and so on. Suppose we want to show the rotation of around a center axes, then the transform can be an instance of <code>ScaleTransform</code> for a grid:</p>

<div class="pre-lang" id="premain645964"><div>C#</div><div class="pre-action-link"><span class="copy-code" data-index="645964" id="copycode645964" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve">
<g>
<path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272
    c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729
    c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path>
<path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272
    c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068
    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001
    C291.206,428.715,289.92,430,288.341,430z"></path>	
</g>
</svg></span></div></div><pre lang="cs" data-codeblock-processed="true" id="pre645964" style="margin-top: 0px;" class="notranslate">grid.RenderTransform = transform; <span class="code-comment">//</span><span class="code-comment"> we can do it only once</span>

<span class="code-comment">//</span><span class="code-comment"> ...</span>

<span class="code-comment">//</span><span class="code-comment"> after that, we can only modify transform parameters:</span>
<span class="code-keyword">double</span> step = System.Math.PI * DefinitionSet.RotationCount / DefinitionSet.StepCount;

<span class="code-comment">//</span><span class="code-comment"> ...</span>

transform.ScaleX = System.Math.Cos(x * step);</pre>

<p>Showing the rectangular UI element at an angle, I assumed that we don't want to show it in space perspective. Oddly enough, this is not a transform supported by standard WPF transforms (and not by <code>System.Drawing</code> transforms). Such transform is not affine (which also sounds a bit surprising) and cannot be created, but it's tricky enough; you would have to do all yourself, up to the pixel level with all the interpolation problems. But if you agree to limit the view with a simple parallel projection, which can also create fair rotation impression, you can use the transform.</p>

<p>Now, we know how to render a thing; how to animate it?</p>

<h2>The Animation Thread</h2>

<p>In case of any complication in an animation scenario, I prefer doing things based on a low-level approach, using my own non-UI thread. This time, the complication is minor: to make rotation impression just a bit real, we certainly need to demonstrate near-uniform rotation motion, so the angle should be a linear function of time. That said, our scale factor should be not a linear function of time. As it can be seen from the above fragment, we simply need to make this factor a cosine function of time. Besides, we need to dispatch all changes to the UI to the UI thread, which is done using the <code>Dispatcher</code> object:</p>

<div class="pre-lang" id="premain944857"><div>C#</div><div class="pre-action-link"><span class="code-collapse" data-index="944857" id="preShrink944857">Shrink ▲</span> &nbsp; <span class="copy-code" data-index="944857" id="copycode944857" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve">
<g>
<path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272
    c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729
    c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path>
<path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272
    c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068
    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001
    C291.206,428.715,289.92,430,288.341,430z"></path>	
</g>
</svg></span></div></div><pre lang="cs" data-codeblock-processed="true" id="pre944857" style="margin-top: 0px;" class="notranslate"><span class="code-keyword">using</span> System.Windows;
<span class="code-keyword">using</span> System.Windows.Media;
<span class="code-keyword">using</span> System.Threading;

<span class="code-comment">//</span><span class="code-comment"> ...</span>

<span class="code-keyword">internal</span> <span class="code-keyword">class</span> ThreadWrapper {

    <span class="code-keyword">internal</span> ThreadWrapper(Window window, Window mainWindow, ScaleTransform transform) {
        <span class="code-keyword">this</span>.transform = transform;
        <span class="code-keyword">this</span>.window = window;
        <span class="code-keyword">this</span>.mainWindow = mainWindow;
        Thread = <span class="code-keyword">new</span> System.Threading.Thread(Body);
    } <span class="code-comment">//</span><span class="code-comment">ThreadWrapper</span>

    Thread Thread;

    <span class="code-keyword">internal</span> <span class="code-keyword">void</span> Start() { <span class="code-keyword">this</span>.Thread.Start(); }

    <span class="code-keyword">void</span> Body() {
        <span class="code-keyword">double</span> step = System.Math.PI * DefinitionSet.RotationCount / DefinitionSet.StepCount;
        <span class="code-keyword">for</span> (<span class="code-keyword">int</span> x = <span class="code-digit">0</span>; x <span class="code-keyword">&lt;</span> DefinitionSet.StepCount * DefinitionSet.RotationCount; ++x) {
            window.Dispatcher.BeginInvoke(<span class="code-keyword">new</span> System.Action(() =<span class="code-keyword">&gt;</span> {
                transform.ScaleX = System.Math.Cos(x * step);
            }));
            Thread.Sleep(DefinitionSet.Delay);
        } <span class="code-comment">//</span><span class="code-comment">loop</span>
        window.Dispatcher.BeginInvoke(<span class="code-keyword">new</span> System.Action(() =<span class="code-keyword">&gt;</span> {
            mainWindow.Visibility = Visibility.Visible;
            window.Close();
        }));
    } <span class="code-comment">//</span><span class="code-comment">Body</span>

    ScaleTransform transform;
    Window window, mainWindow;

} <span class="code-comment">//</span><span class="code-comment">class ThreadWrapper</span></pre>

<p>Here, the class <code>ThreadWrapper</code> is a class I put forward a while ago (<a href="http://www.codeproject.com/Answers/155852/How-to-pass-ref-parameter-to-the-thread#answer2">http://www.codeproject.com/Answers/155852/How-to-pass-ref-parameter-to-the-thread#answer2</a>), in this case, is just a convenient and safe way of passing parameters to the thread, which is actually done through the "<code>this</code>" reference of the non-static (instance) thread method. In other cases, it's a good way to encapsulate thread interlocking mechanisms, events, and a lot more:<br>
<a href="http://www.codeproject.com/Answers/223412/change-paramters-of-thread-producer-after-it-start#answer1">http://www.codeproject.com/Answers/223412/change-paramters-of-thread-producer-after-it-start#answer1</a>,<br>
<a href="http://www.codeproject.com/Answers/485734/MultiThreadingplusinplusC-23#answer4">http://www.codeproject.com/Answers/485734/MultiThreadingplusinplusC-23#answer4</a>.</p>

<h2>What Else?</h2>

<p>In my original answer, I mentioned that the rotating content should mimic the behavior of a "standard" window, with all its non-client area. How? Apparently, these non-client areas can be pictured as some images in a client area, just to mimic the title bar, close button, etc. Below, in my comment, I added one more idea: at first moment, we could show a "normal" window, and when it is already rendered, we could make a screenshot of a part of the screen occupied by this real window and remember it. (There are more than enough questions and answers on taking screenshots with WPF.) Then this screenshot could be shown on a "rotating window" while the main window used to get a screenshot is hidden.</p>

<p>In this article, however, I thought it would be much more interesting to show a transform on the real WPF content, which is not as trivial as showing a picture.</p>

<h2>Building the Sample Project</h2>

<p>Please run provided batch file "<em>build.bat</em>", to build the projects into two binary directories (for <em>Release</em> and <em>Debug</em>) placed as sub-directories of the directory of the solution.</p>

<p>I intentionally created the sample project for Visual Studio 2008 and for .NET v.3.5 target, to create a common denominator usable by nearly all Windows users and developers. Just a reminder of those who were not aware of it: a .NET project of this kind does not need any Visual Studio to build; the C# and VB.NET compilers, MSBuild.EXE and other required tools are included with just the (freely redistributed) .NET Framework.</p>

<!-- Article Ends -->


						</div>
						

						
						<h2>License</h2>
						<div id="LicenseTerms"><p>This article has no explicit license attached to it but may contain usage terms in the article text or the download files themselves. If in doubt please contact the author via the discussion board below.</p><p>A list of licenses authors might use can be found <a href="https://www.codeproject.com/info/Licenses.aspx">here</a></p></div>
						

						
						<br>
						
						    <br>
						
						

						<div class="clearfix"></div>

						<div style="padding-top:8px">
							
						</div>

					

				    
					</form>

				</div>

				
				<div class="bottom-promo"> 
				    
				</div>
				
                
                

				
				
				

			</div>
			

            
            
            

        </div>
        

		
		<div class="site-footer">
			<div class="align-left">
				<a id="ctl00_PermaLink" href="https://www.codeproject.com/Articles/1082137/How-to-Rotate-a-WPF-Window">Permalink</a><br>
				<br>
				<a id="ctl00_PrivacyLink" href="https://www.codeproject.com/info/privacy.aspx">Privacy</a><br>
    			<a id="ctl00_CookiePolicyLink" href="https://www.codeproject.com/info/cookie.aspx">Cookies</a><br>
                <a id="ctl00_TermsOfUseLink" href="https://www.codeproject.com/info/TermsOfUse.aspx">Terms of Use</a><br>
			</div>

            <div class="align-center">
				


<div class="page-width">
    Layout: <a id="ctl00_PageWidth_FixedT" title="Fixed width layout" rel="nofollow" class=" active" href="https://www.codeproject.com/Tips/1082137/How-to-Rotate-a-WPF-Window?PageFlow=FixedWidth">fixed</a>
    |
    <a id="ctl00_PageWidth_FluidT" title="Fluid layout" rel="nofollow" href="https://www.codeproject.com/Tips/1082137/How-to-Rotate-a-WPF-Window?PageFlow=Fluid">fluid</a>
</div>


				

				

	            

                <br>
			</div>
                
			<div class="align-right">
				Article Copyright 2016 by Sergey Alexandrovich Kryukov<br>Everything else
				Copyright © <a href="mailto:webmaster@codeproject.com">CodeProject</a>, 1999-2024<br>
                <br>
				Web01 
				2.8:2024-12-08:1<br>
			</div>
		</div>
		

		<br clear="all">
		
			

	</div> 
	</div> 
</div>







<script type="text/javascript"> // DEFERRED script

document.addEventListener('DOMContentLoaded', function() {

	new CodeBlocks().initialise('#contentdiv');
	
	$('.author-wrapper .description').shorten({showChars: 400});
	
	anchorAnimate();
	
	$('#__EVENTVALIDATION').attr('autocomplete', 'off');

})
</script>










<style type="text/css">.copied::after {  position: absolute;  right: 0;  display: inline-block; white-space: nowrap; content: 'copied'; color: #fff; background-color: #f90;  border-radius: 3px; padding:1px 8px; opacity: 0;  will-change: opacity, transform; animation: showcopied 1.5s ease; } @keyframes showcopied { 0% { opacity: 0; } 70% { opacity: 1; } 100% { opacity: 0; } } </style><canvas id="cv1" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas><canvas id="cv2" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas></body><grammarly-desktop-integration data-grammarly-shadow-root="true"><template shadowrootmode="open"><style>
      div.grammarly-desktop-integration {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
        -moz-user-select: none;
        -webkit-user-select: none;
        -ms-user-select:none;
        user-select:none;
      }

      div.grammarly-desktop-integration:before {
        content: attr(data-content);
      }
    </style><div aria-label="grammarly-integration" role="group" tabindex="-1" class="grammarly-desktop-integration" data-content="{&quot;mode&quot;:&quot;full&quot;,&quot;isActive&quot;:true,&quot;isUserDisabled&quot;:false}"></div></template></grammarly-desktop-integration></html>