<!DOCTYPE html>
<!-- saved from url=(0094)https://www.codeproject.com/Articles/809357/Bitwise-Enumeration-Editor-for-PropertyGrid-and-Vi -->
<html lang="en" data-lt-installed="true"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

	
	<link rel="preconnect" href="https://www.google-analytics.com/">

	<link rel="preconnect" href="https://www.codeproject.com/">


	<link rel="preload" href="./Resources/logo250x135.gif" as="image">


	<link rel="preload" href="https://www.codeproject.com/App_Themes/CodeProject/Img/logo135-bg.gif" as="image">
	<link rel="preload" href="./Resources/jquery-3.4.1.min.js.download" as="script" type="text/javascript">


	<title>Bitwise Enumeration Editor for PropertyGrid and Visual Studio- CodeProject</title> 
    
	<link type="text/css" rel="stylesheet" href="./Resources/Article.min.css">


    <script type="text/javascript" async="" src="./Resources/analytics.js.download"></script><script type="text/javascript" src="./Resources/jquery-3.4.1.min.js.download" defer=""></script>
<script type="text/javascript" src="./Resources/article.min.js.download" defer=""></script>

	
<meta http-equiv="content-language" content="en-US">

<meta name="Description" content="The Editor attribute applied to an enumeration type makes it editable in PropertyGrid. This is enough to make the Visual Studio Designer use the editor, without a need to write a Visual Studio add-on.">
<meta name="Keywords" content="VS2008, C#, .NET, Visual-Studio, Intermediate, Advanced">
<meta name="Author" content="Sergey Alexandrovich Kryukov">
<meta name="Rating" content="General">
<meta name="Revisit-After" content="1 days">
<meta name="application-name" content="CodeProject">
<meta name="google-translate-customization" content="d908bb7ce7aff658-4c2f3a504525c916-g629383f736781a8a-13">



<link rel="dns-prefetch" href="https://ajax.googleapis.com/"> 
<link rel="canonical" href="https://www.codeproject.com/Articles/809357/Bitwise-Enumeration-Editor-for-PropertyGrid-and-Vi">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@CodeProject">
<meta name="og:site_name" content="CodeProject">
<meta name="twitter:creator" content="@CodeProject">
<meta property="og:type" content="article">
<meta property="article:published_time" content="8/20/2014 1:01:00 AM">
<meta property="article:modified_time" content="4/17/2017 3:10:00 PM">
<meta name="twitter:label1" content="Written by">
<meta name="twitter:data1" content="Sergey Alexandrovich Kryukov">
<meta name="twitter:label2" content="Reading time">
<meta name="twitter:data2" content="12 min read">
<meta property="og:url" content="https://www.codeproject.com/Articles/809357/Bitwise-Enumeration-Editor-for-PropertyGrid-and-Vi">
<meta property="og:title" content="Bitwise Enumeration Editor for PropertyGrid and Visual Studio">
<meta property="og:description" content="The Editor attribute applied to an enumeration type makes it editable in PropertyGrid. This is enough to make the Visual Studio Designer use the editor, without a need to write a Visual Studio add-on.">


<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="apple-touch-icon" sizes="144x144" href="https://www.codeproject.com/favicon/apple-touch-icon.png"> 
<link rel="icon" type="image/png" sizes="32x32" href="https://www.codeproject.com/favicon/favicon-32x32.png"> 
<link rel="icon" type="image/png" sizes="16x16" href="https://www.codeproject.com/favicon/favicon-16x16.png"> 
<link rel="manifest" href="https://www.codeproject.com/favicon/manifest.json"> 
<link rel="mask-icon" href="https://www.codeproject.com/favicon/safari-pinned-tab.svg" color="#ff9900">
	<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "TechArticle",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.codeproject.com/Articles/809357/Bitwise-Enumeration-Editor-for-PropertyGrid-and-Vi"
   },
  "name": "Bitwise Enumeration Editor for PropertyGrid and Visual Studio",
  "headline": "Bitwise Enumeration Editor for PropertyGrid and Visual Studio",
  "url": "https://www.codeproject.com/Articles/809357/Bitwise-Enumeration-Editor-for-PropertyGrid-and-Vi",
  "discussionUrl": "#_comments",
  "isFamilyFriendly": "true",
  "image": "https://www.codeproject.com/App_Themes/CodeProject/Img/Article100.png",
  "keywords": "VS2008,C#,.NET,Visual-Studio,Intermediate,Advanced",
  "commentCount": "0",
  "editor" : {
    "@type" : "Person",
    "name" : "Editor",
    "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=2291164"
  },
  "license": "http://www.codeproject.com/info/cpol10.aspx",
  "publisher" : {
    "@type" : "Organization",
    "name" : "CodeProject"
  },
  "description": "The Editor attribute applied to an enumeration type makes it editable in PropertyGrid. This is enough to make the Visual Studio Designer use the editor, without a need to write a Visual Studio add-on.",
  "articleSection": "C#",
  "author" : [{
      "@type" : "Person",
      "name" : "Sergey Alexandrovich Kryukov",
      "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=2291164"
    }],
  "datePublished": "2014-08-20",
  "dateCreated": "2014-08-20",
  "dateModified": "2017-04-17"
,
  "contentRating" : {
    "@type" : "Rating",
    "ratingValue" : 4.99,
    "bestRating" : 5,
    "worstRating" : 1
  }
}</script>

<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
    "@type": "ListItem",
    "position": 1,
    "item" : {
      "@id" : "/script/Content/Tag.aspx?tags=Languages",
      "name" : "Languages"
    }
  },{
    "@type": "ListItem",
    "position": 2,
    "item" : {
      "@id" : "/script/Content/Tag.aspx?tags=Csharp",
      "name" : "C#"
    }
  }]
}</script>

<script type="text/javascript">
function defrm () { /* thanks twitter */
    document.write = '';
    window.top.location = window.self.location;
    setTimeout(function() { document.body.innerHTML = ''; }, 0);
    window.self.onload = function(evt) { document.body.innerHTML = ''; };
}

if (window.top !== window.self) {
    try {
        if (window.top.location.host) { /* will throw for all except chrome */ }
        else { defrm(); /* chrome */ }
    } catch (ex) { defrm(); /* everyone else */ }
}

// Specific case where a site is screwing with us.
if (typeof(DemoUrl) !== 'undefined') {
    document.write(unescape('%3Cme') + 'ta http' + '-equiv="re' + 'fresh con' +
                           'tent="1;url=' + DemoUrl + unescape('"%3CE'));
}
</script>
	





    <script async="" type="text/javascript" src="./Resources/js"></script>
    <script type="text/javascript">
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-1735123-1' , {'user_id': '42a7d533-9829-4f88-8fc6-84dc936250c9'});
    </script>

<style type="text/css"></style></head>	

<body class="chrome chrome120" data-new-gr-c-s-check-loaded="14.1215.0" data-gr-ext-installed="">



<a class="access-link" href="#Main"><img alt="Click here to Skip to main content" src="./Resources/t.gif"></a>




<div class="page-background">

	
	

	

	
    <div id="ctl00_STM" class="site-top-menu fixed narrow">
        <div class="main-content">
            

<div class="container memberbar clearfix flex-container flex-extend">

	<div id="ctl00_MemberBar_GenInfo" class="flex-item align-left">65,938 articles</div>
	
	<div id="ctl00_MemberBar_ChangeNotice" class="flex-item align-left">CodeProject
	is changing. <a href="https://www.codeproject.com/info/Changes.aspx">Read more</a>.</div>

	<div class="flex-item">
		
	</div>

	<div class="flex-item align-right">

		

		

		
	</div>
</div>
        </div>
    </div>

	
    <div id="ctl00_SH" class="site-header fixed narrow">
        <div class="main-content">
            <div class="logo"><a href="https://www.codeproject.com/"><img id="ctl00_Logo" tabindex="1" title="CodeProject" src="./Resources/logo250x135.gif" alt="Home" style="height:135px;width:250px;border-width:0px;"></a></div>
            <div class="promo"></div>
        </div>
    </div>

	
			
	

	<div id="A" class="container-content-wrap fixed narrow"> 

	<div class="container-content">

        
		<div class="clearfix">
			<div class="container-breadcrumb float-left ">
				<div><a rel="nofollow" href="https://www.codeproject.com/script/Content/SiteMap.aspx">Articles</a> / <a rel="nofollow" href="https://www.codeproject.com/script/Content/Tag.aspx?tags=Languages">Languages</a> / <a rel="nofollow" href="https://www.codeproject.com/script/Content/Tag.aspx?tags=Csharp">C#</a></div>
			</div>

            <div class="float-left">
				
			</div>

			<div class="edit-links float-right">
				



 
&nbsp;










			</div>

			<div class="article-nav float-right">
				


<div style="display:inline-block;position:relative;top:-6px;margin-right:20px">
    
</div>



 

<a id="ctl00_ActionLinks_PrintMd" data-tooltip="Print" data-enabletooltip="true" data-width="auto" href="https://www.codeproject.com/Articles/809357/Bitwise-Enumeration-Editor-for-PropertyGrid-and-Vi?display=Print" class="tooltip" title="">
   <img src="./Resources/print48.png" width="24" height="24" style="border:0">
<div class="speech-bubble-container-up" style="width:auto">  <div class="speech-bubble-up" style="text-align:center"> Print</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>



<span id="ctl00_ActionLinks_R">
    
    
</span>
			</div>
		</div>

        
		<div class="extended article-container-parts">

			
		    
            

			
			<div id="AT" class="article-container  fixed narrow" style="max-width:inherit;"> 

				<div class="article">

					<form name="aspnetForm" method="post" action="https://www.codeproject.com/Articles/809357/View.aspx" id="aspnetForm" style="margin:0;padding:0">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="Le+DwclkmhMjTYBby1SSyteZFchelMOU2kaqjGH1VdvRm8HloX6WZ3kYXkSgulrxBbRiJ6uXqTIljAwsPH+URjmAJAUGrCWrVBIra/ERC58NCCd0rVzJAhMTgxmc5ROzwva6JH/hhCNImCWl3dnEoPvacXTY1/0vmXfBUnPfgyAogQ4zLZJZvUe0wJ4P23JUsRpTTVEI5MKKrIvNUfRGar401kgtQHfw0lZO1JGuSghjYaXq46T/v6bHoNMFsJYjjcFr0D0xVG1nOs0Q0/iAtC/zj37OsSFnxRNrqM1pXy4lMe8tSmiEzxBx72dEBWw5T4gkovQfwZk8zJatwXfp3UQLwAXPsDWhQ88ODA+9s0Ch9DotS/+zEJMP7v7cpHEbasG7GGsyo0MRlJqgFBCy4wPzJiZnZ83bOoeOjaztyfbXkCmeZxta4EqSs3x2RLvy4s0X/vfSE1f5x+csKZDoq9+2psKcUiNeKlWD3CafjevtmLNiUqCcPMnmfXNZ0uBe7gpg43uICr+YdhFg7JHePahI/v71LrmabbHKz05bbEpzh2+5zLnqJlp4+ASK9xdCT+PI4G+g1/N3swem+lrEM8e+8w+bE9Rpf4dua7G0QzNHl1sIzKgyHtpUxQ+4/YUGXN1PmK7HDjKJsGdLH8AR14AouTuh9KepbpZhcurXGmCSyKCKyshm/1p01j1Zr7zS0laR+O0a7sgFp4mWRN+mBovnyTPwmLJINcdwk0HEsZ8BVgxW7mQJypGEoMGCNqlFdhfglZFpoAXRJrGwYgmiXWGztGh+OSYApQI3UYlbcet+hJRw1K1ZllM4n7tnJ9ehslvL+do+pMn/AlZT6EmGjengptIRGqVB+pHIHcS8pj+lS9mtj5Jb5QVph7Nz/BdARmgxdiWd1bSMtjZ8vjp3rHY00PNuY4nrYrQKm2zIpOpnoigndaDFSnAyK767qecmgIUQyoJRFXanL0yjc67/YCOdiPJ+WTJN3faZa4/R0a3ATQxD7CrroNL8QZK1at6L0syS7p8XmSlD34qoinmthd5EYV07Jv3Z6YrwhVKIMI9y2e4QcUQgohdmTC54dvNBAdZa2YfAkAKUYIQMhM85nl78eODpRwKh9Gu2pnyjLpqdsV2hOjoHLQRopE4L+JFbM0YdHJ7PbB8J9edTMiWQyEaqX41/kTV7c+PVP4krzK2twcq8XT/U76/837+ewYPurmE7LEVoSmaA0fAHtjzBppY8xR0UTFuviIWdFaIpi1+pxHmnt8kH9GZht4rFfdFa+3GcmVJX5M6+z1Gy6f47wY7VapC6cghvIZDiVT4VpH4P1ngIrOFblvzVMFaMv0oi0cqs5lpzFU8sOdk7yxqjn9+9CcHZxj/lwNsDA0A9nYTRl0p0F4fb1ckcoA7Z2yRDR3KhVkaEI3kN3L3xgMnW4Zvq+UA4HmGjCf3TrovnEtOdoT6O+jwvxR9QS0k65igLJ0u2/zzsjxWBWHX7898WpmigKKCrWzCzZpy42ZJqBAEj4rWrwJKCSn0vpAm2kTxrvjxheRjvbzYyzaW3U41S0nSPc0I1/0nxeAPKC9RRmzGkzrNG6DeIOwoax+w1LvUtkTWQJIglxxpa1sgLaSbuCxHmn6dM69Uke5QCjGXp8/6nJqRgqTcpiHU7qa1TbT30+K9Bo7bUq77Pb+C1xMvBkpsa9w6aKumyDkcKb8wl1tBO8CvDwEe7/1nLpCP1aB8aCdLv/WzL9CM3JWZD0WenWPbO+9odXPdWkbQvCxcb+yJQ1CU/CWOT/AVcTrsVM1CwGGDPNzcP75bxmyR1HraWIJJKSL82Mtv9gxMfWFh7IH2gYWuBn4yNhNM38Hr3rD1lbTpFMHaZ8giUwjxHA8E7IbLSl/GUXAnEy3wexm+FlukbmKl0Nz/f0H2nV7rJEZePwgNKzMvLJX2qT9EpG/oEta/2v2eWrEqVLGNeEAJvPDn6nLhthVQe7TpUjTZluKcQ96DyzCJ0vKlBBB+kHpJwhFwD8dfQ6BhlJYuuY6Z8ZwW4/UfHYolvfvdyUgEYNKZ9nxh4hgiUg8iL7jMol+bHhrp38ttcCkUXLr9fbxm+ZV48OWQBiGXMJiZTAjzqlE1505czWTxKgduEbNl+7WvhDr7kSgWnjeVcMwXqijhiUPqK/ZAKskjnhg4J8g0PW5/W6gWeE8xOs6bAvTa0J6T5VzlbDN8g524nyVvfTa8R3q5BwMrXYk77uPyOydXnMwH6GjAxXQ==">
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="10C1FD69">
</div>

					
					 
					<div class="header">
					    <a name="Main"></a>
					    <a name="_articleTop" id="_articleTop"></a>

					    
						<div>
							<span id="ctl00_TagListHorz_TagWrp" class="tags horizontal">

	
	

	
	<span id="ctl00_TagListHorz_VisibleTags"><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/VS2008" data-id="77">VS2008</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/Csharp" data-id="81">C#</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/.NET" data-id="98">.NET</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/Visual-Studio" data-id="103">Visual-Studio</a></div></span> 

	
	
</span>


						</div>
					    <div class="title">
					        <h1 id="ctl00_ArticleTitle">Bitwise Enumeration Editor for PropertyGrid and Visual Studio</h1>
					    </div>

                        <div>
					        
					        <div class="entry flex-container">

								

                                <div class="flex-item" style="flex:1 1 auto">
                                    <div class="flex-container" style="justify-content:space-between;flex-wrap:wrap-reverse">
                                       <span id="ctl00_Authors" class="author flex-item"><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=2291164" rel="author">Sergey Alexandrovich Kryukov</a></span> 

                                        <div class="flex-item" style="margin-top:-4px;">
                                            <div id="ctl00_RateArticle_RatingTable" class="small-text" data-objectref="2_809357">

	<meta itemprop="upvoteCount" content="28">


	<div id="ctl00_RateArticle_RatingRow" class="flex-container rating-container large-stars">

					
		

		
		<div class="nowrap tooltip">

			
			<div id="ctl00_RateArticle_ResultNoHist" class="rating-result"><div class="flex-container rating-stars large-stars"><div><img src="./Resources/star-fill-lg.png" style="width:24px;height:24px"></div><div><img src="./Resources/star-fill-lg.png" style="width:24px;height:24px"></div><div><img src="./Resources/star-fill-lg.png" style="width:24px;height:24px"></div><div><img src="./Resources/star-fill-lg.png" style="width:24px;height:24px"></div><div style="width:23px;" class="clipped"><img src="./Resources/star-fill-lg.png" style="width:24px;height:24px"></div><div style="width:1px;position:relative" class="clipped"><img src="./Resources/star-empty-lg.png" style="width:24px;height:24px;position:absolute;top:0px;right:0"></div></div></div>
			

			
			

			
            

			
                

		</div>
		
	
		
		<div id="ctl00_RateArticle_VoteCountNoHist" class="rating-votes nowrap">4.99/5  (31 votes)</div>	

		

		
		<div class="rating-undo" title="Undo vote" style="margin-left:5px;display:none"></div>

		
		
	</div>

	
	

</div>

                                        </div>
                                    </div>

                                    <div class="flex-container" style="color:#666;font-size:smaller">
                                        <span id="ctl00_LastUpdated" class="date flex-item-tight" title="Date last updated">20 Aug 2014, last revision: 17 Apr 2017</span><a id="ctl00_LicenseLink" title="The Code Project Open License (CPOL)" class="license flex-item-tight" href="http://www.codeproject.com/info/cpol10.aspx">CPOL</a><span id="ctl00_ReadingTime" class="stats flex-item-tight">12 min read</span><span id="ctl00_HorizontalStats" class="stats flex-item-tight"><span class="stats"><span title="Views"><img src="./Resources/views32.png" style="width:16px"> 50.2K</span> &nbsp; <span title="Downloads"><img src="./Resources/download32.png" style="width:16px"> 870</span> &nbsp; </span></span>
                                    </div>
                                </div>
					        </div>

                            

                        </div>

                        <div id="ctl00_DescriptionSpot" class="summary">The Editor attribute applied to an enumeration type makes it editable in PropertyGrid. This is enough to make the Visual Studio Designer use the editor, without a need to write a Visual Studio add-on.</div><span id="ctl00_ThumbnailUrl" class="date" content="https://www.codeproject.com/script/Articles/Images/article100x80.png"></span>			

                    </div>
                    
					
					

					

					
					

					
					

						
					

					

						
						<div id="contentdiv" class="text">
						



<!-- Article Starts -->

<ul class="download">
	<li><a href="Bitwise-Enumeration-Editor-for-PropertyGrid-and-Visual-Studio.zip">Download source code — 35.3 KB</a>&nbsp;</li></ul>

<p><img title="Visual Studio look" alt="2014-08-20.Bitwise-Enumeration-Editor-for-PropertyGrid-and-Visual-Studio.webp" src="./Resources-articles/2014-08-20.Bitwise-Enumeration-Editor-for-PropertyGrid-and-Visual-Studio.webp" ></p>

<h2>Table of Contents</h2>

<ul style="list-style-type: none; list-style-image: initial">
	<li><a href="#a1"><u>1. Introduction</u></a>

	<ul style="list-style-type: none; list-style-image: initial; margin-top: 0; margin-bottom: 0">
		<li><a href="#a1.1"><u>1.1. Beyond the Article Title</u></a></li>		<li><a href="#a1.2"><u>1.2. The Demo Application</u></a></li>	</ul>
	</li>	<li><a href="#a2"><u>2. The Usage by Example</u></a></li>	<li><a href="#a3"><u>3. How it Works?</u></a>
	<ul style="list-style-type: none; list-style-image: initial; margin-top: 0; margin-bottom: 0">
		<li><a href="#a3.1"><u>3.1. The Main Idea</u></a></li>		<li><a href="#a3.2"><u>3.2. The Most Difficult Problem: the Underlying Integer Types</u></a></li>		<li><a href="#a3.3"><u>3.3. The Rest of it is Easy </u></a></li>	</ul>
	</li>	<li><a href="#a4"><u>4. Conclusions</u></a></li>	<li><a href="#a5"><u>5. Credits </u></a></li></ul>

<h2 id="a1">1. Introduction</h2>

<p>This article is the fourth article of the small series of articles on enumeration types I'm presenting to CodeProject members:</p>

<ol>
	<li><a href="http://www.codeproject.com/Articles/129830/Enumeration-Types-do-not-Enumerate-Working-around"><u>Enumeration Types do not Enumerate! Working around .NET and Language Limitations</u></a>;</li>	<li><a href="http://www.codeproject.com/Articles/136181/Human-readable-Enumeration-Meta-data"><u>Human-readable Enumeration Meta-data</u></a>;</li>	<li><a href="http://www.codeproject.com/Articles/144349/Enumeration-based-Command-Line-Utility"><u>Enumeration-based Command Line Utility</u></a>;</li>	<li>The present article.</li></ol>

<p>I will use the same code base, upgraded with new features. I will also refer to this work where it is needed for proper understanding of the matter. Conceptually, the present work is derived from the code of the article #2, but the code of the <code>Enumerations</code> library itself is derived from the code of the article #3, where the additional item as introduces, abbreviations of the names of the enumeration members. So, I gave this library a version number of 4.0. The new library is <code>Enumerations.UI</code> v.1.0.</p>

<h3 id="a1.1">1.1. Beyond the Article Title</h3>

<p>The class <code>EnumerationEditor</code> is not really redundant. Not only it complements the class <code>BitwiseEnumerationEditor</code>in a matching styles; both classes show human-readable names and descriptions of the enumeration members, shown in the node tooltips on the tree nodes enumeration member values.</p>

<h3 id="a1.2">1.2. The Demo Application</h3>

<p>Please look at the picture shown on top of this article. It demonstrates how the enumeration values can be edited in Visual Studio for a component. To see the demo in Visual Studio, build the solution, then locate the main form node of the Solution Explorer, click it to show the designer, select the bright rectangular control on left (it does nothing, just carries two demo enumeration properties) and activate the Properties window, locate the category "Demo" shown on the picture by the raspberry-colored arrow. It will demonstrate two editors; the property "Feature Set" uses the bitwise enumeration editors.</p>

<p>To see the same thing during runtime, just run the application. Even though the demo application is written in <code>System.Windows.Forms</code>, the library provided can be used in assemblies of all other types: WPF, ASP.NET, Silverlight or any other type, because, anyway, the enumeration types will be shown and edited in the same way, in Visual Studio and other, alternative .NET IDE.</p>

<h2 id="a2">2. The Usage by Example</h2>

<p>Now, let's review the code sample used to obtain the PropertyGrid behavior described above:</p>

<div class="pre-lang" id="premain284818"><div>C#</div><div class="pre-action-link"><span class="code-collapse" data-index="284818" id="preShrink284818">Shrink ▲</span> &nbsp; <span id="copycode284818" class="copy-code" data-index="284818" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre284818" style="margin-top:0;" class="lang-csharp notranslate" data-language="cs" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-keyword">namespace</span> EnumerationEditorDemo {
    <span class="code-keyword">using</span> FlagsAttribute = System.FlagsAttribute;
    <span class="code-keyword">using</span> EditorAttribute = System.ComponentModel.EditorAttribute;
    <span class="code-keyword">using</span> DisplayNameAttribute = SA.Universal.Enumerations.DisplayNameAttribute;
    <span class="code-keyword">using</span> DescriptionAttribute = SA.Universal.Enumerations.DescriptionAttribute;
    <span class="code-keyword">using</span> AbbreviationAttribute = SA.Universal.Enumerations.AbbreviationAttribute;
    <span class="code-keyword">using</span> EnumerationEditor = SA.Universal.Enumerations.UI.EnumerationEditor;
    <span class="code-keyword">using</span> BitwiseEnumerationEditor = SA.Universal.Enumerations.UI.BitwiseEnumerationEditor;
    <span class="code-keyword">using</span> UITypeEditor = System.Drawing.Design.UITypeEditor;
    <span class="code-keyword">using</span> NonEnumerableAttribute = SA.Universal.Enumerations.NonEnumerableAttribute;
    <span class="code-keyword">using</span> SA.Universal.Enumerations.UI;

    [Editor(<span class="code-keyword">typeof</span>(BitwiseEnumerationEditor), <span class="code-keyword">typeof</span>(UITypeEditor))]
    [DisplayName(<span class="code-keyword">typeof</span>(Data.DisplayNames)), Description(<span class="code-keyword">typeof</span>(Data.Descriptions))]
    [Flags]
    <span class="code-keyword">public</span> <span class="code-keyword">enum</span> FeatureSet {
        [NonEnumerable]
        None = <span class="code-digit">0</span>,
        AutoCenterX = <span class="code-digit">1</span> &lt;&lt; <span class="code-digit">0</span>,
        AutoCenterY = <span class="code-digit">1</span> &lt;&lt; <span class="code-digit">1</span>,
        Border = <span class="code-digit">1</span> &lt;&lt; <span class="code-digit">2</span>,
        [Abbreviation(<span class="code-digit">6</span>)]
        TransparentBackground = <span class="code-digit">1</span> &lt;&lt; <span class="code-digit">3</span>,
        [Abbreviation(<span class="code-digit">11</span>)]
        BackgroundImage = <span class="code-digit">1</span> &lt;&lt; <span class="code-digit">4</span>,
        [NonEnumerable]
        Center = AutoCenterX | AutoCenterY,
        [NonEnumerable]
        All = AutoCenterX | AutoCenterY | Border | TransparentBackground | BackgroundImage,
    } <span class="code-comment">//</span><span class="code-comment">enum FeatureSet</span>

    [Editor(<span class="code-keyword">typeof</span>(EnumerationEditor), <span class="code-keyword">typeof</span>(UITypeEditor))]
    [DisplayName(<span class="code-keyword">typeof</span>(Data.DisplayNames)), Description(<span class="code-keyword">typeof</span>(Data.Descriptions))]
    <span class="code-keyword">public</span> <span class="code-keyword">enum</span> Position {
        SoftwareArchitect,
        PrincipalSoftwareEngineer,
        TeamLeader,
        TechnicalLead,
        SeniorSoftwareEngineer,
        SoftwareEngineer,
        JuniorSoftwareEngineer,
    } <span class="code-comment">//</span><span class="code-comment">enum Position</span>

} <span class="code-comment">//</span><span class="code-comment">namespace EnumerationEditorDemo</span></pre>

<p>I provided separate <em>alias</em> <code>using</code> directives for all of the attributes used, to show where each one comes from. The usage of the attributes <code>DisplayName</code> and <code>Description</code> is described in detail in <a href="http://www.codeproject.com/Articles/136181/Human-readable-Enumeration-Meta-data"><u>my second article of this series</u></a>; the use of abbreviations — <a href="http://www.codeproject.com/Articles/144349/Enumeration-based-Command-Line-Utility"><u>in the third one</u></a>. The <code>Editor</code> attributes define what editor should be used in <code>PropertyGrid</code>. The values defined by the <code>Description</code> attribute are shown in the tooltips of the tree nodes representing the enumeration member values.</p>

<p>Note the use of the <code>NonEnumerable</code> attribute. When dealing with the bitwise editor, it's very important to avoid showing the enumeration members not representing single bits.</p>

<p>Note that the <code>Flags</code> attribute is used. Generally, this attribute does not affect application runtime, but it is important to use the <code>Flags</code> attribute if <code>System.Object.ToString()</code> is used for an enumeration type; it may affect design time, useful for debugging, and so on…</p>

<h2 id="a3">3 How it Works?</h2>

<h3 id="a3.1">3.1 The Main Idea</h3>

<p>The whole idea of the technique used to edit the enumeration values in an agnostic manner, as required by the <code>System.ComponentModel.EditorAttrubute</code> and the universal editor which should be automatically invoked from any instance of the <code>ProperyGrid</code>, is just one <i>subliminal</i> method: <a href="http://msdn.microsoft.com/en-us/library/system.type.makegenerictype%28v=vs.110%29.aspx"><u>System.Type.MakeGenericType</u></a>.</p>

<p>Even the name of this important method is misleading: it actually expects a generic type to be an instance of <code>Type</code> on which this method is called, and substitutes the generic parameters by actual types and instantiates a generic type into a new type, which can make the returned type a fully-defined type, that is, non-generic. This is what happens in my code: the call creates a <i>fully-defined type</i>, typically an enumeration type.</p>

<p>Why doing so? Of course, it would be fairly easy to develop the editor and all required enumeration utilities base on reflection from scratch. But I wanted to reuse the mechanism I introduced in <a href="http://www.codeproject.com/Articles/129830/Enumeration-Types-do-not-Enumerate-Working-around"><u>my first article of this series</u></a>. That work introduced enumeration through enumeration type members and other important features which are much more fundamental than the topic of the present article; and the code is based on the generics, which is very important for the usage of concrete enumeration types. Programming with enumeration types in a type-agnostic manner is quite tricky, which is well illustrated by the next section about the "most difficult problem".</p>

<p>So, the idea was to use reflection code developed for concrete enumeration types, which performs reflection on the generic types. For this purpose, I've segregated the abstract class <code>EnumerationItemBase</code> from the derived generic class <code>Enumeration&lt;ENUM&gt;</code>, both representing a single enumeration member with all its properties. The only addition to the base class is the generic-type property and field representing the concrete-type enumeration member value, and the reflection mechanism itself. Naturally, the type-agnostic reflection should work with the <i>runtime type</i> of the object passed from the editor (with the <i>compile-time type</i> <code>System.Object</code>, of course) and return the objects of the abstract base type <code>EnumerationItemBase</code>. This is how:</p>

<div class="pre-lang" id="premain642994"><div>C#</div><div class="pre-action-link"><span id="copycode642994" class="copy-code" data-index="642994" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre642994" style="margin-top:0;" class="lang-csharp notranslate" data-language="cs" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-keyword">internal</span> <span class="code-keyword">static</span> EnumerationItemBase[] ReflectItems(<span class="code-keyword">object</span> <span class="code-sdkkeyword">value</span>) {
    Type type = <span class="code-keyword">typeof</span>(Enumeration&lt;&gt;);
    Type enumerationType = type.MakeGenericType(<span class="code-keyword">new</span> Type[] { <span class="code-sdkkeyword">value</span>.GetType() });
    ConstructorInfo constructor = enumerationType.GetConstructor(Type.EmptyTypes);
    <span class="code-keyword">object</span> enumeration = constructor.Invoke(<span class="code-keyword">null</span>);
    IEnumerable enumerable = (IEnumerable)enumeration;
    EnumerationItemList list = <span class="code-keyword">new</span> EnumerationItemList();
    <span class="code-keyword">foreach</span> (<span class="code-keyword">object</span> @object <span class="code-keyword">in</span> enumerable)
        list.Add((EnumerationItemBase)@object);
    <span class="code-keyword">return</span> list.ToArray();
} <span class="code-comment">//</span><span class="code-comment">ReflectItems</span></pre>

<p>This code is quite sophisticated but yet very simple. The core implementation using reflection is implemented in the constructor of the generic class Enumeration&lt;enum&gt;. It is explained in detail in my first article of this series.</p>

<p>For the cases when the types of the value object appear to be non-enumeration types, please see <a href="http://www.codeproject.com/Articles/129830/Enumeration-Types-do-not-Enumerate-Working-around"><u>my first article of this series</u></a>.</p>

<p>This will also work, but here is what happens next: in both enumeration editors, I check up in the type of the edited value is enumeration type or not. Apparently, there is no any sense to edit not an enumeration type, so the editor is simply not invoked. As it's not possible to check up during compile-time if some type-level attribute is applied to a right type, this is a reasonable solution which helps the developers to see the problem as soon as possible.</p>

<p>By the way, all the key or tricky techniques of this whole work are put in one file, "EnumerationUtility.cs". We just discussed one key technique; now let's discuss the most difficult issue I faced.</p>

<h3 id="a3.2">3.2 The Most Difficult Problem: the Underlying Integer Types</h3>

<p>The real problem is the one specific to enumeration types, nothing else: they have different underlying integer types. And the mechanism of generics cannot be applied to primitive types. But working with separate bits requires using numeric integer types. Yes, this is also possible with enumeration types (as shown in <a href="http://www.codeproject.com/Articles/129830/Enumeration-Types-do-not-Enumerate-Working-around"><u>my first article of this series</u></a>), but… it requires concrete enumeration type, cannot be done directly for the abstract type <code>System.Enum</code>.</p>

<p>This would not be a problem if all of those types were unsigned (or even signed). In this case, all enumeration values could be converted to the "widest" type, for example, <code>System.UInt64</code>. No, this is impossible: there is no the "widest" type in the set of all signed and unsigned type. This is can be easily seen on the two "widest" candidates: one among the signed, another — among the unsigned types:</p>

<div class="pre-lang" id="premain706888"><div> </div><div class="pre-action-link"><span id="copycode706888" class="copy-code" data-index="706888" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre706888" style="margin-top:0;" data-language="text" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">-9223372036854775808   0                     9223372036854775807
[======================|======================] long (signed)      18446744073709551615
                      [=============================================] ulong</pre>

<p>Apparently, the domains of the values intercept. If, by some weird reason, the user of the library uses <code>ulong</code> base type and actually use high explicitly defined values for some member, the conversion to <code>long</code>, or any other signed type will throw the <code>System.InvalidCast</code> exception. If the user uses <code>long</code> and actually uses any negative member value, the attempted conversion to <code>ulong</code> will throw the same exception. What do to? I recognized several possibilities:</p>

<ol>
	<li>Using all the types which can be the underlying types of any enumeration types, which can be checked up by using the function <code>System.Enum.GetUnderlyingType</code> (see <a href="http://msdn.microsoft.com/en-us/library/system.enum.getunderlyingtype(v=vs.110).aspx"><u>http://msdn.microsoft.com/en-us/library/system.enum.getunderlyingtype(v=vs.110).aspx</u></a>). This is the most popular suggestion on the forums. What can I say? Lame, lame, lame!</li>	<li>The use of the class <code>System.Runtime.InteropServices.Marshal</code> to serialize any unknown type to array of bytes. The problem of this and next solution is that interoperation services always impose some risk of compromising of the platform compatibility of the code. Besides, the code is complex and next to impossible to debug, error-prone.</li>	<li>Similar to the above, using <code>Marshal</code> to create something analogous to C++ <code>reinterpret_cast</code>.</li>	<li>The use of the unsafe mode of the assembly would allow working with pointers to the instance of the enumeration value. Using unsafe without special need for it is, well… unsafe. Such code is simper but also can be error-prone and the problems are hard to spot; memory pinning is involved.</li>	<li>Values can be serialized into a memory stream and then parsed from a stream. Well, in addition to apparent performance hit (who cares about performance when it all happens on a separate click in the UI?), this solution is highly artificial. I call it "scratching right ear with left leg".</li></ol>

<p>So, having it all in mind, I came to probably the simplest solution: using both <code>long</code> and <code>ulong</code> types with possible handling of the exception mentioned above:</p>

<div class="pre-lang" id="premain537674"><div>C#</div><div class="pre-action-link"><span class="code-collapse" data-index="537674" id="preShrink537674">Shrink ▲</span> &nbsp; <span id="copycode537674" class="copy-code" data-index="537674" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre537674" style="margin-top:0;" class="lang-csharp notranslate" data-language="cs" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-keyword">internal</span> <span class="code-keyword">static</span> <span class="code-keyword">bool</span> IsBitSet(<span class="code-keyword">object</span> bit, <span class="code-keyword">object</span> <span class="code-sdkkeyword">value</span>) {
    <span class="code-keyword">try</span> {
        <span class="code-keyword">return</span>
            ((<span class="code-keyword">ulong</span>)Convert.ChangeType(bit, <span class="code-keyword">typeof</span>(<span class="code-keyword">ulong</span>)) &amp;     
             (<span class="code-keyword">ulong</span>)Convert.ChangeType(<span class="code-sdkkeyword">value</span>, <span class="code-keyword">typeof</span>(<span class="code-keyword">ulong</span>))) &gt; <span class="code-digit">0</span>;
    } <span class="code-keyword">catch</span> (System.InvalidCastException) {
        <span class="code-keyword">return</span>
            ((<span class="code-keyword">long</span>)Convert.ChangeType(bit, <span class="code-keyword">typeof</span>(<span class="code-keyword">long</span>)) &amp;
             (<span class="code-keyword">long</span>)Convert.ChangeType(<span class="code-sdkkeyword">value</span>, <span class="code-keyword">typeof</span>(<span class="code-keyword">long</span>))) &gt; <span class="code-digit">0</span>;
    } <span class="code-comment">//</span><span class="code-comment"> exception</span>
} <span class="code-comment">//</span><span class="code-comment">IsBitSet</span>

<span class="code-keyword">internal</span> <span class="code-keyword">static</span> <span class="code-keyword">object</span> SetBit(<span class="code-keyword">object</span> bit, <span class="code-keyword">object</span> <span class="code-sdkkeyword">value</span>) {
    Type underlyingType = Enum.GetUnderlyingType(bit.GetType());
    <span class="code-keyword">try</span> {
        <span class="code-keyword">ulong</span> numBit = (<span class="code-keyword">ulong</span>)Convert.ChangeType(bit, <span class="code-keyword">typeof</span>(<span class="code-keyword">ulong</span>));
        <span class="code-keyword">ulong</span> numValue = (<span class="code-keyword">ulong</span>)Convert.ChangeType(<span class="code-sdkkeyword">value</span>, <span class="code-keyword">typeof</span>(<span class="code-keyword">ulong</span>));
        <span class="code-keyword">ulong</span> numResult = numValue | numBit;
        <span class="code-keyword">return</span> Convert.ChangeType(numResult, underlyingType);
    } <span class="code-keyword">catch</span> (System.InvalidCastException) {
        <span class="code-keyword">long</span> numBit = (<span class="code-keyword">long</span>)Convert.ChangeType(bit, <span class="code-keyword">typeof</span>(<span class="code-keyword">long</span>));
        <span class="code-keyword">long</span> numValue = (<span class="code-keyword">long</span>)Convert.ChangeType(<span class="code-sdkkeyword">value</span>, <span class="code-keyword">typeof</span>(<span class="code-keyword">long</span>));
        <span class="code-keyword">long</span> numResult = numValue | numBit;
        <span class="code-keyword">return</span> Convert.ChangeType(numResult, underlyingType);
    } <span class="code-comment">//</span><span class="code-comment"> exception</span>
} <span class="code-comment">//</span><span class="code-comment">IsBitSet</span></pre>

<p>Apparently, the use of non-negative enumeration values is, by far, the most likely; so the code starts from the attempt of using <code>ulong</code>. In case of any negative value, <code>ulong</code> conversion is failed. Such cases are covered by using the type <code>long</code>.</p>

<p>I think this solution is the simplest and quite reliable. I will be highly excited if someone finds something better. I will be very impressed if someone finds a flaw, and will do my best to fix it.</p>

<p>In addition to the above is setting the initial value of the abstract-type enumeration value to some "generic" binary zero, which is, apparently, required to update the value from the bitwise editor. It also took some thinking but is much easier:</p>

<div class="pre-lang" id="premain70384"><div>C#</div><div class="pre-action-link"><span id="copycode70384" class="copy-code" data-index="70384" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre70384" style="margin-top:0;" class="lang-csharp notranslate" data-language="cs" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-keyword">internal</span> <span class="code-keyword">static</span> <span class="code-keyword">object</span> MakeZeroObject(Enum <span class="code-sdkkeyword">value</span>) {
    <span class="code-keyword">return</span> Convert.ChangeType(<span class="code-digit">0</span>, Enum.GetUnderlyingType(<span class="code-sdkkeyword">value</span>.GetType()));
} <span class="code-comment">//</span><span class="code-comment">MakeZeroObject</span></pre>

<p>Let's see how long this code can survive. This functionality can actually be eventually broken. To break it, 1) new CLR standard should introduce 128-bit integer types (or other types wider then <code>long</code> and ulong); 2) it should allow these types as the underlying integer type of enumeration type; 3) some user should actually use such types and use either negative or "big" values, to get in the part of the domain beyond the domain of <code>long</code> and <code>ulong</code>. If that happen, the fix will be needed to the code shown above: <code>long</code> and <code>ulong</code> should be replaced with those new type.</p>

<p>Even though 128-bit architectures are actually emerging, something is telling me that the fix won't be needed any time soon.</p>

<h3 id="a3.3">3.3 The Rest of it is Easy</h3>

<p>The creation of the editor to be used in the <code>System.ComponentModel.EditorAttribute</code> is described in MSDN, maybe not in sufficient detail, but it's not too hard to figure out. Same goes about the type converters. Please see:<br>
<code>System.ComponentModel.EditorAttribute</code>, <a href="http://msdn.microsoft.com/en-us/library/system.componentmodel.editorattribute%28v=vs.110%29.aspx"><u>http://msdn.microsoft.com/en-us/library/system.componentmodel.editorattribute%28v=vs.110%29.aspx</u></a><br>
<code>System.ComponentModel.TypeConverterAttribute</code>, <a href="http://msdn.microsoft.com/en-us/library/system.componentmodel.typeconverterattribute%28v=vs.110%29.aspx"><u>http://msdn.microsoft.com/en-us/library/system.componentmodel.typeconverterattribute%28v=vs.110%29.aspx</u></a><br>
<code>System.Drawing.Design.UITypeEditor</code>, <a href="http://msdn.microsoft.com/en-us/library/system.drawing.design.uitypeeditor%28v=vs.110%29.aspx"><u>http://msdn.microsoft.com/en-us/library/system.drawing.design.uitypeeditor%28v=vs.110%29.aspx</u></a><br>
<code>System.ComponentModel.TypeConverter</code>, <a href="http://msdn.microsoft.com/en-us/library/system.componentmodel.typeconverter%28v=vs.110%29.aspx"><u>http://msdn.microsoft.com/en-us/library/system.componentmodel.typeconverter%28v=vs.110%29.aspx</u></a></p>

<p>Both enumeration editors are based on one abstract base class implementing common functionality. This is the main editing method:</p>

<div class="pre-lang" id="premain638565"><div>C#</div><div class="pre-action-link"><span id="copycode638565" class="copy-code" data-index="638565" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre638565" style="margin-top:0;" class="lang-csharp notranslate" data-language="cs" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-keyword">public</span> <span class="code-keyword">override</span> <span class="code-keyword">object</span> EditValue(ITypeDescriptorContext context, IServiceProvider provider, <span class="code-keyword">object</span> <span class="code-sdkkeyword">value</span>) {
    <span class="code-keyword">if</span> (<span class="code-sdkkeyword">value</span> == <span class="code-keyword">null</span>) <span class="code-keyword">return</span> <span class="code-keyword">null</span>;
    Type type = <span class="code-sdkkeyword">value</span>.GetType();
    <span class="code-keyword">if</span> (!type.IsEnum) <span class="code-keyword">return</span> <span class="code-keyword">null</span>;
    treeView.Nodes.Clear();
    Populate(<span class="code-sdkkeyword">value</span>);
    edSvc = (IWindowsFormsEditorService)
        provider.GetService(<span class="code-keyword">typeof</span>(IWindowsFormsEditorService));
    edSvc.DropDownControl(treeView);
    <span class="code-keyword">return</span> UpdateData(<span class="code-sdkkeyword">value</span>, treeView);
} <span class="code-comment">//</span><span class="code-comment">EditValue</span></pre>

<p>The only less-than-obvious issue is to obtain the instance of the type shown the drop-down; it is of the type <code>IWindowsFormsEditorService</code>.</p>

<p>The rest of the code uses the enumeration utility described above and the facilities explained in my first and second articles of the series.</p>

<h2 id="a4">4. Conclusions</h2>

<p>The present work rounds up my series on enumerations pretty well. The most recent version of all of the code covered by all the articles of the series can be found in the source code of the present article. The previous article adds library of the more application character: command line utility.</p>

<p>However, I've already made one little mistake in my previous article on the topic: I called it the last one in the series. At this moment, I also feel that the present article is the last one, but this time I am not so sure. If, by any chance, I got another idea on the topic, I'll try to write about it. If some readers give ask me an interesting question or give me another idea on the topic in this or any other way, I'll be very excited about it and will try to work at it. Which brings us to the last section…</p>

<h2 id="a5">5 Credits</h2>

<p>I want to mention two CodeProject members in connection to this work.</p>

<p><a href="http://www.codeproject.com/Members/Grant-Frisken"><u>Grant Frisken</u></a> is the author of this CodeProject article: <a href="http://www.codeproject.com/Articles/19953/Localizing-NET-Enums"><u>Localizing .NET Enums</u></a>. He argued with me on the features of my library described in my first work. He insisted on the importance of the use of the type converters and <code>System.ComponentModel.TypeConverterAttribute</code>. I always criticized <code>System.ComponentModel</code> for pure maintainability and general architectural flaws and insisted that my approach has more fundamental and clear character. I hope we finally understood each other in this very interesting and friendly discussion. To finally reconcile our opinions, I can now add that this first work was correct, and it wasn't the place for the type converter, because it was unrelated to any UI. However, providing the "editability" for an enumeration type through PropertyGrid really requires the use of the type converters. It's just the right moment for doing so has come. :-)</p>

<p>Even though Grant's information did not give me the idea of the present work (which stems from my own works unrelated to the topic and my enumeration-related works referenced at the beginning of the article), I want to credit his interesting and useful article, and himself, for deep understanding of the matter and being a knowledgeable, helpful, open-minded and collaborative developer and a community member.</p>

<p>As to the idea of the present work… <a href="http://www.codeproject.com/Members/bigbro_1985"><u>Bigbro_1985</u></a> asked me several interesting questions which just inspired me to write this article. Also, he brought the idea of using a tooltip to my attention; and I used the tree node tooltips for showing the description texts of the enumeration members. Thank you, Marco!</p>

<p>[UPDATE]</p>
On April 4, 2017, <a href="https://www.codeproject.com/script/Membership/View.aspx?mid=26923"><u>BillWoodruff</u></a> reported a critical problem I've fixed on the same day.




						</div>
						

						
						<h2>License</h2>
						<div id="LicenseTerms"><p>This article, along with any associated source code and files, is licensed under <a href="http://www.codeproject.com/info/cpol10.aspx" rel="license">The Code Project Open License (CPOL)</a></p></div>
						

						
						<br>
						
						    <br>
						
						

						<div class="clearfix"></div>

						<div style="padding-top:8px">
							
						</div>

					

				    
					</form>

				</div>

				
				<div class="bottom-promo"> 
				    
				</div>
				
                
                

				
				
				

			</div>
			

            
            
            

        </div>
        

		
		<div class="site-footer">
			<div class="align-left">
				<a id="ctl00_PermaLink" href="https://www.codeproject.com/Articles/809357/Bitwise-Enumeration-Editor-for-PropertyGrid-and-Vi">Permalink</a><br>
				<br>
				<a id="ctl00_PrivacyLink" href="https://www.codeproject.com/info/privacy.aspx">Privacy</a><br>
    			<a id="ctl00_CookiePolicyLink" href="https://www.codeproject.com/info/cookie.aspx">Cookies</a><br>
                <a id="ctl00_TermsOfUseLink" href="https://www.codeproject.com/info/TermsOfUse.aspx">Terms of Use</a><br>
			</div>

            <div class="align-center">
				


<div class="page-width">
    Layout: <a id="ctl00_PageWidth_FixedT" title="Fixed width layout" rel="nofollow" class=" active" href="https://www.codeproject.com/Articles/809357/Bitwise-Enumeration-Editor-for-PropertyGrid-and-Vi?PageFlow=FixedWidth">fixed</a>
    |
    <a id="ctl00_PageWidth_FluidT" title="Fluid layout" rel="nofollow" href="https://www.codeproject.com/Articles/809357/Bitwise-Enumeration-Editor-for-PropertyGrid-and-Vi?PageFlow=Fluid">fluid</a>
</div>


				

				

	            

                <br>
			</div>
                
			<div class="align-right">
				Article Copyright 2014 by Sergey Alexandrovich Kryukov<br>Everything else
				Copyright © <a href="mailto:webmaster@codeproject.com">CodeProject</a>, 1999-2024<br>
                <br>
				Web01 
				2.8:2024-12-08:1<br>
			</div>
		</div>
		

		<br clear="all">
		
			

	</div> 
	</div> 
</div>







<script type="text/javascript"> // DEFERRED script

document.addEventListener('DOMContentLoaded', function() {

	new CodeBlocks().initialise('#contentdiv');
	
	$('.author-wrapper .description').shorten({showChars: 400});
	
	anchorAnimate();
	
	$('#__EVENTVALIDATION').attr('autocomplete', 'off');

})
</script>










<style type="text/css">.copied::after {  position: absolute;  right: 0;  display: inline-block; white-space: nowrap; content: 'copied'; color: #fff; background-color: #f90;  border-radius: 3px; padding:1px 8px; opacity: 0;  will-change: opacity, transform; animation: showcopied 1.5s ease; } @keyframes showcopied { 0% { opacity: 0; } 70% { opacity: 1; } 100% { opacity: 0; } } </style><canvas id="cv1" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas><canvas id="cv2" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas></body><grammarly-desktop-integration data-grammarly-shadow-root="true"><template shadowrootmode="open"><style>
      div.grammarly-desktop-integration {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
        -moz-user-select: none;
        -webkit-user-select: none;
        -ms-user-select:none;
        user-select:none;
      }

      div.grammarly-desktop-integration:before {
        content: attr(data-content);
      }
    </style><div aria-label="grammarly-integration" role="group" tabindex="-1" class="grammarly-desktop-integration" data-content="{&quot;mode&quot;:&quot;full&quot;,&quot;isActive&quot;:true,&quot;isUserDisabled&quot;:false}"></div></template></grammarly-desktop-integration></html>