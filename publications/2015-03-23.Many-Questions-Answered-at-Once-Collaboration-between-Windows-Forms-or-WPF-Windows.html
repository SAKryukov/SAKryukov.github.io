<!DOCTYPE html>
<!-- saved from url=(0090)https://www.codeproject.com/Tips/889332/Many-Questions-Answered-at-Once-Collaboration-betw -->
<html lang="en" data-lt-installed="true"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

	
	<link rel="preconnect" href="https://www.google-analytics.com/">

	<link rel="preconnect" href="https://www.codeproject.com/">


	<link rel="preload" href="./Resources/logo250x135.gif" as="image">


	<link rel="preload" href="https://www.codeproject.com/App_Themes/CodeProject/Img/logo135-bg.gif" as="image">
	<link rel="preload" href="./Resources/jquery-3.4.1.min.js.download" as="script" type="text/javascript">


	<title>Many Questions Answered at Once — Collaboration between Windows Forms or WPF Windows- CodeProject</title> 
    
	<link type="text/css" rel="stylesheet" href="./Resources/Article.min.css">


    <script type="text/javascript" async="" src="./Resources/analytics.js.download"></script><script type="text/javascript" src="./Resources/jquery-3.4.1.min.js.download" defer=""></script>
<script type="text/javascript" src="./Resources/article.min.js.download" defer=""></script>

	
<meta http-equiv="content-language" content="en-US">

<meta name="Description" content="Popular question on Forms collaboration, also answered for WPF">
<meta name="Keywords" content="VS2008, C#, .NET, Visual-Studio, Dev, Design, Beginner, GUI">
<meta name="Author" content="Sergey Alexandrovich Kryukov">
<meta name="Rating" content="General">
<meta name="Revisit-After" content="1 days">
<meta name="application-name" content="CodeProject">
<meta name="google-translate-customization" content="d908bb7ce7aff658-4c2f3a504525c916-g629383f736781a8a-13">



<link rel="dns-prefetch" href="https://ajax.googleapis.com/"> 
<link rel="canonical" href="https://www.codeproject.com/Tips/889332/Many-Questions-Answered-at-Once-Collaboration-betw">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@CodeProject">
<meta name="og:site_name" content="CodeProject">
<meta name="twitter:creator" content="@CodeProject">
<meta property="og:type" content="article">
<meta property="article:published_time" content="3/23/2015 12:54:00 AM">
<meta property="article:modified_time" content="3/26/2015 10:19:00 AM">
<meta name="twitter:label1" content="Written by">
<meta name="twitter:data1" content="Sergey Alexandrovich Kryukov">
<meta name="twitter:label2" content="Reading time">
<meta name="twitter:data2" content="10 min read">
<meta property="og:url" content="https://www.codeproject.com/Tips/889332/Many-Questions-Answered-at-Once-Collaboration-betw">
<meta property="og:title" content="Many Questions Answered at Once — Collaboration between Windows Forms or WPF Windows">
<meta property="og:description" content="Popular question on Forms collaboration, also answered for WPF">


<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="apple-touch-icon" sizes="144x144" href="https://www.codeproject.com/favicon/apple-touch-icon.png"> 
<link rel="icon" type="image/png" sizes="32x32" href="https://www.codeproject.com/favicon/favicon-32x32.png"> 
<link rel="icon" type="image/png" sizes="16x16" href="https://www.codeproject.com/favicon/favicon-16x16.png"> 
<link rel="manifest" href="https://www.codeproject.com/favicon/manifest.json"> 
<link rel="mask-icon" href="https://www.codeproject.com/favicon/safari-pinned-tab.svg" color="#ff9900">
	<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "TechArticle",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.codeproject.com/Tips/889332/Many-Questions-Answered-at-Once-Collaboration-betw"
   },
  "name": "Many Questions Answered at Once — Collaboration between Windows Forms or WPF Windows",
  "headline": "Many Questions Answered at Once — Collaboration between Windows Forms or WPF Windows",
  "url": "https://www.codeproject.com/Tips/889332/Many-Questions-Answered-at-Once-Collaboration-betw",
  "discussionUrl": "https://www.codeproject.com/Tips/889332/Many-Questions-Answered-at-Once-Collaboration-betw#_comments",
  "isFamilyFriendly": "true",
  "image": "https://www.codeproject.com/App_Themes/CodeProject/Img/Article100.png",
  "keywords": "VS2008,C#,.NET,Visual-Studio,Dev,Design,Beginner,GUI",
  "commentCount": "0",
  "editor" : {
    "@type" : "Person",
    "name" : "Editor",
    "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=2291164"
  },
  "license": "http://www.codeproject.com/info/cpol10.aspx",
  "publisher" : {
    "@type" : "Organization",
    "name" : "CodeProject"
  },
  "description": "Popular question on Forms collaboration, also answered for WPF",
  "articleSection": "C#",
  "author" : [{
      "@type" : "Person",
      "name" : "Sergey Alexandrovich Kryukov",
      "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=2291164"
    }],
  "datePublished": "2015-03-23",
  "dateCreated": "2015-03-23",
  "dateModified": "2015-03-26"
,
  "contentRating" : {
    "@type" : "Rating",
    "ratingValue" : 5.00,
    "bestRating" : 5,
    "worstRating" : 1
  }
}</script>

<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
    "@type": "ListItem",
    "position": 1,
    "item" : {
      "@id" : "/script/Content/Tag.aspx?tags=Languages",
      "name" : "Languages"
    }
  },{
    "@type": "ListItem",
    "position": 2,
    "item" : {
      "@id" : "/script/Content/Tag.aspx?tags=Csharp",
      "name" : "C#"
    }
  }]
}</script>


	<!--<base target="_top">--><base href="." target="_top">
	
    


<script type="text/javascript">
function defrm () { /* thanks twitter */
    document.write = '';
    window.top.location = window.self.location;
    setTimeout(function() { document.body.innerHTML = ''; }, 0);
    window.self.onload = function(evt) { document.body.innerHTML = ''; };
}

if (window.top !== window.self) {
    try {
        if (window.top.location.host) { /* will throw for all except chrome */ }
        else { defrm(); /* chrome */ }
    } catch (ex) { defrm(); /* everyone else */ }
}

// Specific case where a site is screwing with us.
if (typeof(DemoUrl) !== 'undefined') {
    document.write(unescape('%3Cme') + 'ta http' + '-equiv="re' + 'fresh con' +
                           'tent="1;url=' + DemoUrl + unescape('"%3CE'));
}
</script>
	





    <script async="" type="text/javascript" src="./Resources/js"></script>
    <script type="text/javascript">
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-1735123-1' , {'user_id': '42a7d533-9829-4f88-8fc6-84dc936250c9'});
    </script>

<style type="text/css"></style></head>	

<body class="chrome chrome120" data-new-gr-c-s-check-loaded="14.1215.0" data-gr-ext-installed="">



<a class="access-link" href="https://www.codeproject.com/Tips/889332/Many-Questions-Answered-at-Once-Collaboration-betw#Main"><img alt="Click here to Skip to main content" src="./Resources/t.gif"></a>




<div class="page-background">

	
	

	

	
    <div id="ctl00_STM" class="site-top-menu fixed narrow">
        <div class="main-content">
            

<div class="container memberbar clearfix flex-container flex-extend">

	<div id="ctl00_MemberBar_GenInfo" class="flex-item align-left">65,938 articles</div>
	
	<div id="ctl00_MemberBar_ChangeNotice" class="flex-item align-left">CodeProject
	is changing. <a href="https://www.codeproject.com/info/Changes.aspx">Read more</a>.</div>

	<div class="flex-item">
		
	</div>

	<div class="flex-item align-right">

		

		

		
	</div>
</div>
        </div>
    </div>

	
    <div id="ctl00_SH" class="site-header fixed narrow">
        <div class="main-content">
            <div class="logo"><a href="https://www.codeproject.com/"><img id="ctl00_Logo" tabindex="1" title="CodeProject" src="./Resources/logo250x135.gif" alt="Home" style="height:135px;width:250px;border-width:0px;"></a></div>
            <div class="promo"></div>
        </div>
    </div>

	
			
	

	<div id="A" class="container-content-wrap fixed narrow"> 

	<div class="container-content">

        
		<div class="clearfix">
			<div class="container-breadcrumb float-left ">
				<div><a rel="nofollow" href="https://www.codeproject.com/script/Content/SiteMap.aspx">Articles</a> / <a rel="nofollow" href="https://www.codeproject.com/script/Content/Tag.aspx?tags=Languages">Languages</a> / <a rel="nofollow" href="https://www.codeproject.com/script/Content/Tag.aspx?tags=Csharp">C#</a></div>
			</div>

            <div class="float-left">
				
			</div>

			<div class="edit-links float-right">
				



 
&nbsp;










			</div>

			<div class="article-nav float-right">
				


<div style="display:inline-block;position:relative;top:-6px;margin-right:20px">
    
</div>



 

<a id="ctl00_ActionLinks_PrintMd" data-tooltip="Print" data-enabletooltip="true" data-width="auto" href="https://www.codeproject.com/Tips/889332/Many-Questions-Answered-at-Once-Collaboration-betw?display=Print" class="tooltip" title="">
   <img src="./Resources/print48.png" width="24" height="24" style="border:0">
<div class="speech-bubble-container-up" style="width:auto">  <div class="speech-bubble-up" style="text-align:center"> Print</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>



<span id="ctl00_ActionLinks_R">
    
    
</span>
			</div>
		</div>

        
		<div class="extended article-container-parts">

			
		    
            

			
			<div id="AT" class="article-container  fixed narrow" style="max-width:inherit;"> 

				<div class="article">

					<form name="aspnetForm" method="post" action="https://www.codeproject.com/Tips/889332/View.aspx" id="aspnetForm" style="margin:0;padding:0">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="o9uWiTxfTUl/Kf1sEejlD714WiJCW3Q0jS01Ga1dblDtClixy784XFT2834abOF0/pNVbjgTFjcviGagSB3iPN9+xQxcnu4poIRrUBpUFhgRsCdUnGh07H02EUhZtXW+KgH5vRYgswZ2vgZGSKnPQrX9Ue1EcoR4dFHdahPXCkVk5vKLgfECPxGTQ8tbG95nutRxZ4CfwnacJ9FVvhpEFBR7UT3fXIecepwVXVyEsb0vf1vT9XNyjtmfccq913NXReKJzzy8GtlQvwKQERimgQF2bMUtZTF0fdpiNveyXrcsA8QGl6fwuS/CxuKy5xzKTE7QGlPEknnNLXAxJTlMfCG7oofa4LSL9omz+9M5u138sQq3LyPR0tyy3o4zmoWTWMXXveH0AqkEvS9YdwPOXweZsRtVwoKqpxixLwGJbQJiyXoj222adHbQTtcRWnmZoEIb2/85/XdNQCggOSI7fM1c9+03IIYy0UqIoOVR/6I7hhBSSgo/0b9+QtcOZV68tnMdB5WfcketME0LYKwCG+rXYc3abCC2g6Cn690RkKnpf21DogexVnQBtelAmf99hY3sWGjq4TSsCP8bePXAl8edSdl/4eRTp4uaCrlW917Deo4E2ndvK5XB/UsIHZ7xPiQx16lvUWm/fpLMVsPyrHDl7IdCiMUW/PNYbUR99p7XAgP0UzFzZRQYRut7PRrpnEGCDNe3CIPtcbSjIhuz4IjjVgllDvk9aQXb10E7IJox9/4ctoC11XMsgj0AuYBgoOQvTBI3UeuA+biwI4B4JCG8JPor23xxSYHZDiPZ5QQqlwtvpJqMSPWX71oh0DYw0sBvcni+gnSISluLPbuXeERiz5kyDbGDYifvlFg1O5/PSIsNILyWvzOXXufl+fCgXuPeIn3nlsTvrio2OySmiAGkb1wZa/Gzdf8MlMv0MQtMjX2ufxZoz+fQ17eZWNRIsh3D6SlbrVIVNFoMxYSUDF3gZfOel10gWm0B7hXj3pPOqd27oinxWb6T6/vy/ld1GgXW+ke24lpnjXg2JqB/6CkZ0UvDkEe9fKPsNRZQ+5DGZRidYKWsa5zz2dhbFxlfMd6wpsaBp0uL4iwskHX4cqYKCLlboeo6rouThTLywDdARw5s0FL1xTOFpr4PYv0H5nDbw84VYjgvc1DmPB8/IxRjEY8EE5sNYLU4HKaDyiV34837NWzIvwcELCe2QHy9wSrkbvGbRY71sCjk7rs4ows5ePeq93dsqDF/zhD5ZrxXbfPfxeN3OLyTI3RxiEmePBaL3Jcv/fx8jV3vrNIo0tj/cnbFIVjjol5rxhAiKYc7e04lodOgf1jqXi84lrSHgLPFGfJC+4atRYxMjtTjVCUoyobPwwGcfvfhOp08w1RQny2MO25CSEfRitw1/JA77vITeB8r/WXSQYEvg2Xd9c8Wnz0fjyH8J7GbydXqPiHYd9B/Rs6q3j8zbN8GU6kpxjILJjelYTcm3qCAvYYGXh9Y5dRs6u8Yd/TStugIusXlNwr9aredZANoXB0l2A2UUPpcAgfWBnmEcMX9jq6Ej+CTI9WxMTXChaVa9dNq4WZN72nJk0S8iGOGt2VENeFE7mEHpihfM8NeNAnTvSSlX7qusTB5z6zd+Jklg6rvt9a9z0uLlAIM3q/msv+QJq2AnAl+zsnuWkCETYx4XfbQ7y7ejpMU44GVSm0yiuZLsYbn5J/Wq4x3/D+W7jsDjrKGPVAc+raxBwpTPu3lwgYDbxssFcwr/I9HHboy8TtzhTTYj0tRZ88lkDnGCGT8hDV0f4pgUlwPHxNO3eDU4FzPr/kN0wApv9i1q9ORbahAqj9/YBwsbg1nNczlYyf8c9meK/esREqcYpc+2ENikVgCKLLyjijJ1owuRkq6BkROITkk6zRUE2cquK4nU51qn2tqIEBBSGm7LmZjhMzlMZbTQhCbFrBqyTKgWXb1yVsAhmhU0y3AQpzt0qud+Dk/ZchxP0+9+TISDTwdbl5jqIHTcwSY+sBYxclMa0j76GL18qvEiRAHwIVVu0Mif8RGqMzvJV9Jc1MNGbAe0zspX+YcDCf6Un1OyiPRfNoGRJord1NFw0QI7BrOs2J+PfJ75j8+lJDGEivRHWAn3gAHuA5Bysm4MQaCojFsiptycGr0D8UF59HFOScehGLeGCtcPNnsJpmbi6v/hBO74U8k0XialK7idy+ExsBzw2u7RVc2U2aY22dlWgIon0TQW7oyLZpVUMrxLg==">
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="10C1FD69">
</div>

					
					 
					<div class="header">
					    <a name="Main"></a>
					    <a name="_articleTop" id="_articleTop"></a>

					    
						<div>
							<span id="ctl00_TagListHorz_TagWrp" class="tags horizontal">

	
	

	
	<span id="ctl00_TagListHorz_VisibleTags"><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/VS2008" data-id="77">VS2008</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/Csharp" data-id="81">C#</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/.NET" data-id="98">.NET</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/Visual-Studio" data-id="103">Visual-Studio</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/GUI" data-id="998">GUI</a></div></span> 

	
	
</span>


						</div>
					    <div class="title">
					        <h1 id="ctl00_ArticleTitle">Many Questions Answered at Once — Collaboration between Windows Forms or WPF Windows</h1>
					    </div>

                        <div>
					        
					        <div class="entry flex-container">

								

                                <div class="flex-item" style="flex:1 1 auto">
                                    <div class="flex-container" style="justify-content:space-between;flex-wrap:wrap-reverse">
                                       <span id="ctl00_Authors" class="author flex-item"><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=2291164" rel="author">Sergey Alexandrovich Kryukov</a></span> 

                                        <div class="flex-item" style="margin-top:-4px;">
                                            <div id="ctl00_RateArticle_RatingTable" class="small-text" data-objectref="2_889332">

	<meta itemprop="upvoteCount" content="10">


	<div id="ctl00_RateArticle_RatingRow" class="flex-container rating-container large-stars">

					
		

		
		<div class="nowrap tooltip">

			
			<div id="ctl00_RateArticle_ResultNoHist" class="rating-result"><div class="flex-container rating-stars large-stars"><div><img src="./Resources/star-fill-lg.png" style="width:24px;height:24px"></div><div><img src="./Resources/star-fill-lg.png" style="width:24px;height:24px"></div><div><img src="./Resources/star-fill-lg.png" style="width:24px;height:24px"></div><div><img src="./Resources/star-fill-lg.png" style="width:24px;height:24px"></div><div><img src="./Resources/star-fill-lg.png" style="width:24px;height:24px"></div></div></div>
			

			
			

			
            

			
                

		</div>
		
	
		
		<div id="ctl00_RateArticle_VoteCountNoHist" class="rating-votes nowrap">5.00/5  (10 votes)</div>	

		

		
		<div class="rating-undo" title="Undo vote" style="margin-left:5px;display:none"></div>

		
		
	</div>

	
	

</div>

                                        </div>
                                    </div>

                                    <div class="flex-container" style="color:#666;font-size:smaller">
                                        <span id="ctl00_LastUpdated" class="date flex-item-tight" title="Date last updated">23 Mar 2015, last revision: 26 Mar 2015</span><a id="ctl00_LicenseLink" title="The Code Project Open License (CPOL)" class="license flex-item-tight" href="http://www.codeproject.com/info/cpol10.aspx">CPOL</a><span id="ctl00_ReadingTime" class="stats flex-item-tight">10 min read</span><span id="ctl00_HorizontalStats" class="stats flex-item-tight"><span class="stats"><span title="Views"><img src="./Resources/views32.png" style="width:16px"> 40.8K</span> &nbsp; <span title="Downloads"><img src="./Resources/download32.png" style="width:16px"> 222</span> &nbsp; </span></span>
                                    </div>
                                </div>
					        </div>

                            

                        </div>

                        <div id="ctl00_DescriptionSpot" class="summary">Popular question on Forms collaboration, also answered for WPF</div><span id="ctl00_ThumbnailUrl" class="date" content="https://www.codeproject.com/script/Articles/Images/tip100x80.png"></span>			

                    </div>
                    
					
					

					

					
					

					
					

						
					

					

						
						<div id="contentdiv" class="text">
						



<!-- Article Starts -->

<ul class="download">
	<li><a href="Many-Questions-Answered-at-Once-Collaboration-between-Windows-Forms-or-WPF-Windows.zip">Download code samples — 18.2 KB</a></li></ul>

<ol>
	<li><a href="https://www.codeproject.com/Tips/889332/Many-Questions-Answered-at-Once-Collaboration-betw#a1">Motivation</a></li>	<li><a href="https://www.codeproject.com/Tips/889332/Many-Questions-Answered-at-Once-Collaboration-betw#a2">The Idea</a></li>	<li><a href="https://www.codeproject.com/Tips/889332/Many-Questions-Answered-at-Once-Collaboration-betw#a3">Example of Collaboration</a></li>	<li><a href="https://www.codeproject.com/Tips/889332/Many-Questions-Answered-at-Once-Collaboration-betw#a4">Sample Solution for System.Windows.Forms</a></li>	<li><a href="https://www.codeproject.com/Tips/889332/Many-Questions-Answered-at-Once-Collaboration-betw#a5">Sample Solution for WPF</a></li>	<li><a href="https://www.codeproject.com/Tips/889332/Many-Questions-Answered-at-Once-Collaboration-betw#a6">Some Notes on Other Solutions</a></li>	<li><a href="https://www.codeproject.com/Tips/889332/Many-Questions-Answered-at-Once-Collaboration-betw#a7">Is the Collaboration Good or Evil?</a></li>	<li><a href="https://www.codeproject.com/Tips/889332/Many-Questions-Answered-at-Once-Collaboration-betw#a8">Conclusions</a></li></ol>

<p><a name="a1"></a></p>

<h2>1 Motivation</h2>

<p>This simple article is supposed to be one of the long-planned "Many Questions Answered at Once" series, that is, its main purpose is the use for answering questions in the CodeProject's <a href="http://www.codeproject.com/suggestions.aspx">Questions &amp; Answers forum</a>. I prepared the code for the first article a long time ago, to answer different questions at once, but still could not find time to complete it. This time, when I found that the question is not only popular but requires more detailed explanation, I decided to answer just one kind of question (depending how you count them, with WPF it can be counted as two).</p>

<p>The question is very trivial and mainly comes from the beginners. Everything is reduced to the following situation. One has two forms with control X in one and control Y in another. The user manipulates with first form, so something happens with X: selection is changed, button is pressed (the some other control is also involved, say, its value is retrieved). The questions are: how to reflect to these changes in Y: to add data in <code>ListBox</code>, <code>ListView</code>, <code>GridView</code>, copy some data from X to Y or from Y to X, find and select some item, show some data, anything like that. The questions are usually asked for <code>System.Windows.Forms</code> forms, sometimes for WPF windows.</p>

<p><a name="a2"></a></p>

<h2>2 The Idea</h2>

<p>People published many solutions for this "problem", but none of them was really robust or comprehensive.</p>

<p>If the application is simple enough, the solution could be as simple as declaring of some <code>internal</code> property in one form and passing a reference to the instance of one form to the instance of another form. For more complex projects, such violation of strictly encapsulated style and <i>loose coupling</i> could add up the <i>accidental complexity</i> of the code and invite mistakes, so the well-encapsulated solution would be preferable.</p>

<p>Please see:<br>
<a href="http://en.wikipedia.org/wiki/Accidental_complexity">http://en.wikipedia.org/wiki/Accidental_complexity</a>,<br>
<a href="http://en.wikipedia.org/wiki/Loose_coupling">http://en.wikipedia.org/wiki/Loose_coupling</a>.</p>

<p>Often, it was advised to use delegates or events, but this is just a distraction from the main issue: how forms should be make known to each other.</p>

<p>So, what to do for more complex application which needs to be neat? I believe the approach should be the most general. As form classes are isolated from each other by default, their means of communications should be abstracted from the form detail, and, as the form types always have some base classes, the only mean of abstraction is the use of interface types. One form implements some interface known to both forms. The reference to one form is passed to another form in the form of interface reference. This way, one form has no access to another form beyond the interface, which separates concerns and makes collaboration perfectly safe.</p>

<p>See also: <a href="http://en.wikipedia.org/wiki/Separation_of_concerns">http://en.wikipedia.org/wiki/Separation_of_concerns</a>.</p>

<p>This is one feature which highly facilitates this: partial class declaration. In each separate partial declaration any base types are not required to be repeated in the inheritance list of each partial declaration. For example, one form file is auto-generated; and your forms inherits from <code>System.Window.Forms.Form</code>. It is not repeated in the other partial declaration of the same form type in the other file. Then the developer can create another partial declaration, with only one element of the inheritance list, the interface, and implement the interface in this part. It will separate the aspects of the interface from other code, improving maintainability.</p>

<p><a name="a3"></a></p>

<h2>3 Example of Collaboration</h2>

<p>For example, let's say we want to add the content of some <code>TextBox</code> to some visual data container in another form or window. The form calling the method of such mechanism should not be aware of the nature of controls involved, it just adds some text using some <code>Add(string)</code> method. The detail of presentation of this accumulated data can be different: this is the implementation detail of the second form/window. We can add data to some <code>ListBox</code> or some instances of <code>TextBox</code> added to some panel. How to implement it? <a name="a4"></a></p>

<h2>4 Sample Solution for System.Windows.Forms</h2>

<p>First, let's define the interface. In our example, it can be very simple:</p>

<div class="pre-lang" id="premain415985"><div>C#</div><div class="pre-action-link"><span id="copycode415985" class="copy-code" data-index="415985" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre415985" style="margin-top:0;" class="lang-csharp notranslate" data-language="cs" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-keyword">internal</span> <span class="code-keyword">interface</span> ICollaboration {
    <span class="code-keyword">void</span> Add(<span class="code-keyword">string</span> text);
} <span class="code-comment">//</span><span class="code-comment">interface ICollaboration</span></pre>

<p>Let's implement the presentation of added strings in the form of <code>FlowLayoutPanel</code>, which will collect read-only instances of <code>TextBox</code> control, which allows the user to see distinct instances of strings, even if they are multi-line texts.</p>

<p>I'll show all the code in without using any designers or XAML. Such code is much shorter, more elegant and easy for understanding and explanations. Please see the downloadable sample code which comes with the library. I show to the code used in the article in one file. In practice, all partial declarations can be put in separate file, as it is intended. I also include variants of projects written with the designer and XAML.</p>

<p>This is the implementation:</p>

<div class="pre-lang" id="premain187934"><div>C#</div><div class="pre-action-link"><span id="copycode187934" class="copy-code" data-index="187934" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre187934" style="margin-top:0;" class="lang-csharp notranslate" data-language="cs" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-keyword">partial</span> <span class="code-keyword">class</span> ShowForm : ICollaboration {
    FlowLayoutPanel panel = <span class="code-keyword">new</span> FlowLayoutPanel();
    <span class="code-keyword">void</span> ICollaboration.Add(<span class="code-keyword">string</span> text) {
        Show();
        TextBox textBox = <span class="code-keyword">new</span> TextBox();
        textBox.Text = text;
        textBox.ReadOnly = <span class="code-keyword">true</span>;
        textBox.Multiline = <span class="code-keyword">true</span>;
        textBox.ScrollBars = ScrollBars.Both;
        textBox.Height *= <span class="code-digit">4</span>;
        panel.Controls.Add(textBox);
        panel.ScrollControlIntoView(textBox);
        textBox.Focus();
    } <span class="code-comment">//</span><span class="code-comment">ICollaboration.Add</span>
} <span class="code-comment">//</span><span class="code-comment">class ShowForm</span></pre>

<p>The other partial declaration of the same class shows just the setup for the form:</p>

<div class="pre-lang" id="premain340369"><div>C#</div><div class="pre-action-link"><span id="copycode340369" class="copy-code" data-index="340369" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre340369" style="margin-top:0;" class="lang-csharp notranslate" data-language="cs" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-keyword">partial</span> <span class="code-keyword">class</span> ShowForm : Form {
    <span class="code-keyword">internal</span> ShowForm() {
        Text = DefinitionSet.showWindow;
        panel.Dock = DockStyle.Fill;
        panel.Parent = <span class="code-keyword">this</span>;
        panel.AutoScroll = <span class="code-keyword">true</span>;
        <span class="code-keyword">this</span>.ShowInTaskbar = <span class="code-keyword">false</span>;
        <span class="code-keyword">this</span>.FormClosed += (sender, eventArgs) =&gt; { Application.Exit(); };
    } <span class="code-comment">//</span><span class="code-comment">ShowForm</span>
} <span class="code-comment">//</span><span class="code-comment">class ShowForm</span></pre>

<p>Note that the interface <code>ICollaboration</code> is shown in the inheritance list only of one of the parts, where it is implemented, and the base class is shown only in another part. Both members of the inheritance list are shown only once; this is a really decent style of writing partial declarations.</p>

<p>How this interface can be used in the other form? I put it as the last member of the form class, the property <code>ICollaboration CollaborationForm</code>. This is the complete class definition:</p>

<div class="pre-lang" id="premain993823"><div>C#</div><div class="pre-action-link"><span class="code-collapse" data-index="993823" id="preShrink993823">Shrink ▲</span> &nbsp; <span id="copycode993823" class="copy-code" data-index="993823" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre993823" style="margin-top:0;" class="lang-csharp notranslate" data-language="cs" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-keyword">class</span> MainForm : Form {
    <span class="code-keyword">internal</span> MainForm() {
        Text = DefinitionSet.mainWindow;
        <span class="code-keyword">this</span>.Padding = <span class="code-keyword">new</span> Padding(<span class="code-digit">4</span>);
        Panel fill = <span class="code-keyword">new</span> Panel();
        fill.TabIndex = <span class="code-digit">1</span>;
        fill.Dock = DockStyle.Fill;
        TextBox textBox = <span class="code-keyword">new</span> TextBox();
        textBox.TabIndex = <span class="code-digit">1</span>;
        textBox.Multiline = <span class="code-keyword">true</span>;
        textBox.Dock = DockStyle.Fill;
        textBox.Parent = fill;
        Panel bottom = <span class="code-keyword">new</span> Panel();
        bottom.TabIndex = <span class="code-digit">2</span>;
        bottom.Dock = DockStyle.Bottom;
        Button button = <span class="code-keyword">new</span> Button();
        bottom.Height = button.Height * <span class="code-digit">2</span>;
        button.Dock = DockStyle.Left;
        button.Parent = bottom;
        button.Text = DefinitionSet.button;
        bottom.Padding = <span class="code-keyword">new</span> Padding(<span class="code-digit">0</span>, <span class="code-digit">4</span>, <span class="code-digit">0</span>, <span class="code-digit">0</span>);
        Controls.Add(fill);
        Controls.Add(bottom);
        button.Click += (sender, eventArgs) =&gt; {
            <span class="code-keyword">if</span> (CollaborationForm != <span class="code-keyword">null</span>)
                CollaborationForm.Add(textBox.Text); <span class="code-comment">//</span><span class="code-comment"> it makes it a closure</span>
        }; <span class="code-comment">//</span><span class="code-comment">button.Click</span>
        textBox.TextChanged += (sender, eventsArgs) =&gt; {
            button.Enabled = !string.IsNullOrEmpty(textBox.Text);
        }; <span class="code-comment">//</span><span class="code-comment">textBox.TextChanged</span>
        button.Enabled = <span class="code-keyword">false</span>;
    } <span class="code-comment">//</span><span class="code-comment">MainForm</span>
    <span class="code-keyword">internal</span> ICollaboration CollaborationForm { <span class="code-keyword">get</span>; <span class="code-keyword">set</span>; }
} <span class="code-comment">//</span><span class="code-comment">class MainForm</span></pre>

<p>This class is called "MainForm" only because the instance of this form is used as the main form in the entry-point method, but actually it has no significance. One form is aware of another one. It can have only the interface reference representing another form, without access to any form detail, which provides better encapsulation. One form calls the method(s) of another form as the interface method, through the interface reference.</p>

<p><a name="irrelevant"></a></p>

<p>Also, it is absolutely irrelevant to the direction of passing data. One form calls the method of another form. This method can send data to another form or receive data, or both; other method can do anything else. I may involve any data or not. As to the other aspects, such as using events or delegates, they also can be used through the interface: one form can add a handler to the invocation list of some event of the other form, set or get some delegate instance, read or set some property, and so on.</p>

<p>In our examples, one form holds an interface reference to another form, so one form "knows" another one, and another form remains agnostic to the first one. In other cases, the forms can implement two different interfaces and exchange interface references, thus "knowing" each other, but the interfaces would remain agnostic to the forms themselves and form identities.</p>

<p>Now, we need to establish this relationship between two instances of two form classes. It can be done at any time in any place of code, but the simplest way to demonstrate it would be to implement it in the entry-point of the application:</p>

<div class="pre-lang" id="premain273504"><div>C#</div><div class="pre-action-link"><span id="copycode273504" class="copy-code" data-index="273504" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre273504" style="margin-top:0;" class="lang-csharp notranslate" data-language="cs" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-keyword">class</span> EntryPoint {
    <span class="code-keyword">static</span> <span class="code-keyword">void</span> Main() {
        MainForm main = <span class="code-keyword">new</span> MainForm();
        ShowForm secondForm = <span class="code-keyword">new</span> ShowForm();
        main.CollaborationForm = secondForm;
        secondForm.Owner = main;
        Application.Run(main);
    } <span class="code-comment">//</span><span class="code-comment">void Main</span>
} <span class="code-comment">//</span><span class="code-comment">class EntryPoint</span></pre>

<p>Again, we made a "calling form" the main form of the application, but we could do the opposite. It just does not matter.</p>

<p>Actually, the whole application code is fully shown in this article section, except the static class <code>DefinitionSet</code>, which is simply a set of definitions of three strings used in the UI (texts on the button and both forms).</p>

<p><a name="a5"></a></p>

<h2>5 Sample Solution for WPF</h2>

<p>The solution for WPF is only slightly different from that of Forms. Due to better flexibility of the WPF <i>content model</i>, <code>ListBox</code> can be used as a container for multi-line strings, showing boundaries between them by encapsulating each one in a separate instance of <code>TextBlock</code> each placed inside separate <code>Border</code> of appropriate style and <code>Margins</code>, used to separate those strings. This is the implementation of <code>ICollaboration</code>:</p>

<div class="pre-lang" id="premain477619"><div>C#</div><div class="pre-action-link"><span id="copycode477619" class="copy-code" data-index="477619" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre477619" style="margin-top:0;" class="lang-csharp notranslate" data-language="cs" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-keyword">partial</span> <span class="code-keyword">class</span> ShowWindow : ICollaboration {
    ListBox listBox = <span class="code-keyword">new</span> ListBox();
    <span class="code-keyword">void</span> ICollaboration.Add(<span class="code-keyword">string</span> text) {
        Border border = <span class="code-keyword">new</span> Border();
        border.BorderThickness = <span class="code-keyword">new</span> Thickness(<span class="code-digit">1</span>);
        border.BorderBrush = System.Windows.Media.Brushes.Black;
        border.Padding = <span class="code-keyword">new</span> Thickness(<span class="code-digit">4</span>);
        border.Margin = <span class="code-keyword">new</span> Thickness(<span class="code-digit">1</span>);
        TextBlock textBlock = <span class="code-keyword">new</span> TextBlock();
        textBlock.Text = text;
        border.Child = textBlock;
        <span class="code-keyword">this</span>.listBox.Items.Add(border);
        <span class="code-keyword">this</span>.listBox.ScrollIntoView(border);
        <span class="code-keyword">this</span>.listBox.SelectedIndex = <span class="code-keyword">this</span>.listBox.Items.Count - <span class="code-digit">1</span>;
    } <span class="code-comment">//</span><span class="code-comment">ICollaboration.Add</span>
} <span class="code-comment">//</span><span class="code-comment">class ShowWindow</span></pre>

<p>The implementation of the "calling window", which is the main window in the application example (again, it does not matter), is also very similar:</p>

<div class="pre-lang" id="premain204155"><div>C#</div><div class="pre-action-link"><span class="code-collapse" data-index="204155" id="preShrink204155">Shrink ▲</span> &nbsp; <span id="copycode204155" class="copy-code" data-index="204155" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre204155" style="margin-top:0;" class="lang-csharp notranslate" data-language="cs" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-keyword">class</span> MainWindow : Window {
    <span class="code-keyword">internal</span> MainWindow() {
        Title = DefinitionSet.mainWindow;
        <span class="code-keyword">this</span>.Padding = <span class="code-keyword">new</span> Thickness(<span class="code-digit">4</span>);
        DockPanel panel = <span class="code-keyword">new</span> DockPanel();
        panel.LastChildFill = <span class="code-keyword">true</span>;
        Label label = <span class="code-keyword">new</span> Label();
        label.Content = DefinitionSet.label;
        TextBox textBox = <span class="code-keyword">new</span> TextBox();
        textBox.AcceptsReturn = <span class="code-keyword">true</span>;
        label.Target = textBox;
        Button button = <span class="code-keyword">new</span> Button();
        button.Margin = <span class="code-keyword">new</span> Thickness(<span class="code-digit">4</span>);
        button.Content = DefinitionSet.button;
        panel.Children.Add(label);
        panel.Children.Add(button);
        panel.Children.Add(textBox);
        DockPanel.SetDock(label, Dock.Top);
        DockPanel.SetDock(button, Dock.Bottom);
        <span class="code-keyword">this</span>.Content = panel;
        button.Click += (sender, eventArgs) =&gt; {
            <span class="code-keyword">if</span> (CollaborationWindow != <span class="code-keyword">null</span>)
                CollaborationWindow.Add(textBox.Text);
        }; <span class="code-comment">//</span><span class="code-comment">button.Click</span>
        textBox.TextChanged += (sender, eventArgs) =&gt; {
            button.IsEnabled = !string.IsNullOrEmpty(textBox.Text);
        }; <span class="code-comment">//</span><span class="code-comment">textBox.TextChanged</span>
        button.IsEnabled = <span class="code-keyword">false</span>;
    } <span class="code-comment">//</span><span class="code-comment">MainWindow</span>
    <span class="code-keyword">internal</span> ICollaboration CollaborationWindow { <span class="code-keyword">get</span>; <span class="code-keyword">set</span>; }
} <span class="code-comment">//</span><span class="code-comment">class MainWindow</span></pre>

<p>And the entry point is implemented as the method of the class derived from <code>Application</code>:</p>

<div class="pre-lang" id="premain357707"><div>C#</div><div class="pre-action-link"><span id="copycode357707" class="copy-code" data-index="357707" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre357707" style="margin-top:0;" class="lang-csharp notranslate" data-language="cs" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-keyword">class</span> EntryPoint : Application {
    <span class="code-keyword">protected</span> <span class="code-keyword">override</span> <span class="code-keyword">void</span> OnStartup(StartupEventArgs e) {
        <span class="code-keyword">this</span>.ShutdownMode = ShutdownMode.OnMainWindowClose;
        MainWindow mainWindow = <span class="code-keyword">new</span> MainWindow();
        <span class="code-keyword">this</span>.MainWindow = mainWindow;
        ShowWindow anotherWindow = <span class="code-keyword">new</span> ShowWindow();
        mainWindow.CollaborationWindow = anotherWindow;
        anotherWindow.Show();
        mainWindow.Show();
        anotherWindow.Owner = mainWindow;
    } <span class="code-comment">//</span><span class="code-comment">OnStartup</span>
    [STAThread]
    <span class="code-keyword">static</span> <span class="code-keyword">void</span> Main() {
        <span class="code-keyword">new</span> EntryPoint().Run();
    } <span class="code-comment">//</span><span class="code-comment">Main</span>
} <span class="code-comment">//</span><span class="code-comment">class EntryPoint</span></pre>

<p>Again, the XAML-based code is also available; to see it, please download the code sample file.</p>

<p><a name="a6"></a></p>

<h2>6 Some Notes on Other Solutions</h2>

<p>Even though articles and answers published on CodeProject really provide some solutions, I don't think they deserve separate considerations. I never saw the interface approach, and other approaches are classified in some ad-hoc manner, mixing up method of passing a reference, types of members, passing data, such as "property approach", "object approach", "constructor approach", "delegates approach", "main form", "child to parent", "parent to child", ignoring the fact that the cases overlap (which makes the set of cases to be non-classes), which only conceals the essence of things.</p>

<p>The really key point of form collaboration is the proper abstraction between forms, so passing direct access to some controls is a bad idea in all cases. Actually, event handling and the use of delegate instances between form also provides proper level of abstraction, only this is related to some more "advanced" requirements, when inversion of control is involved. See also: <a href="http://en.wikipedia.org/wiki/Inversion_of_control">http://en.wikipedia.org/wiki/Inversion_of_control</a>.</p>

<p>I only want to stop at one illusionary aspect of this "problem", parent-child relationship for forms. Not only it is absolutely irrelevant, as I <a href="https://www.codeproject.com/Tips/889332/Many-Questions-Answered-at-Once-Collaboration-betw#irrelevant"><u>mentioned above</u></a>, but also plain wrong. Normally, none of the forms is the parent or child of another form. Even though the form is <code>System.Windows.Forms.Control</code>, which has the <code>Parent</code> property, trying to set this property for a form instance throws an exception. It can be worked around by setting <code>System.Windows.Forms.Forms.TopLevel</code> to false, but it makes very little sense. This way, the child-parent relationships between forms is effectively made defunct. Forms participate in important owner-owned relationship which I used in our examples, but it is also totally irrelevant to the subject.</p>

<p>Please see:<br>
<a href="https://msdn.microsoft.com/en-us/library/system.windows.forms.control.parent(v=vs.110).aspx">https://msdn.microsoft.com/en-us/library/system.windows.forms.control.parent(v=vs.110).aspx</a>,<br>
<a href="https://msdn.microsoft.com/en-us/library/system.windows.forms.form.toplevel(v=vs.110).aspx">https://msdn.microsoft.com/en-us/library/system.windows.forms.form.toplevel(v=vs.110).aspx</a>,<br>
<a href="https://msdn.microsoft.com/en-us/library/system.windows.forms.form.owner(v=vs.110).aspx">https://msdn.microsoft.com/en-us/library/system.windows.forms.form.owner(v=vs.110).aspx</a>,<br>
<a href="https://msdn.microsoft.com/en-us/library/system.windows.forms.form.ownedforms(v=vs.110).aspx">https://msdn.microsoft.com/en-us/library/system.windows.forms.form.ownedforms(v=vs.110).aspx</a>.</p>

<p>With WPF, the situation is a bit different: there are two hierarchies, <i>logical</i> and <i>visual trees</i>: <a href="https://msdn.microsoft.com/en-us/library/ms753391%28v=vs.110%29.aspx">https://msdn.microsoft.com/en-us/library/ms753391%28v=vs.110%29.aspx</a>.</p>

<p>In WPF terminology, the <a href="https://msdn.microsoft.com/en-us/library/system.windows.window.owner(v=vs.110).aspx">owner window</a> is sometimes called "parent" (in exception message, for example), but this is also remain totally irrelevant to the subject. <a name="a7"></a></p>

<h2>7 Is the Collaboration Good or Evil?</h2>

<p>The question may look strange, because such collaboration can be a part of some requirements. But why? I would say that such collaboration is often (but perhaps not always) the sign of bad UI design.</p>

<p>The whole idea to have several forms looks questionable in many cases. (I don't count some modal dialogs here.) In most cases, the design based on only one form or window looks better. The forms/windows are initially designed to be more or less independent. Their parent (in the sense of Windows API, not .NET) is always the desktop, designed to hold relatively independent items which are arranged directly by the users, individually. If the application is represented by one form/window, the role of the "child" forms/windows could be played by other controls, such as panels, tab pages of the <code>TabControl</code>, and a lot more.</p>

<p>Of course, there can be a number of exclusions. One such exclusion is having the application which plays some independent roles only united by the common topic. For example, I prefer using my own mail client which consists of the sender and receiver parts. (And, by the way, I paid special effort to simulate "equal" behavior of both forms, so they both look "main" to the user.)</p>

<p>So, multiple non-modal forms/windows can sometimes be useful, so the ability to organize collaboration between them can be important.</p>

<p><a name="a8"></a></p>

<h2>8 Conclusions</h2>

<p>Forms/windows collaborations based on interface provides proper encapsulation and isolation of those forms/windows. It serves as "umbrella" technique for any thinkable kind of collaborations, making the boundary between forms/windows transparent, as if the collaboration was done inside the same instance. This collaboration is quite trivial.</p>

<!-- Article Ends -->


						</div>
						

						
						<h2>License</h2>
						<div id="LicenseTerms"><p>This article, along with any associated source code and files, is licensed under <a href="http://www.codeproject.com/info/cpol10.aspx" rel="license">The Code Project Open License (CPOL)</a></p></div>
						

						
						<br>
						
						    <br>
						
						

						<div class="clearfix"></div>

						<div style="padding-top:8px">
							
						</div>

					

				    
					</form>

				</div>

				
				<div class="bottom-promo"> 
				    
				</div>
				
                
                

				
				
				

			</div>
			

            
            
            

        </div>
        

		
		<div class="site-footer">
			<div class="align-left">
				<a id="ctl00_PermaLink" href="https://www.codeproject.com/Tips/889332/Many-Questions-Answered-at-Once-Collaboration-betw">Permalink</a><br>
				<br>
				<a id="ctl00_PrivacyLink" href="https://www.codeproject.com/info/privacy.aspx">Privacy</a><br>
    			<a id="ctl00_CookiePolicyLink" href="https://www.codeproject.com/info/cookie.aspx">Cookies</a><br>
                <a id="ctl00_TermsOfUseLink" href="https://www.codeproject.com/info/TermsOfUse.aspx">Terms of Use</a><br>
			</div>

            <div class="align-center">
				


<div class="page-width">
    Layout: <a id="ctl00_PageWidth_FixedT" title="Fixed width layout" rel="nofollow" class=" active" href="https://www.codeproject.com/Tips/889332/Many-Questions-Answered-at-Once-Collaboration-betw?PageFlow=FixedWidth">fixed</a>
    |
    <a id="ctl00_PageWidth_FluidT" title="Fluid layout" rel="nofollow" href="https://www.codeproject.com/Tips/889332/Many-Questions-Answered-at-Once-Collaboration-betw?PageFlow=Fluid">fluid</a>
</div>


				

				

	            

                <br>
			</div>
                
			<div class="align-right">
				Article Copyright 2015 by Sergey Alexandrovich Kryukov<br>Everything else
				Copyright © <a href="mailto:webmaster@codeproject.com">CodeProject</a>, 1999-2024<br>
                <br>
				Web01 
				2.8:2024-12-08:1<br>
			</div>
		</div>
		

		<br clear="all">
		
			

	</div> 
	</div> 
</div>







<script type="text/javascript"> // DEFERRED script

document.addEventListener('DOMContentLoaded', function() {

	new CodeBlocks().initialise('#contentdiv');
	
	$('.author-wrapper .description').shorten({showChars: 400});
	
	anchorAnimate();
	
	$('#__EVENTVALIDATION').attr('autocomplete', 'off');

})
</script>










<style type="text/css">.copied::after {  position: absolute;  right: 0;  display: inline-block; white-space: nowrap; content: 'copied'; color: #fff; background-color: #f90;  border-radius: 3px; padding:1px 8px; opacity: 0;  will-change: opacity, transform; animation: showcopied 1.5s ease; } @keyframes showcopied { 0% { opacity: 0; } 70% { opacity: 1; } 100% { opacity: 0; } } </style><canvas id="cv1" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas><canvas id="cv2" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas></body><grammarly-desktop-integration data-grammarly-shadow-root="true"><template shadowrootmode="open"><style>
      div.grammarly-desktop-integration {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
        -moz-user-select: none;
        -webkit-user-select: none;
        -ms-user-select:none;
        user-select:none;
      }

      div.grammarly-desktop-integration:before {
        content: attr(data-content);
      }
    </style><div aria-label="grammarly-integration" role="group" tabindex="-1" class="grammarly-desktop-integration" data-content="{&quot;mode&quot;:&quot;full&quot;,&quot;isActive&quot;:true,&quot;isUserDisabled&quot;:false}"></div></template></grammarly-desktop-integration></html>