<!DOCTYPE html>
<!-- saved from url=(0052)https://www.codeproject.com/Articles/1181872/WPF-Arc -->
<html lang="en" data-lt-installed="true"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

	
	<link rel="preconnect" href="https://www.google-analytics.com/">

	<link rel="preconnect" href="https://www.codeproject.com/">


	<link rel="preload" href="./Resources/logo250x135.gif" as="image">


	<link rel="preload" href="https://www.codeproject.com/App_Themes/CodeProject/Img/logo135-bg.gif" as="image">
	<link rel="preload" href="./Resources/jquery-3.4.1.min.js.download" as="script" type="text/javascript">


	<title>WPF Arc!- CodeProject</title> 
    
	<link type="text/css" rel="stylesheet" href="./Resources/Article.min.css">


    <script type="text/javascript" async="" src="./Resources/analytics.js.download"></script><script type="text/javascript" src="./Resources/jquery-3.4.1.min.js.download" defer=""></script>
<script type="text/javascript" src="./Resources/article.min.js.download" defer=""></script>

	
<meta http-equiv="content-language" content="en-US">

<meta name="Description" content="Filling one of the ugliest WPF gaps: Animatable EllipticalArcGeometry and EllipticalArcShape">
<meta name="Keywords" content="VS2008, C#, WPF">
<meta name="Author" content="Sergey Alexandrovich Kryukov">
<meta name="Rating" content="General">
<meta name="Revisit-After" content="1 days">
<meta name="application-name" content="CodeProject">
<meta name="google-translate-customization" content="d908bb7ce7aff658-4c2f3a504525c916-g629383f736781a8a-13">



<link rel="dns-prefetch" href="https://ajax.googleapis.com/"> 
<link rel="canonical" href="https://www.codeproject.com/Articles/1181872/WPF-Arc">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@CodeProject">
<meta name="og:site_name" content="CodeProject">
<meta name="twitter:creator" content="@CodeProject">
<meta property="og:type" content="article">
<meta property="article:published_time" content="4/12/2017 10:20:00 PM">
<meta property="article:modified_time" content="4/14/2017 3:52:00 PM">
<meta name="twitter:label1" content="Written by">
<meta name="twitter:data1" content="Sergey Alexandrovich Kryukov">
<meta name="twitter:label2" content="Reading time">
<meta name="twitter:data2" content="9 min read">
<meta property="og:url" content="https://www.codeproject.com/Articles/1181872/WPF-Arc">
<meta property="og:title" content="WPF Arc!">
<meta property="og:description" content="Filling one of the ugliest WPF gaps: Animatable EllipticalArcGeometry and EllipticalArcShape">


<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="apple-touch-icon" sizes="144x144" href="https://www.codeproject.com/favicon/apple-touch-icon.png"> 
<link rel="icon" type="image/png" sizes="32x32" href="https://www.codeproject.com/favicon/favicon-32x32.png"> 
<link rel="icon" type="image/png" sizes="16x16" href="https://www.codeproject.com/favicon/favicon-16x16.png"> 
<link rel="manifest" href="https://www.codeproject.com/favicon/manifest.json"> 
<link rel="mask-icon" href="https://www.codeproject.com/favicon/safari-pinned-tab.svg" color="#ff9900">
	<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "TechArticle",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.codeproject.com/Articles/1181872/WPF-Arc"
   },
  "name": "WPF Arc!",
  "headline": "WPF Arc!",
  "url": "https://www.codeproject.com/Articles/1181872/WPF-Arc",
  "discussionUrl": "#_comments",
  "isFamilyFriendly": "true",
  "image": "https://www.codeproject.com/App_Themes/CodeProject/Img/Article100.png",
  "keywords": "VS2008,C#,WPF",
  "commentCount": "0",
  "editor" : {
    "@type" : "Person",
    "name" : "Editor",
    "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=2291164"
  },
  "license": "http://www.codeproject.com/info/cpol10.aspx",
  "publisher" : {
    "@type" : "Organization",
    "name" : "CodeProject"
  },
  "description": "Filling one of the ugliest WPF gaps: Animatable EllipticalArcGeometry and EllipticalArcShape",
  "articleSection": "WPF",
  "author" : [{
      "@type" : "Person",
      "name" : "Sergey Alexandrovich Kryukov",
      "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=2291164"
    }],
  "datePublished": "2017-04-12",
  "dateCreated": "2017-04-12",
  "dateModified": "2017-04-14"
,
  "contentRating" : {
    "@type" : "Rating",
    "ratingValue" : 5.00,
    "bestRating" : 5,
    "worstRating" : 1
  }
}</script>

<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
    "@type": "ListItem",
    "position": 1,
    "item" : {
      "@id" : "/script/Content/Tag.aspx?tags=desktop",
      "name" : "desktop"
    }
  },{
    "@type": "ListItem",
    "position": 2,
    "item" : {
      "@id" : "/script/Content/Tag.aspx?tags=WPF",
      "name" : "WPF"
    }
  }]
}</script>

<script type="text/javascript">
function defrm () { /* thanks twitter */
    document.write = '';
    window.top.location = window.self.location;
    setTimeout(function() { document.body.innerHTML = ''; }, 0);
    window.self.onload = function(evt) { document.body.innerHTML = ''; };
}

if (window.top !== window.self) {
    try {
        if (window.top.location.host) { /* will throw for all except chrome */ }
        else { defrm(); /* chrome */ }
    } catch (ex) { defrm(); /* everyone else */ }
}

// Specific case where a site is screwing with us.
if (typeof(DemoUrl) !== 'undefined') {
    document.write(unescape('%3Cme') + 'ta http' + '-equiv="re' + 'fresh con' +
                           'tent="1;url=' + DemoUrl + unescape('"%3CE'));
}
</script>
	





    <script async="" type="text/javascript" src="./Resources/js"></script>
    <script type="text/javascript">
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-1735123-1' , {'user_id': '42a7d533-9829-4f88-8fc6-84dc936250c9'});
    </script>

<style type="text/css"></style></head>	

<body class="chrome chrome120" data-new-gr-c-s-check-loaded="14.1215.0" data-gr-ext-installed="">



<a class="access-link" href="#Main"><img alt="Click here to Skip to main content" src="./Resources/t.gif"></a>




<div class="page-background">

	
	

	

	
    <div id="ctl00_STM" class="site-top-menu fixed narrow">
        <div class="main-content">
            

<div class="container memberbar clearfix flex-container flex-extend">

	<div id="ctl00_MemberBar_GenInfo" class="flex-item align-left">65,938 articles</div>
	
	<div id="ctl00_MemberBar_ChangeNotice" class="flex-item align-left">CodeProject
	is changing. <a href="https://www.codeproject.com/info/Changes.aspx">Read more</a>.</div>

	<div class="flex-item">
		
	</div>

	<div class="flex-item align-right">

		

		

		
	</div>
</div>
        </div>
    </div>

	
    <div id="ctl00_SH" class="site-header fixed narrow">
        <div class="main-content">
            <div class="logo"><a href="https://www.codeproject.com/"><img id="ctl00_Logo" tabindex="1" title="CodeProject" src="./Resources/logo250x135.gif" alt="Home" style="height:135px;width:250px;border-width:0px;"></a></div>
            <div class="promo"></div>
        </div>
    </div>

	
			
	

	<div id="A" class="container-content-wrap fixed narrow"> 

	<div class="container-content">

        
		<div class="clearfix">
			<div class="container-breadcrumb float-left ">
				<div><a rel="nofollow" href="https://www.codeproject.com/script/Content/SiteMap.aspx">Articles</a> / <a rel="nofollow" href="https://www.codeproject.com/script/Content/Tag.aspx?tags=desktop">desktop</a> / <a rel="nofollow" href="https://www.codeproject.com/script/Content/Tag.aspx?tags=WPF">WPF</a></div>
			</div>

            <div class="float-left">
				
			</div>

			<div class="edit-links float-right">
				



 
&nbsp;










			</div>

			<div class="article-nav float-right">
				


<div style="display:inline-block;position:relative;top:-6px;margin-right:20px">
    
</div>



 

<a id="ctl00_ActionLinks_PrintMd" data-tooltip="Print" data-enabletooltip="true" data-width="auto" href="https://www.codeproject.com/Articles/1181872/WPF-Arc?display=Print" class="tooltip" title="">
   <img src="./Resources/print48.png" width="24" height="24" style="border:0">
<div class="speech-bubble-container-up" style="width:auto">  <div class="speech-bubble-up" style="text-align:center"> Print</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>



<span id="ctl00_ActionLinks_R">
    
    
</span>
			</div>
		</div>

        
		<div class="extended article-container-parts">

			
		    
            

			
			<div id="AT" class="article-container  fixed narrow" style="max-width:inherit;"> 

				<div class="article">

					<form name="aspnetForm" method="post" action="https://www.codeproject.com/Articles/1181872/View.aspx" id="aspnetForm" style="margin:0;padding:0">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="tyn3CT9h1sZ4WlKU/8FDpXflS3bGIc6AkKnPApmjj1D97HPr17Sj5rxjmx7oqnwH6TFsNDXRBvDBp3aQ2NcyGjhMB8FgcOVOHS4xkXrZYVbvaGq9n0fSQdxscCVqsRWlwOzH9Qqy5DnwCkZrJLXOr9svj5eKOp3+OJinbGhzlXwkt5w/dAnn0rmcgUBYDyIWd0f3Upy206eYccyWFrAHv1gS3QfBuTqLol0s52jRubVFmY314tAmOCqn3ByXnV5gdJY72cmAn6R/NN8tBi5ub7rpzCP6/aOpIb0r2g2HqdFxSJyzjJ63luX+SbXWpzGO70Ns+BlI5JqMeeh6c1iyl/Cy1chAiEpBbZeF/MoR+zbMrVRtiPTmP44FSzjY7Xpdm3y417NMt0ps5+1ErXj8RVjxyfCWkP+FHXiT/dfyt7AGFBkzWrb1BUQFr/s7qVGOhkWdaXa5O5BuTHse4kvMum8Qt/sFIbeoo45ONKbRsP6p6oDOa9FAtbokwPAeemY3+G9qkM96m4LRP+Quyv6OCJ5MwuYcj+cQLYec3HAPxG+ixvH4mb4E+dCJzzlKc/AkJFYMuSN4saK1jt55B02TG7V0lvMLMTrQIcOMdmGhDBymeuY3lL8mA+D/TdK0vyICmsdFpK5F89l3sGwZd/cAv0YSku/8MIktIPGkfN+5GBUsZVoljoyWbLpXGBbcYS+y1pMrL8A7h9oZW6G4Rgd86mlhYJx5ldGwIpW/9sulhhArdlnzVAZGc8ZGFXt8D0c0m3gmxeh0CIJ68+q0SDuttei90Th7kOBnCIz34tUXsUnpyqgaULhw5B0CucC/0i8v3p7WZ4lkD5aTdLpk9hJFEDHJ7uf0APt7jzugArmcKh/fRLDi0NeWrhBtCwKRZJCEmy58ooVD/zKpeoJW3PBJHzVNHWcylWANX0c06xpB3rOt/1vGL1/NxzmOZHd/rhR7Yw2a8yZQasnD8BowjjfGZ8dCV7iZPB+tD1WAkFdvxNVfQEuvU45mukyiMZ6rTE+RFgFRncinPDipdB72yA4+K244r/fbfdN2j9oW5Im0XVCG1noa3WOu3m3VmIwPSsUPB9izY6A4SwOW8tftWMwQFEboqFK4RyxEtAmrVd1dfi/gwSRMfWmCAAqCCb8xW/m3T5PXUABS+PbdqatC2qAPe2iEiiivi9cBVS5SXT3OqtdcETEIsUttBnX4Ae0AMiWJIkryg7G3fki6ULqN6m4jj1kt9iAEegSRhovfZX557Sh6Ajmhoxt75G1FL+nXy/dASlZsRjQbP+MfTaazxHGG/OZh31xE8OehFRrTjEHTnnEyqCqQZKf0jc2aXeV6NL+ajQYFKot8VISWoeIJ+9QexIrkWkw1fN9+KkSc2DmWFMu79ba4kbF+s9LdywNRGQh6XTOxV2CsLDUUq9/mjLatwDoCjzdntpPFziBqc9/HfIvoA51AanouvUWUHc6Ynd1UYqYKYNeefARPV93+5/fqlnLc9tx/BCj5rWnKy3UabfI8Dnhns6jZyUNDdgbiYfFzc8OFnF81bMqfukVfc7fuQsQsfoISX43AjW36FlQ6qnGqQFcSWPh4f8RbzTmMkjg4YxmOQ8WT4Yvnf11yINraPGjIw6bZeDknX/VDnSH+TKO1kVrPc5W3mbELbKG3Dgk00Q+ecWTnx8eaA/qEWec13TLTuWb0IzMtmhb9oU4L+E9Dkila4s3MHey6lHz3vX7wo+P/nrvpIMZO1MalB5YwKcJx/+M3k9shHtj8RYPy4VgWX0IRwk0k+PeK+m8qycetzh7Z9UOfvk8y++i5obMXjmC9IYW1nUjWhWJB5j3Gl0gKmLYWtKXitN0Wf8sv88vWpcA3n8n6yI1u6HD5V06ols74RNljqmd9TUTR/mEXhwBm/qW3glxybSjHX0bOAZyoAgvuof6dDWgpk19rqJQb89C/z9ZtuuSFj79j8PsuztU7eZPbos2s7R7YsXf3/ykF2Fvw/Q==">
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="10C1FD69">
</div>

					
					 
					<div class="header">
					    <a name="Main"></a>
					    <a name="_articleTop" id="_articleTop"></a>

					    
						<div>
							<span id="ctl00_TagListHorz_TagWrp" class="tags horizontal">

	
	

	
	<span id="ctl00_TagListHorz_VisibleTags"><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/VS2008" data-id="77">VS2008</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/Csharp" data-id="81">C#</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/WPF" data-id="140">WPF</a></div></span> 

	
	
</span>


						</div>
					    <div class="title">
					        <h1 id="ctl00_ArticleTitle">WPF Arc!</h1>
					    </div>

                        <div>
					        
					        <div class="entry flex-container">

								

                                <div class="flex-item" style="flex:1 1 auto">
                                    <div class="flex-container" style="justify-content:space-between;flex-wrap:wrap-reverse">
                                       <span id="ctl00_Authors" class="author flex-item"><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=2291164" rel="author">Sergey Alexandrovich Kryukov</a></span> 

                                        <div class="flex-item" style="margin-top:-4px;">
                                            <div id="ctl00_RateArticle_RatingTable" class="small-text" data-objectref="2_1181872">

	<meta itemprop="upvoteCount" content="14">


	<div id="ctl00_RateArticle_RatingRow" class="flex-container rating-container large-stars">

					
		

		
		<div class="nowrap tooltip">

			
			<div id="ctl00_RateArticle_ResultNoHist" class="rating-result"><div class="flex-container rating-stars large-stars"><div><img src="./Resources/star-fill-lg.png" style="width:24px;height:24px"></div><div><img src="./Resources/star-fill-lg.png" style="width:24px;height:24px"></div><div><img src="./Resources/star-fill-lg.png" style="width:24px;height:24px"></div><div><img src="./Resources/star-fill-lg.png" style="width:24px;height:24px"></div><div><img src="./Resources/star-fill-lg.png" style="width:24px;height:24px"></div></div></div>
			

			
			

			
            

			
                

		</div>
		
	
		
		<div id="ctl00_RateArticle_VoteCountNoHist" class="rating-votes nowrap">5.00/5  (14 votes)</div>	

		

		
		<div class="rating-undo" title="Undo vote" style="margin-left:5px;display:none"></div>

		
		
	</div>

	
	

</div>

                                        </div>
                                    </div>

                                    <div class="flex-container" style="color:#666;font-size:smaller">
                                        <span id="ctl00_LastUpdated" class="date flex-item-tight" title="Date last updated">12 Apr 2017, last revision: 14 Apr 2017</span><a id="ctl00_LicenseLink" title="The Code Project Open License (CPOL)" class="license flex-item-tight" href="http://www.codeproject.com/info/cpol10.aspx">CPOL</a><span id="ctl00_ReadingTime" class="stats flex-item-tight">9 min read</span><span id="ctl00_HorizontalStats" class="stats flex-item-tight"><span class="stats"><span title="Views"><img src="./Resources/views32.png" style="width:16px"> 28.9K</span> &nbsp; <span title="Downloads"><img src="./Resources/download32.png" style="width:16px"> 1K</span> &nbsp; </span></span>
                                    </div>
                                </div>
					        </div>

                            

                        </div>

                        <div id="ctl00_DescriptionSpot" class="summary">Filling one of the ugliest WPF gaps: Animatable EllipticalArcGeometry and EllipticalArcShape</div><span id="ctl00_ThumbnailUrl" class="date" content="https://www.codeproject.com/script/Articles/Images/article100x80.png"></span>			

                    </div>
                    
					
					

					

					
					

					
					

						
					

					

						
						<div id="contentdiv" class="text">
						



<!-- Article Starts -->

<ul class="download">
	<li><a href="WPF-Arc!.zip">Download source code — 25.5 KB</a></li></ul>

<p id="top-image"><img src="./Resources-articles/2017-04-12.WPF-Arc!.title.webp" alt="2017-04-12.WPF-Arc!.title.webp"/></p>

<blockquote class="FQ" id="epigraph">
<div class="FQA">Epigraph:</div>

<p><i>Without stones there is no <a href="https://en.wikipedia.org/wiki/Arch">arch</a></i></p>

<dl>
	<dd><a href="https://en.wikipedia.org/wiki/Marco_Polo">Marco Polo</a></dd></dl>
</blockquote>

<h2>Contents</h2>

<div id="TOC">
<ul style="list-style-type: none; list-style-image: initial">
	<li><a href="#is-it-really-a-problem">Is it Really a Problem?</a></li>	<li><a href="#the-solution">The Solution</a></li>	<li><a href="#if-it-looks-like-geometry-swims-like-geometry">If it Looks Like Geometry, Swims Like Geometry…</a></li>	<li><a href="#how-can-it-be-animatable">How can it be Animatable?</a></li>	<li><a href="#why-not-combinedgeometry">Why not CombinedGeometry?</a></li>	<li><a href="#compatibility-and-build">Compatibility and Build</a></li>	<li><a href="#conclusions">Conclusions</a></li></ul>
</div>

<h2 id="is-it-really-a-problem">Is it Really a Problem?</h2>

<p>First of all, the mere fact that there is no such <code>Geometry</code> type looks quite weird. Sectors and segments always were must-haves in all kinds of vector graphics. And, as we can see, adding such types is simply an unsolvable problem.</p>

<p>But let’s consider something simpler first: is it possible to create an arc sector or segment primitive and place it on the form? Yes, of course, but how? It turned out surprisingly difficult. Of course, I could have taken it for my own dullness, if… I could find a solution working for all cases. Many answered the question on how to draw an arc from some starting to some ending angle, but… I wonder, was it so difficult to test such “solution” to have both angles in each quadrant and quadrant boundaries in <a href="#top-image">all possible combinations</a>? The problem looks quite simple but no, I did not find anything completely working.</p>

<p>The only thing dealing with a part of an ellipse/circle is <code>System.Windows.Media.ArcSegment</code>; and its API looks <a href="https://www.codeproject.com/Articles/1181872/System.Windows.Media.ArcSegment">quite confusing</a>, to say the least. Well, it’s always possible to find out how it works, but it’s more important that this <code>PathSegment</code> type cannot show 360° ellipse anyway. It could be combined with <code>EllipseGeomentry</code>, but… <a href="#why-not-combinedgeometry">not so fast</a>.</p>

<p>Much more fundamental problem is the lack of the possibility to create custom <code>Geometry</code>. According to official Microsoft documentation on <code>System.Windows.Media.Geometry</code>, <a href="https://msdn.microsoft.com/en-us/library/system.windows.media.pathsegment%28v=vs.110%29.aspx">“Although this class is abstract, it is not publicly extensible”</a>. All classes derived from <code>Geometry</code> are sealed, so we still cannot create a derived class indirectly. It makes certain things impossible. For example, there is no a way to place arc-related geometry in XAML where the <code>Geometry</code> type is expected, which is important for the <a href="https://msdn.microsoft.com/en-us/library/system.windows.uielement.clip%28v=vs.110%29.aspx">UIElement.Clip</a> and some other applications. End of story.</p>

<p>After all, I implemented those functionally equivalent features using <code>Geometry</code>, like clipping and animation, but not in the same way the class <code>Geometry</code> was designed for; and it partly defeats the purpose of this fundamentally important class, unfortunately.</p>

<p>It would be possible to make something functionally equivalent, for example, with custom <code>System.Windows.Media.PathSegment</code>, but the same story goes here: <a href="https://msdn.microsoft.com/en-us/library/system.windows.media.pathsegment%28v=vs.110%29.aspx">this class is also not publicly extensible</a>.</p>

<p>I feels like Microsoft is doing pretty good job intended to block development in this direction. Wow!</p>

<h2 id="the-solution">The Solution</h2>

<p>First idea it to create a class <code>EllipticalArcGeometry</code> <a href="https://en.wikipedia.org/wiki/Factory_method_pattern">factory method</a>, instead of real <code>Geometry</code>. The use of <em>implicit type cast operator</em> can make the use of it quite easy; the instance of the type can be use in most cases where <code>Geometry</code> instance can be used:</p>

<div id="elliptical-arc-geometry-factory">
<div class="pre-lang" id="premain985058"><div>C#</div><div class="pre-action-link"><span id="copycode985058" class="copy-code" data-index="985058" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre985058" style="margin-top:0;" class="lang-csharp notranslate" data-language="c#" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-keyword">public</span> <span class="code-keyword">partial</span> <span class="code-keyword">class</span> EllipticalArcGeometry {
    <span class="code-keyword">public</span> <span class="code-keyword">static</span> <span class="code-keyword">implicit</span> <span class="code-keyword">operator</span> Geometry(EllipticalArcGeometry instance) {
        <span class="code-keyword">return</span> instance.geometry;
    } <span class="code-comment">//</span><span class="code-comment">Geometry</span>
    <span class="code-comment">//</span><span class="code-comment"> ...</span>
}</pre>

<p>On top of that, it needs a set of <a href="https://msdn.microsoft.com/en-us/library/ms752914%28v=vs.110%29.aspx">dependency properties</a>, to interact smoothly with other WPF components. First of all, this is <code>AngularSize</code>, starting <code>Angle</code> of a sector/segment/arc, followed by the properties fully analogous of those <code>EllipseGeomentry</code> properties, plus specific rendering options. This is a usual boring work. Oh, and yes, the direction of measuring the angle is chosen according to “mathematical” convention: counterclockwise. If someone needs the Microsoft’s way, it’s easy to add <code>360°−Angle</code> expression or choose proper <code>Transform</code> and <a href="https://msdn.microsoft.com/en-us/library/system.windows.media.transform%28v=vs.110%29.aspx">apply it</a> to <a href="https://msdn.microsoft.com/en-us/library/system.windows.media.geometry.transform%28v=vs.110%29.aspx">Geometry.Transform property</a>.</p>

<p>To render sector and segment geometries for all cases, it’s enough to implement three distinct cases of the path. Each case can be built as a separate <code>PathFigure</code> instance, so we needs only one child at a time in the property <code>PathGeometry.Figures</code>. As property values change, we can quickly replace the instance of the <code>PathFigure</code>. Here are those three cases. Each case needs one or two segment in each <code>PathFigure</code> instance:</p>

<p id="img-segments"><img src="./Resources-articles/2017-04-12.WPF-Arc!.segments.webp" alt="2017-04-12.WPF-Arc!.segments.webp"/></p>
<!--<p id="img-segments"><img src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="Image 2" data-src="/KB/dotnet/1181872/segments.png" class="lazyload" style="max-width: 700px; height: auto"></p>-->

<p>The segment indices are shown by the numbers 0 or 1. The straight line segment shown in green does not have to be a separate <code>LineSegment</code>; instead, stroking of this line is controlled by the property <code>PathFigure.IsClosed</code> — the contour simply gets back to the starting point of the path. The stroking of the arc segments and the straight line segment #1 used for the sector case is controlled by the property <code>PathSegment.IsStroked</code>.</p>

<p>Two cases on left represent sector and segment geometries, and the case on right is the common for them and is used only for the special case of the full 360° ellipse.</p>

<p>This way, the code of the <code>EllipticalArcGeometry</code> looks like this:</p>

<div id="set-segments">
<div class="pre-lang" id="premain131504"><div>C#</div><div class="pre-action-link"><span class="code-collapse" data-index="131504" id="preShrink131504">Shrink ▲</span> &nbsp; <span id="copycode131504" class="copy-code" data-index="131504" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre131504" style="margin-top:0;" class="lang-csharp notranslate" data-language="c#" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-keyword">void</span> setSegments() {
    <span class="code-keyword">if</span> (Variant != EllipticalArcGeometryVariant.Sector)
        geometry.Figures[0] = segmentFigure;
    <span class="code-keyword">else</span>
        geometry.Figures[0] = sectorFigure;
    <span class="code-keyword">double</span> angleTo = AngularSize;
    <span class="code-keyword">bool</span> fullEllipse = AngularSize &gt;= Arcs.DefinitionSet.MaxAngle;
    <span class="code-keyword">if</span> (fullEllipse)
        angleTo = Arcs.DefinitionSet.MaxAngle / <span class="code-digit">2</span>;
    Point first = <span class="code-keyword">new</span> Point(Center.X + RadiusX, Center.Y);
    Point second = <span class="code-keyword">new</span> Point(Center.X + RadiusX * cos(angleTo), Center.Y - RadiusX * sin(angleTo));
    sectorFigure.StartPoint = Center;
    line.Point = first;
    arcSegment.Point = second;
    arcSegment.IsLargeArc = AngularSize &gt; Arcs.DefinitionSet.MaxAngle / <span class="code-digit">2</span>;
    <span class="code-keyword">if</span> (Variant != EllipticalArcGeometryVariant.Sector)
        segmentFigure.StartPoint = first;
    <span class="code-keyword">if</span> (fullEllipse) {
        ellipseFigure.StartPoint = first;
        augmentingArcSegment.Size = arcSegment.Size;
        augmentingArcSegment.Point = first;
        geometry.Figures[0] = ellipseFigure;
    } <span class="code-comment">//</span><span class="code-comment">if</span>
} <span class="code-comment">//</span><span class="code-comment">setSegments</span></pre>

<p>This entire exercise is done on a round shape and for the <code>Angle</code> value of 0. Other angles and different ellipse aspect ratio are obtained by two <code>Transform</code> operations: rotation followed by scale.</p>

<p>Having all that, the class <code>EllipticalArcShape</code> is quite trivially implemented based on <code>EllipticalArcGeometry</code>, without any need to deal with paths again. Please see the source code.</p>

<h2 id="if-it-looks-like-geometry-swims-like-geometry">If it Looks Like Geometry, Swims Like Geometry…</h2>

<p>…no, it is <a href="https://en.wikipedia.org/wiki/Duck_test">not a duck</a>, and it <a href="https://en.wikipedia.org/wiki/Abductive_reasoning">does not even have to be</a> <code>Geometry</code>. <code>EllipticalArcGeometry</code> just can be used where <code>Geometry</code> can be used; well, <em>almost</em> everywhere; this is the whole point of having this class.</p>

<p>For example, as with real <code>Geometry</code> types, it can be used to create a non-rectangular control, including <code>Window</code>. The <a href="#top-image">picture at the top</a> shows a <code>ToolTip</code> “Double click to see Non-Rectangular Window Demo”. Indeed, let’s click on it and see how it looks <em>on the background of its own source code</em>:</p>

<p id="img-non-rect"><img src="./Resources-articles/2017-04-12.WPF-Arc!.nonrect.webp" alt="2017-04-12.WPF-Arc!.nonrect.webp"/></p>
<!--<p id="img-non-rect"><img src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="Image 3" data-src="/KB/dotnet/1181872/nonrect.png" class="lazyload" style="max-width: 700px; height: auto"></p>-->

<p>Sorry for somewhat predatory look of this picture. <big>😃</big></p>

<p>Note that this is not just transparency; it is a real window shape seen on the <code>UIElement</code> <em>behavior</em>. If you click it the area of the transparent elliptical-arc area in the bottom-right corner of the window, it will be deactivated to activate the window of some other application, such as Visual Studio. It you click in the opaque blue area, you can drag the window, close it, and so on.</p>

<p>Apparently, same thing can be done with any <code>UIElement</code>, as it is achieved by assigning some <code>Geometry</code> instance to the property <a href="https://msdn.microsoft.com/en-us/library/system.windows.uielement.clip%28v=vs.110%29.aspx">System.Windows.UIElement.Clip</a>.</p>

<p>Likewise, the <code>Geometry</code> instance coming from the <code>EllipticalArcGeometry</code> factory, can be used in other techniques, for example, in <a href="https://msdn.microsoft.com/en-us/library/ms748373%28v=vs.110%29.aspx">WPF Graphics Rendering</a> through <a href="https://msdn.microsoft.com/en-us/library/system.windows.media.geometrydrawing%28v=vs.110%29.aspx">GeometryDrawing</a> or rendered via <a href="https://msdn.microsoft.com/en-us/library/system.windows.media.drawingcontext%28v=vs.110%29.aspx">DrawingContext</a> by using the method <a href="https://msdn.microsoft.com/en-us/library/system.windows.media.drawingcontext.drawgeometry%28v=vs.110%29.aspx">DrawingContext.DrawGeometry</a>.</p>

<p>Those who really ran the demo <a href="#img-non-rect">showing the non-rectangular window</a> could see that the window is also animated; and the subject of this animation is the same very window clip: not only the window shape is not rectangular, but this shape is also changing with time. Is it a problem or not? It would not be a problem if <code>EllipticalArcGeometry</code> was actually a <code>Geometry</code> class, of if standard WPF animation was not used.</p>

<h2 id="how-can-it-be-animatable">How can it be Animatable?</h2>

<p>Coming back to the design of <code>EllipticalArcGeometry</code>, which works through a <a href="https://en.wikipedia.org/wiki/Factory_method_pattern">factory method</a> providing access to some <code>Geometry</code> instance, but is not itself a <code>Geometry</code>. Would it be enough in all cases? Apparently not. There is always a way to see that some class is not derived from some other class, such as <code>Geometry</code>. For example, the method <code>BeginAnimation</code> accepts some <a href="https://msdn.microsoft.com/en-us/library/ms752914%28v=vs.110%29.aspx">dependency property</a> as a first parameter, but properties of <code>EllipticalArcGeometry</code> are not the properties of its <code>Geometry</code>, so animation would not work. How to resolve this problem?</p>

<p>The <a href="#top-image">main demo</a> shows the animation on the class <code>EllipticalArcShape</code>, which is not a problem at all, because it derives from <code>Shape</code>, already <code>Animatable</code>. But we cannot do the same with <code>Geometry</code>. Pretty obviously, the problem can be solved if we derive from the <code>Geometry</code> base class, which is <a href="https://msdn.microsoft.com/en-us/library/system.windows.media.animation.animatable%28v=vs.110%29.aspx">Animatable</a>. Fortunately, in contrast to <code>Geometry</code> or <code>PathSegment</code>, this class is publicly extensible; and only one method is required to be overridden in a derived class. So, the solution is quite simple:</p>

<div id="create-instance-core">
<div class="pre-lang" id="premain400390"><div>C#</div><div class="pre-action-link"><span id="copycode400390" class="copy-code" data-index="400390" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre400390" style="margin-top:0;" class="lang-csharp notranslate" data-language="c#" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-keyword">public</span> <span class="code-keyword">partial</span> <span class="code-keyword">class</span> EllipticalArcGeometry : Animation.Animatable {
    <span class="code-comment">//</span><span class="code-comment"> ...</span>
    <span class="code-keyword">protected</span> <span class="code-keyword">override</span> Freezable CreateInstanceCore() {
        <span class="code-keyword">return</span> <span class="code-keyword">this</span>;
    }
    <span class="code-comment">//</span><span class="code-comment"> ...</span>
}</pre>

<p>That’s all. After it is done, animation immediately starts to work:</p>

<div id="begin-animation">
<div class="pre-lang" id="premain224095"><div>C#</div><div class="pre-action-link"><span id="copycode224095" class="copy-code" data-index="224095" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre224095" style="margin-top:0;" class="lang-csharp notranslate" data-language="c#" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-keyword">public</span> <span class="code-keyword">partial</span> <span class="code-keyword">class</span> NonRectangularDemo : Window {

    <span class="code-comment">//</span><span class="code-comment"> ...</span>

    <span class="code-keyword">protected</span> <span class="code-keyword">override</span> <span class="code-keyword">void</span> OnContentRendered(System.EventArgs e) {
        DoubleAnimation animation = <span class="code-keyword">new</span> DoubleAnimation();
        <span class="code-comment">//</span><span class="code-comment"> ...</span>
        clip.BeginAnimation(EllipticalArcGeometry.AngularSizeProperty, animation);
    } <span class="code-comment">//</span><span class="code-comment">OnContentRendered</span>

    <span class="code-comment">//</span><span class="code-comment"> ...</span>

}</pre>

<h2 id="why-not-combinedgeometry">Why not CombinedGeometry?</h2>

<p>In principle, <code>System.Windows.Media.CombinedGeometry</code> could be used to combine the <code>System.Windows.Media.PathGeometry</code> used for the sector and segment cases with simple <code>System.Windows.Media.EllipseGeometry</code> used for the special case of 360°. This probably would be the simplest solution. However, with this approach, the control over the stroking of parts of the paths via the properties <code>PathSegment.IsStroked</code> and <code>PathFigure.IsClosed</code> would be completely lost.</p>

<p>It may sound weird, but look at the test application included in the source code:</p>

<p id="img-segments"><img src="./Resources-articles/2017-04-12.WPF-Arc!.bug.webp" alt="2017-04-12.WPF-Arc!.bug.webp"/></p>
<!--<p id="img-segments"><img src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="Image 4" data-src="/KB/dotnet/1181872/bug.png" class="lazyload" style="max-width: 700px; height: auto"></p>-->

<p>The behavior was tested on .NET versions from 3.5 to 4.6.1.</p>

<p>The path on left (red) is built using a stand-along <code>PathGeometry</code> instance; and the path on right is the member geometry of the instance of <code>CombinedGeometry</code>. The second member of the combination pair is actually <code>null</code>. Nevertheless, it breaks the separate-stroking feature <code>PathGeometry</code>, which can be seen on the test.</p>

<p>We can guess why it happens. Microsoft could consider separate stroking as a complication and gave it up entirely for the combined geometry. Indeed, as a result of combination, some path segments or their parts becomes invisible, so it changes the original meaning of “stroking”. But I would ask: so what? Each visible part of the path still can be stroked or not, being controlled in exact same way. It’s even less clear why the feature is broken even if the other member of the combination is <code>null</code>. I have only one word for this: defect.</p>

<h2 id="compatibility-and-build">Compatibility and Build</h2>

<p>As the code is based on WPF, I used the first platform version decently compatible with WPF — Microsoft.NET v.3.5. Correspondingly, I provided a solution and a project for Visual Studio 2008. I’ve done it intentionally, to cover all the readers who could use WPF. Later .NET versions will be supported; later versions of Visual Studio can automatically upgrade solution and project files. Anyway, the code was tested on .NET versions from 3.5 to 4.6.1.</p>

<p>In fact, Visual Studio is not required for the build. The code can be built as batch, by using the provided batch file “build.bat”. If your Windows installation directory is different from the default, the build will still work. If .NET installation directory is different from default one, please see the content of this batch file and the comment in its first line — next line can be modified to get the build.</p>

<h2 id="conclusions">Conclusions</h2>

<p>I believe everything what could be done in this situation is done. Even though it is impossible to create required type of <code>Geometry</code>, my approach offers all equivalent run-time (functional) features. The difference in the development techniques does not make development more difficult, less maintainable, annoying or tedious. It’s just a bit different and requires some minimal understanding. I hope I explained everything.</p>

<p>I would be much grateful if someone suggests some improvements of offer some informative criticism and perhaps some better ideas. I’ll also gladly answer any questions.</p>
</div>
</div>
</div>
</div>




						</div>
						

						
						<h2>License</h2>
						<div id="LicenseTerms"><p>This article, along with any associated source code and files, is licensed under <a href="http://www.codeproject.com/info/cpol10.aspx" rel="license">The Code Project Open License (CPOL)</a></p></div>
						

						
						<br>
						
						    <br>
						
						

						<div class="clearfix"></div>

						<div style="padding-top:8px">
							
						</div>

					

				    
					</form>

				</div>

				
				<div class="bottom-promo"> 
				    
				</div>
				
                
                

				
				
				

			</div>
			

            
            
            

        </div>
        

		
		<div class="site-footer">
			<div class="align-left">
				<a id="ctl00_PermaLink" href="https://www.codeproject.com/Articles/1181872/WPF-Arc">Permalink</a><br>
				<br>
				<a id="ctl00_PrivacyLink" href="https://www.codeproject.com/info/privacy.aspx">Privacy</a><br>
    			<a id="ctl00_CookiePolicyLink" href="https://www.codeproject.com/info/cookie.aspx">Cookies</a><br>
                <a id="ctl00_TermsOfUseLink" href="https://www.codeproject.com/info/TermsOfUse.aspx">Terms of Use</a><br>
			</div>

            <div class="align-center">
				


<div class="page-width">
    Layout: <a id="ctl00_PageWidth_FixedT" title="Fixed width layout" rel="nofollow" class=" active" href="https://www.codeproject.com/Articles/1181872/WPF-Arc?PageFlow=FixedWidth">fixed</a>
    |
    <a id="ctl00_PageWidth_FluidT" title="Fluid layout" rel="nofollow" href="https://www.codeproject.com/Articles/1181872/WPF-Arc?PageFlow=Fluid">fluid</a>
</div>


				

				

	            

                <br>
			</div>
                
			<div class="align-right">
				Article Copyright 2017 by Sergey Alexandrovich Kryukov<br>Everything else
				Copyright © <a href="mailto:webmaster@codeproject.com">CodeProject</a>, 1999-2024<br>
                <br>
				Web01 
				2.8:2024-12-08:1<br>
			</div>
		</div>
		

		<br clear="all">
		
			

	</div> 
	</div> 
</div>







<script type="text/javascript"> // DEFERRED script

document.addEventListener('DOMContentLoaded', function() {

	new CodeBlocks().initialise('#contentdiv');
	
	$('.author-wrapper .description').shorten({showChars: 400});
	
	anchorAnimate();
	
	$('#__EVENTVALIDATION').attr('autocomplete', 'off');

})
</script>










<style type="text/css">.copied::after {  position: absolute;  right: 0;  display: inline-block; white-space: nowrap; content: 'copied'; color: #fff; background-color: #f90;  border-radius: 3px; padding:1px 8px; opacity: 0;  will-change: opacity, transform; animation: showcopied 1.5s ease; } @keyframes showcopied { 0% { opacity: 0; } 70% { opacity: 1; } 100% { opacity: 0; } } </style><canvas id="cv1" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas><canvas id="cv2" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas></body><grammarly-desktop-integration data-grammarly-shadow-root="true"><template shadowrootmode="open"><style>
      div.grammarly-desktop-integration {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
        -moz-user-select: none;
        -webkit-user-select: none;
        -ms-user-select:none;
        user-select:none;
      }

      div.grammarly-desktop-integration:before {
        content: attr(data-content);
      }
    </style><div aria-label="grammarly-integration" role="group" tabindex="-1" class="grammarly-desktop-integration" data-content="{&quot;mode&quot;:&quot;full&quot;,&quot;isActive&quot;:true,&quot;isUserDisabled&quot;:false}"></div></template></grammarly-desktop-integration></html>