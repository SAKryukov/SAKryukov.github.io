<!DOCTYPE html>
<!-- saved from url=(0066)https://www.codeproject.com/Articles/1061121/ModalPopupFromScratch -->
<html lang="en" data-lt-installed="true"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

	
	<link rel="preconnect" href="https://www.google-analytics.com/">

	<link rel="preconnect" href="https://www.codeproject.com/">


	<link rel="preload" href="./Resources/logo250x135.gif" as="image">


	<link rel="preload" href="https://www.codeproject.com/App_Themes/CodeProject/Img/logo135-bg.gif" as="image">
	<link rel="preload" href="./Resources/jquery-3.4.1.min.js.download" as="script" type="text/javascript">


	<title>Modal Popup From Scratch- CodeProject</title> 
    
	<link type="text/css" rel="stylesheet" href="./Resources/Article.min.css">


    <script type="text/javascript" async="" src="./Resources/analytics.js.download"></script><script type="text/javascript" src="./Resources/jquery-3.4.1.min.js.download" defer=""></script>
<script type="text/javascript" src="./Resources/article.min.js.download" defer=""></script>

	
<meta http-equiv="content-language" content="en-US">

<meta name="Description" content="How to create modal popup functionality without 3rd-party frameworks?">
<meta name="Keywords" content="Javascript, HTML">
<meta name="Author" content="Sergey Alexandrovich Kryukov">
<meta name="Rating" content="General">
<meta name="Revisit-After" content="1 days">
<meta name="application-name" content="CodeProject">
<meta name="google-translate-customization" content="d908bb7ce7aff658-4c2f3a504525c916-g629383f736781a8a-13">



<link rel="dns-prefetch" href="https://ajax.googleapis.com/"> 
<link rel="canonical" href="https://www.codeproject.com/Articles/1061121/Modal-Popup-From-Scratch">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@CodeProject">
<meta name="og:site_name" content="CodeProject">
<meta name="twitter:creator" content="@CodeProject">
<meta property="og:type" content="article">
<meta property="article:published_time" content="12/2/2015 3:05:00 AM">
<meta property="article:modified_time" content="2/1/2019 1:11:00 PM">
<meta name="twitter:label1" content="Written by">
<meta name="twitter:data1" content="Sergey Alexandrovich Kryukov">
<meta name="twitter:label2" content="Reading time">
<meta name="twitter:data2" content="17 min read">
<meta property="og:url" content="https://www.codeproject.com/Articles/1061121/Modal-Popup-From-Scratch">
<meta property="og:title" content="Modal Popup From Scratch">
<meta property="og:description" content="How to create modal popup functionality without 3rd-party frameworks?">


<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="apple-touch-icon" sizes="144x144" href="https://www.codeproject.com/favicon/apple-touch-icon.png"> 
<link rel="icon" type="image/png" sizes="32x32" href="https://www.codeproject.com/favicon/favicon-32x32.png"> 
<link rel="icon" type="image/png" sizes="16x16" href="https://www.codeproject.com/favicon/favicon-16x16.png"> 
<link rel="manifest" href="https://www.codeproject.com/favicon/manifest.json"> 
<link rel="mask-icon" href="https://www.codeproject.com/favicon/safari-pinned-tab.svg" color="#ff9900">
	<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "TechArticle",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.codeproject.com/Articles/1061121/Modal-Popup-From-Scratch"
   },
  "name": "Modal Popup From Scratch",
  "headline": "Modal Popup From Scratch",
  "url": "https://www.codeproject.com/Articles/1061121/Modal-Popup-From-Scratch",
  "discussionUrl": "https://www.codeproject.com/Articles/1061121/Modal-Popup-From-Scratch#_comments",
  "isFamilyFriendly": "true",
  "image": "https://www.codeproject.com/App_Themes/CodeProject/Img/Article100.png",
  "keywords": "Javascript,HTML",
  "commentCount": "0",
  "editor" : {
    "@type" : "Person",
    "name" : "Editor",
    "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=2291164"
  },
  "license": "http://www.codeproject.com/info/cpol10.aspx",
  "publisher" : {
    "@type" : "Organization",
    "name" : "CodeProject"
  },
  "description": "How to create modal popup functionality without 3rd-party frameworks?",
  "articleSection": "HTML",
  "author" : [{
      "@type" : "Person",
      "name" : "Sergey Alexandrovich Kryukov",
      "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=2291164"
    }],
  "datePublished": "2015-12-02",
  "dateCreated": "2015-12-02",
  "dateModified": "2019-02-01"
,
  "contentRating" : {
    "@type" : "Rating",
    "ratingValue" : 4.99,
    "bestRating" : 5,
    "worstRating" : 1
  }
}</script>

<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
    "@type": "ListItem",
    "position": 1,
    "item" : {
      "@id" : "/script/Content/Tag.aspx?tags=web",
      "name" : "web"
    }
  },{
    "@type": "ListItem",
    "position": 2,
    "item" : {
      "@id" : "/script/Content/Tag.aspx?tags=HTML",
      "name" : "HTML"
    }
  }]
}</script>


	<!--<base target="_top">--><base href="." target="_top">
	
    


<script type="text/javascript">
function defrm () { /* thanks twitter */
    document.write = '';
    window.top.location = window.self.location;
    setTimeout(function() { document.body.innerHTML = ''; }, 0);
    window.self.onload = function(evt) { document.body.innerHTML = ''; };
}

if (window.top !== window.self) {
    try {
        if (window.top.location.host) { /* will throw for all except chrome */ }
        else { defrm(); /* chrome */ }
    } catch (ex) { defrm(); /* everyone else */ }
}

// Specific case where a site is screwing with us.
if (typeof(DemoUrl) !== 'undefined') {
    document.write(unescape('%3Cme') + 'ta http' + '-equiv="re' + 'fresh con' +
                           'tent="1;url=' + DemoUrl + unescape('"%3CE'));
}
</script>
	





    <script async="" type="text/javascript" src="./Resources/js"></script>
    <script type="text/javascript">
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-1735123-1' , {'user_id': '42a7d533-9829-4f88-8fc6-84dc936250c9'});
    </script>

<style type="text/css"></style></head>	

<body class="chrome chrome120" data-new-gr-c-s-check-loaded="14.1215.0" data-gr-ext-installed="">



<a class="access-link" href="https://www.codeproject.com/Articles/1061121/ModalPopupFromScratch#Main"><img alt="Click here to Skip to main content" src="./Resources/t.gif"></a>




<div class="page-background">

	
	

	

	
    <div id="ctl00_STM" class="site-top-menu fixed narrow">
        <div class="main-content">
            

<div class="container memberbar clearfix flex-container flex-extend">

	<div id="ctl00_MemberBar_GenInfo" class="flex-item align-left">65,938 articles</div>
	
	<div id="ctl00_MemberBar_ChangeNotice" class="flex-item align-left">CodeProject
	is changing. <a href="https://www.codeproject.com/info/Changes.aspx">Read more</a>.</div>

	<div class="flex-item">
		
	</div>

	<div class="flex-item align-right">

		

		

		
	</div>
</div>
        </div>
    </div>

	
    <div id="ctl00_SH" class="site-header fixed narrow">
        <div class="main-content">
            <div class="logo"><a href="https://www.codeproject.com/"><img id="ctl00_Logo" tabindex="1" title="CodeProject" src="./Resources/logo250x135.gif" alt="Home" style="height:135px;width:250px;border-width:0px;"></a></div>
            <div class="promo"></div>
        </div>
    </div>

	
			
	

	<div id="A" class="container-content-wrap fixed narrow"> 

	<div class="container-content">

        
		<div class="clearfix">
			<div class="container-breadcrumb float-left ">
				<div><a rel="nofollow" href="https://www.codeproject.com/script/Content/SiteMap.aspx">Articles</a> / <a rel="nofollow" href="https://www.codeproject.com/script/Content/Tag.aspx?tags=web">web</a> / <a rel="nofollow" href="https://www.codeproject.com/script/Content/Tag.aspx?tags=HTML">HTML</a></div>
			</div>

            <div class="float-left">
				
			</div>

			<div class="edit-links float-right">
				



 
&nbsp;










			</div>

			<div class="article-nav float-right">
				


<div style="display:inline-block;position:relative;top:-6px;margin-right:20px">
    
</div>



 

<a id="ctl00_ActionLinks_PrintMd" data-tooltip="Print" data-enabletooltip="true" data-width="auto" href="https://www.codeproject.com/Articles/1061121/Modal-Popup-From-Scratch?display=Print" class="tooltip" title="">
   <img src="./Resources/print48.png" width="24" height="24" style="border:0">
<div class="speech-bubble-container-up" style="width:auto">  <div class="speech-bubble-up" style="text-align:center"> Print</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>



<span id="ctl00_ActionLinks_R">
    
    
</span>
			</div>
		</div>

        
		<div class="extended article-container-parts">

			
		    
            

			
			<div id="AT" class="article-container  fixed narrow" style="max-width:inherit;"> 

				<div class="article">

					<form name="aspnetForm" method="post" action="https://www.codeproject.com/Articles/1061121/View.aspx" id="aspnetForm" style="margin:0;padding:0">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="RK5h48LknfgO6zYEOqjwjZfQxoexAr1r30HxaO3h5a9fCbv440JX1VcuDlbrnaGfZ/5+Sw/vccu2y9frqkwcYLnmsNwk2Q9irVO9O0vK1rTTQuu1eZ2vlwcRwhR9lOEpdknkXhw7HY2RtEZdqLw01iAS/De1m1I5gS1wGyZxe097CxaHRriLqQR+2UJ8R1sB0HVwj/ifbyRBgrOfnSJp2NI7CORRwI5eaSmtsNvqy6KtXhtxPBsc5Uobbx3nsojqyGUQ0CjNNjvOfurFf39Gts6nTr4xfoysSMZRK8FjzvTtQquoAl91hh/IQeGwwc6z6kVtQNNKMB2iigCgA2EfTrCU3j6WU2IBqpbHtRw8RxOAfa1c8WzB4N9qO+ai6sghtZqRGLBKbjTi+pygS23yeaSnLcPPD4CddAdbZWF3zhYQ+FtY63WiYNtOZACB7gVl6HT4wxXYtwiZP17FJAcotpthA7hP8tDRbefm9aDNO7mgC/UpneZT9ED889MeXXUFP7mmw2UGVW99ZAnaQM8GCx2MuNHBB2arst241FS+4nWqvWMw0LxPowtzC+n2gzw3c+iMP4/peWTR9peEHPI95dBSK1oRwgIOJ2vALcZsgdoN3XuKNQXBVAVednyE9qRJ8+5YgfYbLukOFsxGruGr0LoWzcLBbtRbigDBbIx19kyOAYcZNKCRsmksUBwQcAlf8GinfyyWo8fpZL2PUlY6eCEqXjyBuKdUDcsBn+HAhtECXc7Y9McGCwFGwG9kcddofNOf2fkvAIZaYr+/dnFKyyQC16wllBGdv/X6GeZ2PSyv9FMY3qem/wUi/thKw6ojin2GcTWeA1v0SZ+IIiy5iba1bOISzY66Byi38i8CEJmtScB/ZdfhY4HV7b1Vaz19bqr31REM1FVsuNKXTTK/qFpFTqgJ2QPFHjxppk1puqK2uuNpC2n3VhHvxMgcGfslRgGgJTbJ3VpNAHqNdVvBNZXtdZpvNEdaX8Xm+kyep6VAf8iEbIvwfW1T1tct/Dy1/UOsYTNshj/V/+WpSNQM1XSlXGcAIajljp6m1GWXNQqMtyoTt82ACMMiqOrPBEyOByHpJm6QmyDijd0HkNRBTZ0cAUTrH0ZjnxQUXc49OGdjik+ZXHHFs4A/ZaiWbckeLn3Ya+mrKgXPgtobMy7vtViBdjuq/03Q0Rwf+V9fB+K7ckGH9vkZUeWjpQ9oqLCppw/hod+k3Bb9lX5KuldtQ8WLALAMMdUkgTW6inXRatzs6O6W6ml/yZAstI/i30usIgMXVTI5yScHKyqBKLDbZRm+xoxxjKoJqGQunadEnWaEXaTLVjRBT2Mf3FrDPzdWTC2nAa6+9qGllYLkUtTTK96ZaCJ278yS1rURs2stP3l3yULt18gM3ZoioGQ40sHFiUsK7BopL6Eroe9kIzT77UzpWAxoyl2HloH87KyzCbMPiNwHqSF+g5BDXfLxwMEIQdgn8yXrYLoc0h1+58UqfEVg8Y19TyGEQQzDZNWTfvp9GeC4IHheVFo20N3ZgIKlkbhCbl0rTZ1K5dX80H0jC4giaLzC0/RcypFOVW4I7lMzKYE5ziZBxvlH+RlXX+fiKvQkTF8eqn8qfKZXoiMBPM0i0a5TFnc1XEBw2WKrP+nCbKDAznjTesJ9pvCE8m2e8H9/hAmnskRQ9FKBN5PiyUDo4bbEOKFy9i1/1Zp4V7VnL/QmCp8tUob9YZ9+gYdj4RnPT/4gyDOtjH49fx1QrFHd+VxTj8aAgUIM8vZh3ZDzEGHzwTrD1yNplBJeUUPu4Z7j6AVtf2cQuo87omFQLCnHzxGYpSSIqp7ZP2HEVcsLtR1Fzun0cMjkFWlPkXI7tDF6RF2nPhB9nyi6ZjBhul7OtikhTDvpP/y+vMlMzv36dZFUkHl3HagVJL9s9bDrT8N1EY3sdqhY/bxezuqSPVJbI6pjywjuW1eP3FzWxp+5S5praWdBYI71Tx3EjSqs6eqKaLCuk1Otnc8+GXyHyqbRJkfZmnBtTxNmr4Pno2uZ98SqjvJdx2rmiwUINMcfCw1Ht5/i9MvNMrAGQAksboFlWfM=">
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="10C1FD69">
</div>

					
					 
					<div class="header">
					    <a name="Main"></a>
					    <a name="_articleTop" id="_articleTop"></a>

					    
						<div>
							<span id="ctl00_TagListHorz_TagWrp" class="tags horizontal">

	
	

	
	<span id="ctl00_TagListHorz_VisibleTags"><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/Javascript" data-id="87">Javascript</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/HTML" data-id="104">HTML</a></div></span> 

	
	
</span>


						</div>
					    <div class="title">
					        <h1 id="ctl00_ArticleTitle">Modal Popup From Scratch</h1>
					    </div>

                        <div>
					        
					        <div class="entry flex-container">

								

                                <div class="flex-item" style="flex:1 1 auto">
                                    <div class="flex-container" style="justify-content:space-between;flex-wrap:wrap-reverse">
                                       <span id="ctl00_Authors" class="author flex-item"><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=2291164" rel="author">Sergey Alexandrovich Kryukov</a></span> 

                                        <div class="flex-item" style="margin-top:-4px;">
                                            <div id="ctl00_RateArticle_RatingTable" class="small-text" data-objectref="2_1061121">

	<meta itemprop="upvoteCount" content="29">


	<div id="ctl00_RateArticle_RatingRow" class="flex-container rating-container large-stars">

					
		

		
		<div class="nowrap tooltip">

			
			<div id="ctl00_RateArticle_ResultNoHist" class="rating-result"><div class="flex-container rating-stars large-stars"><div><img src="./Resources/star-fill-lg.png" style="width:24px;height:24px"></div><div><img src="./Resources/star-fill-lg.png" style="width:24px;height:24px"></div><div><img src="./Resources/star-fill-lg.png" style="width:24px;height:24px"></div><div><img src="./Resources/star-fill-lg.png" style="width:24px;height:24px"></div><div style="width:23px;" class="clipped"><img src="./Resources/star-fill-lg.png" style="width:24px;height:24px"></div><div style="width:1px;position:relative" class="clipped"><img src="./Resources/star-empty-lg.png" style="width:24px;height:24px;position:absolute;top:0px;right:0"></div></div></div>
			

			
			

			
            

			
                

		</div>
		
	
		
		<div id="ctl00_RateArticle_VoteCountNoHist" class="rating-votes nowrap">4.99/5  (30 votes)</div>	

		

		
		<div class="rating-undo" title="Undo vote" style="margin-left:5px;display:none"></div>

		
		
	</div>

	
	

</div>

                                        </div>
                                    </div>

                                    <div class="flex-container" style="color:#666;font-size:smaller">
                                        <span id="ctl00_LastUpdated" class="date flex-item-tight" title="Date last updated">1 Feb 2019</span><a id="ctl00_LicenseLink" title="The Code Project Open License (CPOL)" class="license flex-item-tight" href="http://www.codeproject.com/info/cpol10.aspx">CPOL</a><span id="ctl00_ReadingTime" class="stats flex-item-tight">17 min read</span><span id="ctl00_HorizontalStats" class="stats flex-item-tight"><span class="stats"><span title="Views"><img src="./Resources/views32.png" style="width:16px"> 60.5K</span> &nbsp; <span title="Downloads"><img src="./Resources/download32.png" style="width:16px"> 1K</span> &nbsp; </span></span>
                                    </div>
                                </div>
					        </div>

                            

                        </div>

                        <div id="ctl00_DescriptionSpot" class="summary">How to create modal popup functionality without 3rd-party frameworks?</div><span id="ctl00_ThumbnailUrl" class="date" content="https://www.codeproject.com/script/Articles/Images/article100x80.png"></span>			

                    </div>
                    
					
					

					

					
					

					
					

						
					

					

						
						<div id="contentdiv" class="text">
						



<!-- Article Starts -->

<ul class="download">
	<li><a href="Modal-Popup-From-Scratch.zip">Download source code — 10.2 KB</a></li></ul>

<p id="modalPopuppng"><img alt="Modal Popup" src="./Resources/modalPopup.png"></p>

<blockquote class="FQ">
<div class="FQA"><big>Epigraph:</big></div>
Modality is a facet of illocutionary force, signaled by grammatical devices (that is, moods), that expresses

<ul>
	<li>the illocutionary point or general intent of a speaker, or</li>	<li>a speaker's degree of commitment to the expressed proposition's believability, obligatoriness, desirability, or reality.</li></ul>
SIL International, <a href="http://www-01.sil.org/linguistics/GlossaryOfLinguisticTerms/Index.htm"><u>Glossary of linguistic terms</u></a>, <a href="http://www-01.sil.org/linguistics/GlossaryOfLinguisticTerms/WhatIsMoodAndModality.htm"><u><i>What is mood and modality?</i></u></a></blockquote>

<ol>
	<li><a href="https://www.codeproject.com/Articles/1061121/ModalPopupFromScratch#a1">Why Modal Popup?</a></li>	<li><a href="https://www.codeproject.com/Articles/1061121/ModalPopupFromScratch#a2">Why From Scratch?</a></li>	<li><a href="https://www.codeproject.com/Articles/1061121/ModalPopupFromScratch#a3">How?</a></li>	<li><a href="https://www.codeproject.com/Articles/1061121/ModalPopupFromScratch#a4">Principles of Operation</a></li>	<li><a href="https://www.codeproject.com/Articles/1061121/ModalPopupFromScratch#a5">Modal Popup and Demo Code</a></li>	<li><a href="https://www.codeproject.com/Articles/1061121/ModalPopupFromScratch#a6">A Little Bonus</a></li>	<li><a href="https://www.codeproject.com/Articles/1061121/ModalPopupFromScratch#a7">Your User May Not Love It So Much</a></li>	<li><a href="https://www.codeproject.com/Articles/1061121/ModalPopupFromScratch#a8">Versions</a></li>	<li><a href="https://www.codeproject.com/Articles/1061121/ModalPopupFromScratch#a9">Acknowledgments</a></li>	<li><a href="https://www.codeproject.com/Articles/1061121/ModalPopupFromScratch#LicenseTerms">License</a></li></ol>

<h2 id="a1">1 Why Modal Popup?</h2>

<p>The term "modal popup" is doubly confused. Modal popup <i>control elements</i> are not "modal" in the same sense as this term is understood in native application programming, nor they are "popup windows", as they are understood in Web programming. However, they are "modal" in some generalized meaning: a modal popup, when activated, creates a special mode which allows to force the user to interact only with this popup element. Even though such elements control the user interaction flow, they are not blocking the execution flow of the code, as the traditional dialogs or modal windows do. I'll discuss this difference <a href="https://www.codeproject.com/Articles/1061121/ModalPopupFromScratch#nonBlocking"><u>below</u></a>. For detailed overview of the modal window concept, please see <a href="https://en.wikipedia.org/wiki/Modal_window"><u>https://en.wikipedia.org/wiki/Modal_window</u></a>.</p>

<p>Modal popup elements are very important in Web programming, by some specific reasons. Historically, one way to create a control element separate from a main window, was creation of a separate browser window by code, which is called "popup". Even though this technique is, formally, perfectly legitimate, it earned extremely bad reputation, mostly due to the practice of annoying and intrusive advertisement, which is perceived very negatively, as something close to malicious activity; blocking of such popup windows became a commonplace. Another kind of modal elements (truly modal, analogously to the traditional dialogs or modal windows, using blocking calls) is a set of three JavaScript functions, <code>alert</code>, <code>confirm</code> and <code>prompt</code> None of those functions can be considered acceptable in real production application, due to lack of flexibility, style and convenience. At best, they are useful during development process, for showing of unhandled exception information, which is supposed to serve as the last resort coming into play as a result of unfixed bugs, and the like.</p>

<p>In contrast to those techniques, modal popup does not create any windows, not in the sense of the word "window" as it is understood in the host OS. The modal control element is just emulated on a single page and may only resemble the real window by its style. It actually just creates the UI mode on this page, which blocks the user access to all elements on the page except the popup. Amazingly, this approach solves all the problems mentioned above.</p>

<p>Presently, most of modal popup facilities are jQuery UI elements, such as jQuery Dialog wizard, or third-party plug-ins, but they can be implemented in other frameworks, or from scratch, as with the code I offer in the present article. However, one of the important goals of this article is to explain: why not modal popup? I'll discuss the drawbacks of modal popup in the last <a href="https://www.codeproject.com/Articles/1061121/ModalPopupFromScratch#a7"><u>section of the article</u></a>.</p>

<h2 id="a2">2 Why From Scratch?</h2>

<p>Well, because not everyone wants to use big JavaScript framework, jQuery or anything else. On CodeProject, I saw a number of questions where the inquirers wanted to create some client side rendering effects without using any 3rd-party frameworks. I also prefer minimalistic approach and having everything under my control.</p>

<p>And, the last but not least, it's good to understand how everything works on more fundamental level. It think it would be useful to explain.</p>

<h2 id="a3">3 How?</h2>

<p>Here is the idea:</p>

<p>First of all, when the modal state is entered, it's good to have the effect of <i>dimming</i> of the whole client area of the browser window, except the popup elements. It's easy to achieve. Let's have some element, div, covering the whole client area. To get the see-through effect, we can always set its opacity to some value between 0 and 1, and this value can be optional. On top of that element which I call <i>the dimmer</i>, we can place the popup element with message text, buttons, etc.</p>

<p>In addition to the dimming effect, the dimmer will isolate all the elements on the page from the popup element. The mouse events won't go beyond the dimmer and the popup elements. Does it isolate the page from all user interactions except the popup? Not yet. The elements on the page still can be achieved through the keyboard due to 1) tab navigation, 2) access keys on the input elements, which usually work through Alt+key or Alt+Shift+key keyboard events, depending on a particular browser.</p>

<p>I came to conclusion that the only really reliable way to prevent this kind of interaction is to temporarily disable all the input elements on the page, excluding the popup elements. When the popup mode is started, it's easy to remember the set of elements with modified enabled/disabled states, and restore those states on exit of the popup mode automatically.</p>

<p>Basically, I already shared all the essential ideas of this functionality and its implementation. I am not going to explain all the usage options, which are more or less obvious; instead, I provided a detailed demo application covering most of the possibilities; the demo code is self-explanatory when taken in combination with the <a href="https://www.codeproject.com/Articles/1061121/ModalPopupFromScratch#demopng"><u>demo UI</u></a> and just a few comments. It would leave for just a few delicate moments of the behavior and implementation which i'll try to describe below.</p>

<h2 id="a4">4 Principles of Operation</h2>

<p>First of all, my approach to flexibility is very different from that of jQuery, where the modal popup is composed from the existing HTML markup. Yes, the user of <code>modalPopup.show</code> can do exactly the same thing, but this is not the most basic usage. I believe the most basic usage with minimal effort should be much simpler: just the call with some message string:</p>

<div class="pre-lang" id="premain50001"><div>JavaScript</div><div class="pre-action-link"><span id="copycode50001" class="copy-code" data-index="50001" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre50001" style="margin-top:0;" class="lang-javascript notranslate" data-language="JavaScript" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true">modalPopup.show(<span class="code-string">"</span><span class="code-string">Some HTML content"</span>);</pre>

<p>This call shows popup with predefined default button and with default styles. All other feature come in additional, optional function arguments. (In fact, all arguments are optional; see the very first demo case, "Default", in "<a href="https://www.codeproject.com/Articles/1061121/ModalPopupFromScratch#demopng"><u>demo.html</u></a>".)</p>

<p>The set of features is limited in a good way: it makes it difficult to break out the basic reasonable rendering and behavior: symmetric look, even distribution of buttons, keyboard operation based on access key, dragging and other predefined handling of mouse and keyboard events, and so on.</p>

<p>So, how the existing HTML markup can be used in the way similar to jQuery Dialog? This is quite a trivial thing: moving some existing DOM element into the popup element <code>messageWindow</code>. This can be done on top of basic functionality: the element with HTML markup is converted to a string which can further be used as the first argument to the call to the function <code>modalPopup.show</code>. It can be done via one of the helper functions, <code>modalPopup.prepareContent</code> or <code>modalPopup.prepareContentById</code>; please see the <a href="https://www.codeproject.com/Articles/1061121/ModalPopupFromScratch#singleton"><u>code fragment shown below</u></a>. These functions remove the existing HTML element from the DOM tree after getting its <code>innerHTML</code> string.</p>

<p>For some illustration, please see one of the demonstrations named "Heavily Formatted":</p>

<p id="heavilyFormattedpng"><img alt="Heavily Formatted" src="./Resources/heavilyFormatted.png"></p>

<p>The control of the set of the formatting features is based one of the "named function arguments" approach I suggested in my recent article "<a href="http://www.codeproject.com/Articles/1047623/Named-Arguments-for-JavaScript-Functions-Part-Two"><u>Named Arguments for JavaScript Functions, Part Two: Going Structured</u></a>". The user can modify some formatting options, defines buttons, it's optional properties and optional actions, and define the action performed when the modal state is ended.</p>

<p>I will describe only one most important element of the popup <code>messageWindow</code> styling. <span id="widthToContent">Two</span> options are available: the width of the element is defined as the option and the content is formatted to fit this width, or, less trivially, width-to-content layout is used, then the width of <code>messageWindow</code> is defined by the content of the message or the button part of the popup, whichever appears wider. First option comes by default, with some default width which can be modified by modification of the property <code>styles.width</code>. To use width-to-content formatting, this property should be set to null. False or 0 also can be used, but not <code>undefined</code>, because <code>undefined</code> is a special feature used to apply the value from default structure. This is demonstrated on the use cases "Width to Content, Equalized Button Widths", "Width to Content, Dominated by Message Text" and the same very "Heavily Formatted" case. Please see the <a href="https://www.codeproject.com/Articles/1061121/ModalPopupFromScratch#demopng"><u>demo application</u></a>.</p>

<p>The mechanism of defaults is not so trivial; it is implemented by the function <code>populateWithDefault</code>; for detailed explanation, please see my article dedicated to this mechanism, "<a href="http://www.codeproject.com/Articles/1047623/Named-Arguments-for-JavaScript-Functions-Part-Two"><u>Named Arguments for JavaScript Functions, Part Two: Going Structured</u></a>".</p>

<p id="nonBlocking">The most important aspect of functionality is that there is no blocking of the operation workflow, so the operation only remotely resembles that of "<code>MessageBox.Show</code>" and similar API, but is deeply different in its nature. "MessageBox" and other modal windows provide a way to block current execution flow at the call, at the same time, the flow of input events goes through the modal window, until it is closed, or its modal state is ended. Nothing like that happens with the modal popup. This is just the UI <i>mode</i>, which blocks the user interaction with other elements of the browser window. The call to <code>modalPopup.show</code> does not block execution and returns immediately, while the user keeps working in the "modal" <i>mode</i>. This is illustrated in my demo application by to test cases shown at the bottom section of the demo application window. You can compare the behavior of JavaScript <code>alert</code> with a modal popup use case. By the same reason, modal popup does not return anything. It would be useless, because the call is returned before the user makes any decision. Instead, the developer can define some actions specific to each button and/or the action called when the modal state has ended. At this moment, all the controls of the modal popup content are still accessible, which is demonstrated on the <a href="https://www.codeproject.com/Articles/1061121/ModalPopupFromScratch#demopng"><u>use case "Closing Action"</u></a>.</p>

<h3 id="a4.1">Singleton</h3>

<p>The fact of that the execution flow is not blocked is closely related to the <i>singleton</i> model. Indeed, it would be useless to show another modal popup if the application is already in the modal state. The singleton is hidden inside a single non-constructor function, which is the deepest method of encapsulation in JavaScript; the singleton <code>instance</code> and its construction are hidden under the <i>façade</i> of the non-constructor function <code>modalPopup.show</code>. This is the skeleton of the <code>modalPopup</code> unit:</p>

<div class="pre-lang" id="premain133991"><div>JavaScript</div><div class="pre-action-link"><span class="code-collapse" data-index="133991" id="preShrink133991">Shrink ▲</span> &nbsp; <span id="copycode133991" class="copy-code" data-index="133991" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre133991" style="margin-top:0;" class="lang-javascript notranslate" data-language="JavaScript" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-keyword">const</span> modalPopup = {

	show: <span class="code-keyword">function</span>(content, buttonDescriptors, styles, onEndModalState) {

        <span class="code-keyword">if</span> (!this.instance) {

            <span class="code-comment">//</span><span class="code-comment"> ...</span>

            <span class="code-keyword">this</span>.instance = <span class="code-keyword">new</span> <span class="code-keyword">function</span> () {

                <span class="code-comment">//</span><span class="code-comment"> ...</span>
                <span class="code-keyword">this</span>.dimmer = <span class="code-sdkkeyword">document</span>.createElement(<span class="code-string">"</span><span class="code-string">div"</span>);
                <span class="code-keyword">this</span>.messageWindow = <span class="code-sdkkeyword">document</span>.createElement(<span class="code-string">"</span><span class="code-string">div"</span>);
                <span class="code-comment">//</span><span class="code-comment"> ...</span>

                <span class="code-keyword">this</span>.show = <span class="code-keyword">function</span> (
                    content,
                    buttonDescriptors,
                    styles,
                    endModalStateHandler) {
                        <span class="code-comment">//</span><span class="code-comment"> define content of this.messageWindow</span>
                        <span class="code-comment">//</span><span class="code-comment"> and all the properties</span>
                        <span class="code-comment">//</span><span class="code-comment"> define event handlers for buttons</span>
                        <span class="code-comment">//</span><span class="code-comment"> and the end of modal state handler</span>
                        <span class="code-comment">//</span><span class="code-comment"> show it all </span>
                } <span class="code-comment">//</span><span class="code-comment">this.show</span>
    
                <span class="code-comment">//</span><span class="code-comment"> ...</span>
            
            } <span class="code-comment">//</span><span class="code-comment">this.instance constructor</span>

        } <span class="code-comment">//</span><span class="code-comment">if this instance was not yet defined</span>

        <span class="code-keyword">this</span>.instance.show(content, buttonDescriptors,
            styles, onEndModalState);

    } <span class="code-comment">//</span><span class="code-comment">show</span>

	prepareContent: (element) =&gt; {
		<span class="code-keyword">const</span> content = element.innerHTML;
		element.parentNode.removeChild(element);
		<span class="code-keyword">return</span> content;
	}, <span class="code-comment">//</span><span class="code-comment">prepareContent</span>
	prepareContentById: (id) =&gt; {
		<span class="code-keyword">return</span> modalPopup.prepareContent(<span class="code-sdkkeyword">document</span>.getElementById(id));
	} <span class="code-comment">//</span><span class="code-comment">prepareContentById</span>

} <span class="code-comment">//</span><span class="code-comment">modalPopup</span></pre>

<p>As one can see, two top-level elements of modal popup are created only once: <code>dimmer</code> and <code>messageWindow</code>. All the content of <code>messageWindow</code> is recreated on the call to the instance member (property) function <code>show</code>. All the events of <code>messageWindow</code> are also kept unmodified, but the input event handlers of the global predefined object <code>window</code> are temporarily added and removed, to ensure non-intrusive modification of the behavior of this object, by modifying it only during the modal state of the page. I'll explain the need in these events <a href="https://www.codeproject.com/Articles/1061121/ModalPopupFromScratch#a4.4"><u>below</u></a>.</p>

<h3 id="a4.2">Temporarily Disabled Elements</h3>

<p>Now, this is the core functionality of the modal state: the document input elements are temporarily disabled. The references to the elements with modified disabled property are kept in the object of the upper context, <code>list</code>, and are restored when the modal state is ending. This is how it is done:</p>

<div class="pre-lang" id="premain922978"><div>JavaScript</div><div class="pre-action-link"><span class="code-collapse" data-index="922978" id="preShrink922978">Shrink ▲</span> &nbsp; <span id="copycode922978" class="copy-code" data-index="922978" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre922978" style="margin-top:0;" class="lang-javascript notranslate" data-language="JavaScript" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-keyword">const</span> list = []; 

<span class="code-comment">//</span><span class="code-comment"> ...</span>

<span class="code-keyword">const</span> disableAll = (list, exclusion, parent) =&gt; {
    modalPopupIsShowing = <span class="code-keyword">true</span>;
    <span class="code-keyword">if</span> (parent == exclusion) <span class="code-keyword">return</span>;
    <span class="code-keyword">const</span> objectSample = {};
    <span class="code-keyword">for</span> (<span class="code-keyword">let</span> index <span class="code-keyword">in</span> parent.childNodes) {
        <span class="code-keyword">let</span> child = parent.childNodes[index];
        disableAll(list, exclusion, child);
        <span class="code-keyword">if</span> (<span class="code-keyword">typeof</span> child == <span class="code-keyword">typeof</span> objectSample &amp;&amp; <span class="code-string">"</span><span class="code-string">disabled"</span> <span class="code-keyword">in</span> child &amp;&amp; !child.disabled) {
            child.disabled = <span class="code-keyword">true</span>;
            list.push({ element: child, accessKey: child.accessKey });
            child.accessKey = <span class="code-keyword">undefined</span>; <span class="code-comment">//</span><span class="code-comment"> this is a workaround for Mozilla</span>
        } <span class="code-comment">//</span><span class="code-comment">if</span>
    } <span class="code-comment">//</span><span class="code-comment">loop</span>
} <span class="code-comment">//</span><span class="code-comment">disableAll</span>

<span class="code-keyword">const</span> modalClosing = (itself, list) =&gt; {
    <span class="code-comment">//</span><span class="code-comment"> ...</span>
    <span class="code-keyword">for</span> (<span class="code-keyword">const</span> index <span class="code-keyword">in</span> list)
        list[index].disabled = <span class="code-keyword">false</span>;
    <span class="code-comment">//</span><span class="code-comment"> ...</span>
} <span class="code-comment">//</span><span class="code-comment">modalClosing</span></pre>

<p>The function <code>disableAll</code> is recursive; when called with the element <code>document.body</code>, it disables all elements on the page.</p>

<p>But this is not exactly the code presently found in "ModalPopup.js"; below, I'll explain why.</p>

<h3 id="a4.3">Workaround for Mozilla</h3>

<p>After the fragment of code shown above was already prepared for publication, I noticed disappointing behavior of Mozilla browsers (based on Gecko): some access keys, which are activated, in Mozilla, via Alt+Shift+key, did not work in the modal state. Why only some? Quick check up immediately confirmed my guess: it happens because some matching access keys were defined for some elements on the main window before. When the page elements are disabled, those access keys, quite naturally, don't operate, but they also prevent operation of the access keys of the displayed, visible and enabled elements. Some additional testing revealed, that access keys block operation even if their elements are hidden via the style property <code>visibility</code>, no matter if it is set to <code>"hidden"</code> or <code>"collapse"</code>, or via the style property <code>display</code> set to <code>"none"</code>.</p>

<p>It looks totally illogical, because if access keys are cannot be used, they should not interfere with any operation on enabled element. This is the whole idea behind disabling or hiding of elements. There is nothing similar to this problem on the browsers based on WebKit <i>layout engine</i> (or Blink), Google Chrome, Chromium and Opera. Moreover, they demonstrate very convenient <i>graceful degradation</i> of functionality when two or more visible and enabled elements use identical access keys.</p>

<p>Of course, the workaround needs only couple of lines to be added/modified to both parts of the code, before and after modal state. In addition to disabling, all access keys of the elements should be temporarily unset and restored when the modal state has ended:</p>

<div class="pre-lang" id="premain184447"><div>JavaScript</div><div class="pre-action-link"><span class="code-collapse" data-index="184447" id="preShrink184447">Shrink ▲</span> &nbsp; <span id="copycode184447" class="copy-code" data-index="184447" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre184447" style="margin-top:0;" class="lang-javascript notranslate" data-language="JavaScript" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-keyword">const</span> list = []; 

<span class="code-comment">//</span><span class="code-comment"> ...</span>

<span class="code-keyword">const</span> disableAll = (list, exclusion, parent) =&gt; {
    modalPopupIsShowing = <span class="code-keyword">true</span>;
    <span class="code-keyword">if</span> (parent == exclusion) <span class="code-keyword">return</span>;
    <span class="code-keyword">var</span> objectSample = {};
    <span class="code-keyword">for</span> (<span class="code-keyword">let</span> index <span class="code-keyword">in</span> parent.childNodes) {
        <span class="code-keyword">var</span> child = parent.childNodes[index];
        disableAll(list, exclusion, child);
        <span class="code-keyword">if</span> (<span class="code-keyword">typeof</span> child == <span class="code-keyword">typeof</span> objectSample
            &amp;&amp; <span class="code-string">"</span><span class="code-string">disabled"</span> <span class="code-keyword">in</span> child &amp;&amp; !child.disabled) {
                child.disabled = <span class="code-keyword">true</span>;
                list.push({ element: child, accessKey: child.accessKey });
                child.accessKey = <span class="code-keyword">undefined</span>;
        } <span class="code-comment">//</span><span class="code-comment">if</span>
    } <span class="code-comment">//</span><span class="code-comment">loop</span>
} <span class="code-comment">//</span><span class="code-comment">disableAll</span>

<span class="code-keyword">const</span> modalClosing = (itself, list) =&gt; {
    <span class="code-comment">//</span><span class="code-comment"> ...</span>
    <span class="code-keyword">for</span> (<span class="code-keyword">let</span> index <span class="code-keyword">in</span> list) {
        list[index].element.disabled = <span class="code-keyword">false</span>;
        <span class="code-keyword">if</span> (list[index].accessKey)
            list[index].element.accessKey = list[index].accessKey;
    } <span class="code-comment">//</span><span class="code-comment"> loop</span>
    <span class="code-comment">//</span><span class="code-comment"> ...</span>
} <span class="code-comment">//</span><span class="code-comment">modalClosing</span></pre>

<p>The opposite adverse effect, disabling of some access keys on the main page because of presence of matching access keys on the popup element's <code>messageWindow</code>, is not manifested only because I put clean-up of its content in the handler called after the modal state has ended, <code>modalClosed</code>.</p>

<p>The isolation between two phases of going out of modal state <code>modalClosing</code> and <code>modalClosed</code> is done by some totally unrelated reasons, mostly for better readability of the code and to follow certain naming tradition. Between the calls to these two methods, the closing button action is performed, if one provided by the developer for the button pressed; and the handler called in the last phase, <code>endModalStateHandler</code>, can also be provided by the developer. Please see complete code for further detail.</p>

<p>Demonstration of the bug takes just few lines of code. I failed to find a bug report on this problem on Mozilla side, so I reported it to Mozilla: <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1230387"><u>https://bugzilla.mozilla.org/show_bug.cgi?id=1230387</u></a>.</p>

<h3 id="a4.4">Dragging</h3>

<p>I don't think dragging of the modal popup element is practically very important, especially when think dimming is applied (the level of opacity is optional though, so the content in background can be perfectly visible), but this is what the users are used to, so it would be not nice to neglect this kind of behavior. There is one delicate problem related to dragging: there is no mouse capture. If the mouse move event is handled on some DOM element, fast motion can easily move a mouse pointer outside of the element, which would break the dragging state. The known solution is to handle this event on the object <code>window</code>, which obviously entail the need of handling of the mouse up event. Another event added and removed the same way is <code>resize</code>, by apparent reasons — it moves the element <code>messageWindow</code>, to keep it in symmetric location relative to the window:</p>

<div class="pre-lang" id="premain875907"><div>JavaScript</div><div class="pre-action-link"><span class="code-collapse" data-index="875907" id="preShrink875907">Shrink ▲</span> &nbsp; <span id="copycode875907" class="copy-code" data-index="875907" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre875907" style="margin-top:0;" class="lang-javascript notranslate" data-language="JavaScript" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-keyword">const</span> modalClosing = (itself, list) =&gt; {
    <span class="code-sdkkeyword">window</span>.removeEventListener(<span class="code-string">"</span><span class="code-string">resize"</span>, windowResizeHandler)
    <span class="code-sdkkeyword">window</span>.removeEventListener(<span class="code-string">"</span><span class="code-string">mousemove"</span>, windowMouseMoveHandler);
    <span class="code-sdkkeyword">window</span>.removeEventListener(<span class="code-string">"</span><span class="code-string">mouseup"</span>, windowMouseUpHandler);
    <span class="code-keyword">for</span> (<span class="code-keyword">let</span> index <span class="code-keyword">in</span> list)
    	list[index].disabled = <span class="code-keyword">false</span>;
    hide(itself.messageWindow);
    hide(itself.dimmer);
    modalPopupIsShowing = <span class="code-keyword">false</span>;
} <span class="code-comment">//</span><span class="code-comment">modalClosing</span>

<span class="code-keyword">this</span>.show = <span class="code-keyword">function</span> (
    content,
    buttonDescriptors,
    styles,
    endModalStateHandler) {

    <span class="code-comment">//</span><span class="code-comment"> ...</span>

    <span class="code-keyword">if</span> (allowDragging) {
        <span class="code-sdkkeyword">window</span>.addEventListener(<span class="code-string">"</span><span class="code-string">mouseup"</span>, windowMouseUpHandler);
	 <span class="code-sdkkeyword">window</span>.addEventListener(<span class="code-string">"</span><span class="code-string">mousemove"</span>, windowMouseMoveHandler);
    }

    <span class="code-comment">//</span><span class="code-comment"> ...</span>

    <span class="code-sdkkeyword">window</span>.addEventListener(<span class="code-string">"</span><span class="code-string">resize"</span>, windowResizeHandler);
 
} <span class="code-comment">//</span><span class="code-comment">this.show</span></pre>

<p>There is one more <code>window</code> object event which is never removed: <code>beforeunload</code>; it is used to end the modal state, which is important if the user decides to reload the page without ending the modal state.</p>

<p>All other implementation detail are more or less trivial; please download the complete code to see how it all works.</p>

<h2 id="a5">5 Modal Popup and Demo Code</h2>

<p>All the modal popup functionality is put in a single file, "ModalPopup.js", it does not depend on any other files. The other three files supplied in a downloadable package are related exclusively to the demo code, "demo.html", which is itself is sophisticated enough and covers a good set of use cases.</p>

<p>As I promised <a href="https://www.codeproject.com/Articles/1061121/ModalPopupFromScratch#a3"><u>above</u></a>, I'm not going to explain all the usage cases and the usage techniques; self-explanatory character of the code samples helps to learn the usage and all the options in much easier way. This is how the demo UI looks:</p>

<p id="demopng"><img alt="demo application" src="./Resources/demo.png"></p>

<p>The demo covers the layout options <a href="https://www.codeproject.com/Articles/1061121/ModalPopupFromScratch#widthToContent"><u>described above</u></a>, different button descriptions and their properties, definition of button key description, behavior in escape key press, event handlers, disabled/enabled dragging, styling, and so on.</p>

<p>Two other JavaScript files used for the demo are "NamedCaller.js", "AutoAccessKey.js".</p>

<p>"NamedCaller.js" is used for the convenience of calling of functions with several arguments using named arguments technique I suggested in my other recent article on the "named arguments" topic, where this technique is explained in fine detail: <a href="http://www.codeproject.com/Articles/1045966/Named-Arguments-for-JavaScript-Functions-Yet-Anoth"><u>Named Arguments for JavaScript Functions, Yet Another Approach</u></a>.</p>

<p>As to the other JavaScript file, "AutoAccessKey.js", it is also used for convenience and is unrelated to the topic of the present article. This is just a little bonus.</p>

<h2 id="a6">6 A Little Bonus</h2>

<p>JavaScript constructor function <code>AutoAccessKey</code> provides a way to automatically convert a string representing the inner HTML of some input control, such as <code>button</code>, to an HTML string with an underlined access key; its member function <code>next(value, forceIndex)</code> returns a converted HTML string and an access key character. If all access keys on a Web page are chosen using this facility, it guarantees their uniqueness. First argument, <code>value</code>, should be a string without HTML markup, which is added in the returned object. The second, optional argument <code>forceIndex</code>, indicates the string index of the <i>preferred</i> access key, but this key is chosen only if it is possible (the index is valid and the choice is not breaking uniqueness). On top of this preference, the choice is performed in certain order: only letter characters are used, and capital letters are considered first.</p>

<p>There is one problem with this implementation. Unfortunately, native JavaScript functions lack such feature as classification of characters into letters and non-letters. My method of classification is based on the difference between lower-case and upper-case letters, but it only works for a narrow subset of languages, to best of my knowledge, those derived from Latin and Greek roots; for such languages, the functions <code>toUpper</code> or <code>toLower</code> return a different character only for Uthe characters representing low-case or upper-case letters, correspondingly. Those who need to cover some other languages without lower and upper-case letters, can modify my code to use with some particular culture. I'm sorry about it, but this code is suitable enough for my immediate purpose, the demo application.</p>

<h2 id="a7">7 Your User May Not Love It So Much</h2>

<p>I realize that it's pretty unusual to provide some code and discourage its use at the same time, but this is exactly what I'm going to do; and I think this should be the most important part of the present article.</p>

<p><big><b>Modal behavior should not be overused</b></big>. Your user may not love it so much. Yes, the similar features should be in a toolbox of each and every software developer, and that's why I provide this code, but it does not mean it should be used here and there. I would advise: first thing to do before using any kind of modal behavior or a dialog should be thinking about possible alternatives.</p>

<p>For example, it's a pretty bad idea to show exception information or some other kind of a problem report in a modal control element. Why would you interrupt the user activity in such cases? What do you expect from the user? If the application is fully recovered from the problem, the user may not need to pay too much attention for it. If the problem blocks further activity, some of the controls will be disabled. In all cases, it would be much better to explain the problem in some status line or some other similar non-modal element. The user will read this information only if it is interesting enough and helps to overcome some problem, or not, if the user decides to do something else.</p>

<p>In rare cases, it is important to bring to the user's attention to the situation when next step is not reversible. But first thing about this: may be implementing "undo" is possible; if so, prefer "undo". Please see, for example: <a href="http://alistapart.com/article/neveruseawarning"><u>http://alistapart.com/article/neveruseawarning</u></a>.</p>

<p>And so on… For more ideas on use cases, possible problems and recommendations, please see:</p>

<p><a href="https://en.wikipedia.org/wiki/Modal_window"><u>Modal window</u></a>… <a href="https://en.wikipedia.org/wiki/Modal_window#Use_cases"><u>Use cases</u></a>… <a href="https://en.wikipedia.org/wiki/Modal_window#Problems"><u>Problems</u></a>… <a href="https://en.wikipedia.org/wiki/Modal_window#Recommendations"><u>Recommendations</u></a>…</p>

<p>UI design and development of fine UI is not a simple thing. First thing it requires is the ability to play the role of the user and understand the user's field of activity.</p>

<h2 id="a8">8 Versions</h2>

<h4>1.0.0</h4>

<p>December 2, 2015, initial version.</p>

<h4>2.0.0</h4>

<p>September 28, 2017<br>
Many important fixes.</p>

<h4>2.1.0</h4>

<p>September 30, 2017<br>
Fixed a <a href="https://www.codeproject.com/Articles/1061121/ModalPopupFromScratch?msg=5439956#xx5439956xx"><u>mouse handling bug</u></a> reported by <a href="https://www.codeproject.com/script/Membership/View.aspx?mid=8176342"><u>yuvalrs</u></a>.</p>

<h4>2.2.0</h4>

<p>February 1, 2019<br>
All code is re-written using more modern JavaScript. In particular, all var keywords are eliminated, suitable functions converted to <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions">arrow functions</a>.</p>

<h2 id="a9">9 Acknowledgments</h2>

<p>Code Project user <a href="https://www.codeproject.com/script/Membership/View.aspx?mid=8176342"><u>yuvalrs</u></a> has found a <a href="https://www.codeproject.com/Articles/1061121/ModalPopupFromScratch?msg=5439956#xx5439956xx"><u>bug in mouse handling</u></a>.</p>

<p>This bug was fixed in v. 2.1.0.</p>

<!-- Article Ends -->


						</div>
						

						
						<h2>License</h2>
						<div id="LicenseTerms"><p>This article, along with any associated source code and files, is licensed under <a href="http://www.codeproject.com/info/cpol10.aspx" rel="license">The Code Project Open License (CPOL)</a></p></div>
						

						
						<br>
						
						    <br>
						
						

						<div class="clearfix"></div>

						<div style="padding-top:8px">
							
						</div>

					

				    
					</form>

				</div>

				
				<div class="bottom-promo"> 
				    
				</div>
				
                
                

				
				
				

			</div>
			

            
            
            

        </div>
        

		
		<div class="site-footer">
			<div class="align-left">
				<a id="ctl00_PermaLink" href="https://www.codeproject.com/Articles/1061121/Modal-Popup-From-Scratch">Permalink</a><br>
				<br>
				<a id="ctl00_PrivacyLink" href="https://www.codeproject.com/info/privacy.aspx">Privacy</a><br>
    			<a id="ctl00_CookiePolicyLink" href="https://www.codeproject.com/info/cookie.aspx">Cookies</a><br>
                <a id="ctl00_TermsOfUseLink" href="https://www.codeproject.com/info/TermsOfUse.aspx">Terms of Use</a><br>
			</div>

            <div class="align-center">
				


<div class="page-width">
    Layout: <a id="ctl00_PageWidth_FixedT" title="Fixed width layout" rel="nofollow" class=" active" href="https://www.codeproject.com/Articles/1061121/ModalPopupFromScratch?PageFlow=FixedWidth">fixed</a>
    |
    <a id="ctl00_PageWidth_FluidT" title="Fluid layout" rel="nofollow" href="https://www.codeproject.com/Articles/1061121/ModalPopupFromScratch?PageFlow=Fluid">fluid</a>
</div>


				

				

	            

                <br>
			</div>
                
			<div class="align-right">
				Article Copyright 2015 by Sergey Alexandrovich Kryukov<br>Everything else
				Copyright © <a href="mailto:webmaster@codeproject.com">CodeProject</a>, 1999-2024<br>
                <br>
				Web01 
				2.8:2024-12-08:1<br>
			</div>
		</div>
		

		<br clear="all">
		
			

	</div> 
	</div> 
</div>







<script type="text/javascript"> // DEFERRED script

document.addEventListener('DOMContentLoaded', function() {

	new CodeBlocks().initialise('#contentdiv');
	
	$('.author-wrapper .description').shorten({showChars: 400});
	
	anchorAnimate();
	
	$('#__EVENTVALIDATION').attr('autocomplete', 'off');

})
</script>










<style type="text/css">.copied::after {  position: absolute;  right: 0;  display: inline-block; white-space: nowrap; content: 'copied'; color: #fff; background-color: #f90;  border-radius: 3px; padding:1px 8px; opacity: 0;  will-change: opacity, transform; animation: showcopied 1.5s ease; } @keyframes showcopied { 0% { opacity: 0; } 70% { opacity: 1; } 100% { opacity: 0; } } </style><canvas id="cv1" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas><canvas id="cv2" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas></body><grammarly-desktop-integration data-grammarly-shadow-root="true"><template shadowrootmode="open"><style>
      div.grammarly-desktop-integration {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
        -moz-user-select: none;
        -webkit-user-select: none;
        -ms-user-select:none;
        user-select:none;
      }

      div.grammarly-desktop-integration:before {
        content: attr(data-content);
      }
    </style><div aria-label="grammarly-integration" role="group" tabindex="-1" class="grammarly-desktop-integration" data-content="{&quot;mode&quot;:&quot;full&quot;,&quot;isActive&quot;:true,&quot;isUserDisabled&quot;:false}"></div></template></grammarly-desktop-integration></html>