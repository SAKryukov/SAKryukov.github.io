<!DOCTYPE html>
<!-- saved from url=(0089)https://www.codeproject.com/Articles/1227368/Python-Readonly-Attributes-Complete-Solution -->
<html lang="en" data-lt-installed="true"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

	
	<link rel="preconnect" href="https://www.google-analytics.com/">

	<link rel="preconnect" href="https://www.codeproject.com/">


	<link rel="preload" href="./Resources/logo250x135.gif" as="image">


	<link rel="preload" href="https://www.codeproject.com/App_Themes/CodeProject/Img/logo135-bg.gif" as="image">
	<link rel="preload" href="./Resources/jquery-3.4.1.min.js.download" as="script" type="text/javascript">


	<title>Python Readonly Attributes: Complete Solution- CodeProject</title> 
    
	<link type="text/css" rel="stylesheet" href="./Resources/Article.min.css">


    <script type="text/javascript" async="" src="./Resources/analytics.js.download"></script><script type="text/javascript" src="./Resources/jquery-3.4.1.min.js.download" defer=""></script>
<script type="text/javascript" src="./Resources/article.min.js.download" defer=""></script>

	
<meta http-equiv="content-language" content="en-US">

<meta name="Description" content="Reliable solution does the trick: it does not depend on any naming conventions, works for both Python 2 and 3 and offers clear and concise usage syntax">
<meta name="Keywords" content="">
<meta name="Author" content="Sergey Alexandrovich Kryukov">
<meta name="Rating" content="General">
<meta name="Revisit-After" content="1 days">
<meta name="application-name" content="CodeProject">
<meta name="google-translate-customization" content="d908bb7ce7aff658-4c2f3a504525c916-g629383f736781a8a-13">



<link rel="dns-prefetch" href="https://ajax.googleapis.com/"> 
<link rel="canonical" href="https://www.codeproject.com/Articles/1227368/Python-Readonly-Attributes-Complete-Solution">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@CodeProject">
<meta name="og:site_name" content="CodeProject">
<meta name="twitter:creator" content="@CodeProject">
<meta property="og:type" content="article">
<meta property="article:published_time" content="1/28/2018 12:40:00 AM">
<meta property="article:modified_time" content="1/31/2018 12:02:00 PM">
<meta name="twitter:label1" content="Written by">
<meta name="twitter:data1" content="Sergey Alexandrovich Kryukov">
<meta property="og:url" content="https://www.codeproject.com/Articles/1227368/Python-Readonly-Attributes-Complete-Solution">
<meta property="og:title" content="Python Readonly Attributes: Complete Solution">
<meta property="og:description" content="Reliable solution does the trick: it does not depend on any naming conventions, works for both Python 2 and 3 and offers clear and concise usage syntax">


<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="apple-touch-icon" sizes="144x144" href="https://www.codeproject.com/favicon/apple-touch-icon.png"> 
<link rel="icon" type="image/png" sizes="32x32" href="https://www.codeproject.com/favicon/favicon-32x32.png"> 
<link rel="icon" type="image/png" sizes="16x16" href="https://www.codeproject.com/favicon/favicon-16x16.png"> 
<link rel="manifest" href="https://www.codeproject.com/favicon/manifest.json"> 
<link rel="mask-icon" href="https://www.codeproject.com/favicon/safari-pinned-tab.svg" color="#ff9900">
	<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "TechArticle",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.codeproject.com/Articles/1227368/Python-Readonly-Attributes-Complete-Solution"
   },
  "name": "Python Readonly Attributes: Complete Solution",
  "headline": "Python Readonly Attributes: Complete Solution",
  "url": "https://www.codeproject.com/Articles/1227368/Python-Readonly-Attributes-Complete-Solution",
  "discussionUrl": "#_comments",
  "isFamilyFriendly": "true",
  "image": "https://www.codeproject.com/App_Themes/CodeProject/Img/Article100.png",
  "commentCount": "0",
  "editor" : {
    "@type" : "Person",
    "name" : "Editor",
    "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=2291164"
  },
  "publisher" : {
    "@type" : "Organization",
    "name" : "CodeProject"
  },
  "description": "Reliable solution does the trick: it does not depend on any naming conventions, works for both Python 2 and 3 and offers clear and concise usage syntax",
  "author" : [{
      "@type" : "Person",
      "name" : "Sergey Alexandrovich Kryukov",
      "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=2291164"
    }],
  "datePublished": "2018-01-28",
  "dateCreated": "2018-01-28",
  "dateModified": "2018-01-31"
}</script>

<script type="text/javascript">
function defrm () { /* thanks twitter */
    document.write = '';
    window.top.location = window.self.location;
    setTimeout(function() { document.body.innerHTML = ''; }, 0);
    window.self.onload = function(evt) { document.body.innerHTML = ''; };
}

if (window.top !== window.self) {
    try {
        if (window.top.location.host) { /* will throw for all except chrome */ }
        else { defrm(); /* chrome */ }
    } catch (ex) { defrm(); /* everyone else */ }
}

// Specific case where a site is screwing with us.
if (typeof(DemoUrl) !== 'undefined') {
    document.write(unescape('%3Cme') + 'ta http' + '-equiv="re' + 'fresh con' +
                           'tent="1;url=' + DemoUrl + unescape('"%3CE'));
}
</script>
	





    <script async="" type="text/javascript" src="./Resources/js"></script>
    <script type="text/javascript">
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-1735123-1' , {'user_id': '42a7d533-9829-4f88-8fc6-84dc936250c9'});
    </script>

<style type="text/css"></style></head>	

<body class="chrome chrome120" data-new-gr-c-s-check-loaded="14.1215.0" data-gr-ext-installed="">



<a class="access-link" href="#Main"><img alt="Click here to Skip to main content" src="./Resources/t.gif"></a>




<div class="page-background">

	
	

	

	
    <div id="ctl00_STM" class="site-top-menu fixed narrow">
        <div class="main-content">
            

<div class="container memberbar clearfix flex-container flex-extend">

	<div id="ctl00_MemberBar_GenInfo" class="flex-item align-left">65,938 articles</div>
	
	<div id="ctl00_MemberBar_ChangeNotice" class="flex-item align-left">CodeProject
	is changing. <a href="https://www.codeproject.com/info/Changes.aspx">Read more</a>.</div>

	<div class="flex-item">
		
	</div>

	<div class="flex-item align-right">

		

		

		
	</div>
</div>
        </div>
    </div>

	
    <div id="ctl00_SH" class="site-header fixed narrow">
        <div class="main-content">
            <div class="logo"><a href="https://www.codeproject.com/"><img id="ctl00_Logo" tabindex="1" title="CodeProject" src="./Resources/logo250x135.gif" alt="Home" style="height:135px;width:250px;border-width:0px;"></a></div>
            <div class="promo"></div>
        </div>
    </div>

	
			
	

	<div id="A" class="container-content-wrap fixed narrow"> 

	<div class="container-content">

        
		<div class="clearfix">
			<div class="container-breadcrumb float-left ">
				<div><a rel="nofollow" href="https://www.codeproject.com/script/Content/SiteMap.aspx">Articles</a></div>
			</div>

            <div class="float-left">
				
			</div>

			<div class="edit-links float-right">
				



 
&nbsp;










			</div>

			<div class="article-nav float-right">
				


<div style="display:inline-block;position:relative;top:-6px;margin-right:20px">
    
</div>



 

<a id="ctl00_ActionLinks_PrintMd" data-tooltip="Print" data-enabletooltip="true" data-width="auto" href="https://www.codeproject.com/Articles/1227368/Python-Readonly-Attributes-Complete-Solution?display=Print" class="tooltip" title="">
   <img src="./Resources/print48.png" width="24" height="24" style="border:0">
<div class="speech-bubble-container-up" style="width:auto">  <div class="speech-bubble-up" style="text-align:center"> Print</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>



<span id="ctl00_ActionLinks_R">
    
    
</span>
			</div>
		</div>

        
		<div class="extended article-container-parts">

			
		    
            

			
			<div id="AT" class="article-container  fixed narrow" style="max-width:inherit;"> 

				<div class="article">

					<form name="aspnetForm" method="post" action="https://www.codeproject.com/Articles/1227368/View.aspx" id="aspnetForm" style="margin:0;padding:0">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="0FVHx87VBM9GnDQ/AmQ6IHeWzJ2ZsLL7kjr7X/T10OHtUjYnx0EkEihSQK4I9Fwi9MFCH84noRgDiCyvrg0xwu8WnckhGCOL8GaVLVZcj0/Y2VM5peHeyD6HJk+sB4Gfn8kdjVHA2rx/lBNkMmkDcgt18udIjBrrGvz9yLyLNgM1OamEiyRj0sXFUImDsQ4exxGMhRqsZrSsh6Ej32rRmSZR5QeIOIbpsjDRngYSeW7bDWBYdhISphR8F5Bk7YjGh/WhrDeq9TTgvF+4OeVovldUnAzzTPdE9zyrT51Cea71Y46Y3UUBQilTm7VXe8EXP5lcaRyfjZh14DL1ZANIK4DB7OOkx4raj2ufStrjNC7JP+aHVHF2AZ4VVBq6V7+9I3XkJ+zsw/9TS4v9/ZmiXiyaF/1WXOwUxw/9knerTN9purE7hReQUXaJNKl3l9N4J1wQs90Qh/1/SznND01UVug63Lp8MEXOkoFTP+lCO9m95l2tqfEDfmG2z2XZmFGajm0aUE/DaLF5CYD+emYx/y88/52XVJ6EJTi8iLezeZ7lFQYObYfNEhUb+Y+FLgtbVoRk+gBxMVOxoWdX/NOfemB1igf34O42D1k9DE7xPfXpO+wknDCLu8AYdpFQ8MwIQHGCEnS2pXxn4LO1DAMKfr8xH2I++WqST5gJznfhbwqp45kaQdH8+y7o61JhvBR3m+YsHhNwZtlAeB3ao6f0GDmdOF1nOkmCvIeT5HxSO/YMIX9LDlWCbXOimzrRhfljEte1Q+WLwxNI/e7B1WQzGJie1nf5ZJ+6OTNKvm4KBZ7xAJIQY9AErkRMw7d/TNVpggTlJ9rmDw7jHJlC20pTHxebUqe3KvU8V1qJ81UbbmYXbsi4W+P4KsYa/F05IsK8xwpX3PoO7yXLFZhDWIzu1cWB4ux+mp6a2SJEwzlGhmxCpD66FJlKYsAn4ssOny9xbyfAB9GW6a8VQhmGFCc9vIxTuaGYDNvtDKNUmGOrmZyI2dpOZyN8fLMVUMB8xyp0I1QJQPCxJiF/K6rcAJjq7DrFd8gFxBwktxRBccDVcgjX1x6we4xMlzzLMLs7o4YsSKzbV1XuhZDuCetfbdQCeT/MCVJvVRN3j9kLKHApyEZhi+6ZJouQ1eg578MZYTvSz8dgnFak2MtpLTbxgL1n8EVSR3CAvOdA0ZQ+KPOykXCIJDIGnbk1t50UNz+qoWGGtU9OfPn4O/mGkUbpEZ3zrwwCP7iFr27FxibZBUDXSfdgOCw57+jnCe9MmJ3V4bQsxfVzZyTOeAKcRhVl55iUWJ90VULUM55xbOlIFbHzPG03eNd5HnX5Rs3KDh6lVhIuUvwXdYbdBdc4GNjtjj/qJKT437YymVS7ug5vygFB30ZK4IbnnWfCogMTSsh54Hv7iUcnL6hDAj5LN4BDoufyQPkunVwl0CLQF/MN3iPFYYlCg5vqzRimRDOEnq/6sbGwhmHGakSOZUOK9svrGiNqSQSwfyxBpmcbvAj/+QF8Zv7/BVIVfPajDFkHvRgRVbo9oPah//TLcINw8TnL8cgmvqI+JQq2MPDEOjvlScUKUEkv8ZLF57O9wdI/OtAT3HU9lddGLFNu9IfJ2iIDIO2rtr3Zvfl/RrOp0XDRmiedNBz7g04BBkuIab59kOVONusDcMfSMLzBBzUc91Cl5PQN3Nnwwxww4wF0T1XFGvU9stziV+ADWbDkW3GnnLwKsHIx9QrhjfHE2TP69VLt+k4CKTOguBZNhEifgtjFhRFSVwSrkdTM4qheA7cMakRiJcFLRBjyr5GTGvsF7f9WN8C1eQehIao=">
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="10C1FD69">
</div>

					
					 
					<div class="header">
					    <a name="Main"></a>
					    <a name="_articleTop" id="_articleTop"></a>

					    
						<div>
							<span id="ctl00_TagListHorz_TagWrp">

	
	

	
	<span id="ctl00_TagListHorz_VisibleTags" class="subdue">(untagged)</span> 

	
	
</span>


						</div>
					    <div class="title">
					        <h1 id="ctl00_ArticleTitle">Python Readonly Attributes: Complete Solution</h1>
					    </div>

                        <div>
					        
					        <div class="entry flex-container">

								

                                <div class="flex-item" style="flex:1 1 auto">
                                    <div class="flex-container" style="justify-content:space-between;flex-wrap:wrap-reverse">
                                       <span id="ctl00_Authors" class="author flex-item"><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=2291164" rel="author">Sergey Alexandrovich Kryukov</a></span> 

                                        <div class="flex-item" style="margin-top:-4px;">
                                            <div id="ctl00_RateArticle_RatingTable" class="small-text" data-objectref="2_1227368">

	<meta itemprop="upvoteCount" content="0">


	<div id="ctl00_RateArticle_RatingRow" class="flex-container rating-container large-stars">

					
		

		
		<div class="nowrap tooltip">

			
			<div id="ctl00_RateArticle_ResultNoHist" class="rating-result"><div class="flex-container rating-stars large-stars"><div style="width:24px;position:relative" class="clipped"><img src="./Resources/star-empty-lg.png" style="width:24px;height:24px;position:absolute;top:0px;right:0"></div><div><img src="./Resources/star-empty-lg.png" style="width:24px;height:24px"></div><div><img src="./Resources/star-empty-lg.png" style="width:24px;height:24px"></div><div><img src="./Resources/star-empty-lg.png" style="width:24px;height:24px"></div><div><img src="./Resources/star-empty-lg.png" style="width:24px;height:24px"></div></div></div>
			

			
			

			
            

			
                

		</div>
		
	
		
		<div id="ctl00_RateArticle_VoteCountNoHist" class="rating-votes nowrap">0.00/5  (No votes)</div>	

		

		
		<div class="rating-undo" title="Undo vote" style="margin-left:5px;display:none"></div>

		
		
	</div>

	
	

</div>

                                        </div>
                                    </div>

                                    <div class="flex-container" style="color:#666;font-size:smaller">
                                        <span id="ctl00_LastUpdated" class="date flex-item-tight" title="Date last updated">28 Jan 2018, last revision: 31 Jan 2018</span><span id="ctl00_HorizontalStats" class="stats flex-item-tight"><span class="stats"><span title="Views"><img src="./Resources/views32.png" style="width:16px"> 1</span> &nbsp; </span></span>
                                    </div>
                                </div>
					        </div>

                            

                        </div>

                        <div id="ctl00_DescriptionSpot" class="summary">Reliable solution does the trick: it does not depend on any naming conventions, works for both Python 2 and 3 and offers clear and concise usage syntax</div><span id="ctl00_ThumbnailUrl" class="date" content="https://www.codeproject.com/script/Articles/Images/article100x80.png"></span>			

                    </div>
                    
					
					

					

					
					

					
					

						
					

					

						
						<div id="contentdiv" class="text">
						



<!-- Article Starts -->

<ul class="download">
    <li><a href="https://github.com/SAKryukov/python-readonly-class-attributes">Download or clone source code from GitHub</a></li></ul>
<h2 id="heading.contents">Contents</h2>
<p></p><div class="toc"><ul style="list-style-type: none; margin-top: 0; margin-bottom: 0"><li><a href="#heading.introduction">Introduction</a></li><li><a href="#heading.why-class-attributes3f">Why Class Attributes?</a></li><li><a href="#heading.solution-for-class-attributes3a-usage">Solution for Class Attributes: Usage</a><ul style="list-style-type: none; margin-top: 0; margin-bottom: 0"><li><a href="#heading.unification-of-python-2-and-3-in-the-demo">Unification of Python 2 and 3 in the Demo</a></li></ul></li><li><a href="#heading.how-it-works3f">How it Works?</a></li><li><a href="#heading.what-to-do-with-instance-attributes3f">What to Do with Instance Attributes?</a></li><li><a href="#heading.generalized-solution">Generalized Solution</a></li><li><a href="#heading.versions">Versions</a></li></ul></div><p></p>
<h2 id="heading.introduction">Introduction</h2>
<p>This solution is based on the small code sample by <a href="https://github.com/rIZenAShes">rIZenAShes</a> found <a href="https://gist.github.com/rIZenAShes/8469932">on GitHub</a>, which demonstrates quite interesting ideas.</p>
<p>As to the code, I found it, by far, not satisfactory. First, it is only compatible with Python 2, not 3. Worse, it is based on some naming conventions. The attributes to be exposed are marked by leading underscore, which is removed be the metaclass for exposed read-only properties. The present solution is compatible with both lines of Python versions and offers clear and concise syntax.</p>
<p>So, what’s the big deal?</p>
<p>Implementing read-only attributes is fairly easy:</p>
<div class="pre-lang" id="premain888909"><div>Python</div><div class="pre-action-link"><span class="copy-code" data-index="888909" id="copycode888909" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve">
<g>
<path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272
    c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729
    c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path>
<path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272
    c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068
    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001
    C291.206,428.715,289.92,430,288.341,430z"></path>	
</g>
</svg></span></div></div><pre lang="Python" data-codeblock-processed="true" id="pre888909" style="margin-top: 0px;" class="notranslate"><span class="code-keyword">class</span> Meta(type):
    <span class="code-sdkkeyword">@property</span>
    <span class="code-keyword">def</span> RO(self):
        <span class="code-keyword">return</span> <span class="code-digit">13</span>

<span class="code-keyword">class</span> DefinitionSet(Meta(str(), (), {})):
    greetings = <span class="code-string">"</span><span class="code-string">Hello!"</span>
    myNameFormat = <span class="code-string">"</span><span class="code-string">My name is {}."</span>
    durationSeconds = <span class="code-digit">3</span>.<span class="code-digit">5</span>
    color = { <span class="code-string">"</span><span class="code-string">opacity"</span>: <span class="code-digit">0</span>.<span class="code-digit">7</span>, <span class="code-string">"</span><span class="code-string">wavelength"</span>: <span class="code-digit">400</span> }
    <span class="code-sdkkeyword">@property</span>
    <span class="code-keyword">def</span> RO(self):
        <span class="code-keyword">return</span> <span class="code-digit">14</span>
    <span class="code-keyword">def</span> __init__(self):
        self.greetings = <span class="code-string">"</span><span class="code-string">Hello again!"</span>
        self.myNameFormat = <span class="code-string">"</span><span class="code-string">Let me introduce myself. My name is {}."</span>
        self.durationSeconds = <span class="code-digit">3</span>.<span class="code-digit">6</span>
        self.color = { <span class="code-string">"</span><span class="code-string">opacity"</span>: <span class="code-digit">0</span>.<span class="code-digit">8</span>, <span class="code-string">"</span><span class="code-string">wavelength"</span>: <span class="code-digit">410</span> }

instance = DefinitionSet()
<span class="code-comment">#</span><span class="code-comment"> instance.RO and DefinitionSet.RO are two different</span>
<span class="code-comment">#</span><span class="code-comment"> read-only attributes</span></pre>
<p>In this code sample, <code>instance.RO</code> behaves as an <em>instance attribute</em> and <code>DefinitionSet.RO</code> — as a <em>class attribute</em>; they are introduced as <code>read-only properties</code>.</p>
<p>Note certain inconvenience in development: while in usage such property is used as a peer of some “regular” attributes (for example, <code>instance.RO</code> vs. <code>instance.color</code>), it is set up on an upper level, the level of the <em>object type</em>. For <code>instance</code>, this is instance type, <code>type(instance) == DefinitionSet</code>; for <code>DefinitionSet</code>, this is its <em>metaclass</em>, <code>type(DefinitionSet) == Meta</code>. (Not so obvious way of setting up a metaclass for <code>DefinitionSet</code>, through <em>inheritance</em> is shown; this is done for the sole purpose of showing equivalent code for Python 2 and 3, <a href="#heading.unification-of-python-2-and-3-in-the-demo">see below</a>.)</p>
<p>Definition of read-only class properties looks a bit more complicated than in case of instance properties: with instances, the description at least can be placed in <em>almost</em> one place (compare <code>DefinitionSet.RO</code> and <code>self.greetings</code> in <code>__init__</code>). For a class attribute, the property definition should be placed in a separate class (<code>Meta</code> in our sample).</p>
<p>Now, the problem is alleviated with the small device, <code>@property</code> <em>decorator</em>, which can be considered as kind of <a href="https://en.wikipedia.org/wiki/Syntactic_sugar">syntactic sugar</a>. If we wanted to start <em><a href="https://en.wikipedia.org/wiki/Ab_ovo">ab ovo</a></em>, we would show mode fundamental use of <em>descriptors</em>, based on <code>__get__</code>, as it is described in documentation for <a href="https://docs.python.org/2/howto/descriptor.html">Python 2</a> and <a href="https://docs.python.org/3/howto/descriptor.html">Python 3</a>.</p>
<p>So, can we create syntactic sugar sweeter than that, shorter, more clear and concise? Would it make any practical sense?</p>
<p>The answer depends on our usage of <em>class attributes</em>, as turning them into read-only properties looks more confusing and less clear.</p>
<h2 id="heading.why-class-attributes3f">Why Class Attributes?</h2>
<p>Class attributes have many uses, but I want to illustrate their importance on one simple use case: definition sets. Let’s say we need to define some strings and integer constants. It’s a good idea to put all of them in one place, to avoid using immediately defined <a href="https://en.wikipedia.org/wiki/Magic_number_%28programming%29">magic numbers</a> or <a href="https://en.wikipedia.org/wiki/Magic_string">magic string</a> anywhere else.</p>
<p>Let’s, for a minute, forget about read-only properties and simply compare two options:</p>
<div class="pre-lang" id="premain678476"><div>Python</div><div class="pre-action-link"><span class="copy-code" data-index="678476" id="copycode678476" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve">
<g>
<path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272
    c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729
    c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path>
<path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272
    c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068
    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001
    C291.206,428.715,289.92,430,288.341,430z"></path>	
</g>
</svg></span></div></div><pre lang="Python" data-codeblock-processed="true" id="pre678476" style="margin-top: 0px;" class="notranslate"><span class="code-comment">#</span><span class="code-comment"> using class attributes:</span>
<span class="code-keyword">class</span> DefinitionSet:
    greetings = <span class="code-string">"</span><span class="code-string">Hello!"</span>
    myNameFormat = <span class="code-string">"</span><span class="code-string">My name is {}."</span>
    durationSeconds = <span class="code-digit">3</span>.<span class="code-digit">5</span>
    color = { <span class="code-string">"</span><span class="code-string">opacity"</span>: <span class="code-digit">0</span>.<span class="code-digit">7</span>, <span class="code-string">"</span><span class="code-string">wavelength"</span>: <span class="code-digit">400</span> }

<span class="code-comment">#</span><span class="code-comment">...</span>
<span class="code-keyword">print</span> (DefinitionSet.durationSeconds)</pre>
<p>and</p>
<div class="pre-lang" id="premain643912"><div>Python</div><div class="pre-action-link"><span class="copy-code" data-index="643912" id="copycode643912" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve">
<g>
<path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272
    c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729
    c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path>
<path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272
    c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068
    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001
    C291.206,428.715,289.92,430,288.341,430z"></path>	
</g>
</svg></span></div></div><pre lang="Python" data-codeblock-processed="true" id="pre643912" style="margin-top: 0px;" class="notranslate"><span class="code-comment">#</span><span class="code-comment"> using instance attributes:</span>
<span class="code-keyword">class</span> DefinitionSet:
    <span class="code-keyword">def</span> __init__(self):
        self.greetings = <span class="code-string">"</span><span class="code-string">Hello!"</span>
        self.myNameFormat = <span class="code-string">"</span><span class="code-string">My name is {}."</span>
        self.durationSeconds = <span class="code-digit">3</span>.<span class="code-digit">5</span>
        self.color = { <span class="code-string">"</span><span class="code-string">opacity"</span>: <span class="code-digit">0</span>.<span class="code-digit">7</span>, <span class="code-string">"</span><span class="code-string">wavelength"</span>: <span class="code-digit">400</span> }
definitionSet = DefinitionSet()

<span class="code-comment">#</span><span class="code-comment">...</span>
<span class="code-keyword">print</span> (definitionSet.durationSeconds)</pre> 
<p>It is apparent that the option with class attribute is shorter and more convenient. Normally, the instance is needed only if we need more than one instance, but in this case even more boring part would be passing values as <code>__init__</code> arguments. For a single set of definitions it would be totally pointless.</p>
<h2 id="heading.solution-for-class-attributes3a-usage">Solution for Class Attributes: Usage</h2>
<p>First, let’s see how it can be used:</p>
<div class="pre-lang" id="premain138581"><div>Python</div><div class="pre-action-link"><span class="copy-code" data-index="138581" id="copycode138581" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve">
<g>
<path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272
    c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729
    c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path>
<path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272
    c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068
    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001
    C291.206,428.715,289.92,430,288.341,430z"></path>	
</g>
</svg></span></div></div><pre lang="Python" data-codeblock-processed="true" id="pre138581" style="margin-top: 0px;" class="notranslate"><span class="code-keyword">class</span> Foo(ReadonlyBase):
    bar = <span class="code-digit">100</span>
    test = Readonly.Attribute(<span class="code-digit">13</span>)

<span class="code-keyword">print</span>(<span class="code-string">"</span><span class="code-string">Foo.bar: "</span> + str(Foo.bar))
Foo.bar += <span class="code-digit">1</span>
<span class="code-keyword">print</span>(<span class="code-string">"</span><span class="code-string">Modified Foo.bar: "</span> + str(Foo.bar))
<span class="code-keyword">print</span>(<span class="code-string">"</span><span class="code-string">Foo.test: "</span> + str(Foo.test))
<span class="code-keyword">try</span>:
    Foo.test = Foo.test + <span class="code-digit">1</span> <span class="code-comment">#</span><span class="code-comment"> will raise exception</span>
<span class="code-keyword">except</span> Exception:
    <span class="code-keyword">print</span> (<span class="code-string">"</span><span class="code-string">Cannot set attribute Foo.test"</span>)</pre>
<p>Here, the attribute <code>test</code> is just marked with the assignment using <code>Readonly.Attribute</code>; the desired constant value of any type is moved to an actual argument of the call. The object <code>Attribute</code> is the inner class of the class <code>Readonly</code>; the whole line is the call to its constructor and assignment.</p>
<p>Here is the idea: the entire trick is performed by the metaclass: if the attribute is assigned to a <code>Readonly.Attribute</code> object, instantiation of the class object removes this attributes and creates matching read-only property exposed by another metaclass. It may sounds tricky, but… it is really pretty tricky. <a href="#heading.how-it-works3f">Below, we can see how it works.</a></p>
<p>In fact, <code>ReadonlyBase</code> base class does not have to be used. It is shown in this code sample due to different syntax of Python 2 and Python 3. The class <code>Foo</code> could directly setup its <em>metaclass</em>, without any base classes. The only problem is the different syntax. Let’s consider this unpleasant Python problem and its work-around.</p>
<h3 id="heading.unification-of-python-2-and-3-in-the-demo">Unification of Python 2 and 3 in the Demo</h3>
<p>The usage sample <a href="https://www.codeproject.com/Articles/1227368/heading.the-solution3a-usage">shown above</a> lacks the definition of the class <code>ReadonlyBase</code>. Without this class, the class <code>Foo</code> could be created directly from the class <code>Readonly</code> used as its metaclass, using the following syntax:</p>
<div class="pre-lang" id="premain8971"><div>Python</div><div class="pre-action-link"><span class="copy-code" data-index="8971" id="copycode8971" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve">
<g>
<path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272
    c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729
    c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path>
<path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272
    c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068
    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001
    C291.206,428.715,289.92,430,288.341,430z"></path>	
</g>
</svg></span></div></div><pre lang="Python" data-codeblock-processed="true" id="pre8971" style="margin-top: 0px;" class="notranslate"><span class="code-comment">#</span><span class="code-comment"> Python 2.*.*:</span>
<span class="code-keyword">class</span> Foo(object, metaclass = Readonly):
    <span class="code-comment">#</span><span class="code-comment"> ...</span></pre>
<div class="pre-lang" id="premain407647"><div>Python</div><div class="pre-action-link"><span class="copy-code" data-index="407647" id="copycode407647" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve">
<g>
<path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272
    c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729
    c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path>
<path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272
    c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068
    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001
    C291.206,428.715,289.92,430,288.341,430z"></path>	
</g>
</svg></span></div></div><pre lang="Python" data-codeblock-processed="true" id="pre407647" style="margin-top: 0px;" class="notranslate"><span class="code-comment">#</span><span class="code-comment"> Python 3.*.*:    </span>
<span class="code-keyword">class</span> Foo(object):
    __metaclass__ = Readonly
    <span class="code-comment">#</span><span class="code-comment"> ...</span></pre>
<p>Alternatively, the base class <code>ReadonlyBase</code> could have been created in the same way. Instead, the file “demo.py” uses creation of an equivalent class object using <em>metaprogramming</em> approach:</p>
<div class="pre-lang" id="premain884877"><div>Python</div><div class="pre-action-link"><span class="copy-code" data-index="884877" id="copycode884877" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve">
<g>
<path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272
    c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729
    c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path>
<path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272
    c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068
    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001
    C291.206,428.715,289.92,430,288.341,430z"></path>	
</g>
</svg></span></div></div><pre lang="Python" data-codeblock-processed="true" id="pre884877" style="margin-top: 0px;" class="notranslate">ReadonlyBase = Readonly(str(), (), {})</pre>
<p>This piece of code is compatible with both lines of Python versions. To understand how it works, it’s enough to know that a metaclass is just a class derived (directly or indirectly) from the class <code>type</code>. The call to its constructor creates an object which is a class: it has all the properties of a class and can be used as a class, and possibly, depending on the second parameter (<code>bases</code>), as a metaclass.</p>
<p>At this point, the usage is explained. Now, it’s time to show how the metaclass <code>Readonly</code> turns the class attributes marked by the assignment into read-only properties.</p>
<h2 id="heading.how-it-works3f">How it Works?</h2>
<p>This is the entire solution:</p>
<div class="pre-lang" id="premain83210"><div>Python</div><div class="pre-action-link"><span class="copy-code" data-index="83210" id="copycode83210" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve">
<g>
<path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272
    c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729
    c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path>
<path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272
    c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068
    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001
    C291.206,428.715,289.92,430,288.341,430z"></path>	
</g>
</svg></span></div></div><pre lang="Python" data-codeblock-processed="true" id="pre83210" style="margin-top: 0px;" class="notranslate"><span class="code-keyword">class</span> Readonly(type):

    <span class="code-keyword">class</span> Attribute(object):
        <span class="code-keyword">def</span> __init__(self, value):
            self.value = value
    
    <span class="code-keyword">def</span> __new__(metaclass, classname, bases, classdict):
        <span class="code-keyword">class</span> NewMetaclass(metaclass):
            attributeContainer = {}
        <span class="code-keyword">def</span> getAttrFromMetaclass(attr):
            <span class="code-keyword">return</span> <span class="code-keyword">lambda</span> cls: type(cls).attributeContainer[attr]
        clone = dict(classdict)
        <span class="code-keyword">for</span> name, value <span class="code-keyword">in</span> clone.items():
            <span class="code-keyword">if</span> <span class="code-keyword">not</span> isinstance(value, metaclass.Attribute):
                <span class="code-keyword">continue</span>;
            getattr(NewMetaclass, DefinitionSet.attributeContainerName)[name] = value.value
            aProperty = <span class="code-keyword">property</span>(getAttrFromMetaclass(name))
            setattr(NewMetaclass, name, aProperty)
            classdict[name] = aProperty
            classdict.pop(name, <span class="code-keyword">None</span>)               
        <span class="code-keyword">return</span> type.__new__(NewMetaclass, classname, bases, classdict)</pre>
<p>It is easy to show but harder to explain.</p>
<p>First of all, for all classes using <code>Readonly</code> as a metaclass, this metaclass is used only for the instantiation of a class object. At the moment of instantiation, the class object is created with a different metaclass named <code>NewMetaclass</code>, individual instance for each class instance. It is called “New” because it is ultimately used in the call <code>type.__new__(NewMetaclass, classname, bases, classdict)</code>.</p>
<p>Each instance of <code>NewMetaclass</code> is different. First of all, it is used as a container of all instances of the class <code>Readonly.Attribute</code> to be used by the class being initialized. Second of all, it is used as a container of some properties each named exactly as original class attribute to be re-worked into a read-only property.</p>
<p>When the original set of attributes of the class is traversed, the <code>Readonly.Attribute</code> instances are created and placed in the dictionary <code>NewMetaclass.attributeContainer</code>. For each such attribute, the property object is created using the constructor <code>property()</code>. For each distinct attribute name, such property is initialized with <code>lambda</code> expression generated based in the name, returning the value retrieved from <code>attributeContainer</code>.</p>
<p>During these manipulations, original class dictionary passed to <code>type._new_</code> if modified to remove original wanna-be-read-only class attributes. Before the traversal, the dictionary is cloned, otherwise we could face exception (in case of Python 3) caused by the attempt of modification of a dictionary being iterated.</p>
<p>Isn’t that quite enough? No. We can make one big step further.</p>
<h2 id="heading.what-to-do-with-instance-attributes3f">What to Do with Instance Attributes?</h2>
<p>Can the same mechanism be used for instance attributes, too?</p>
<p>Perhaps we would not bother if we needed only instance attributes and not class attributes. But when the mechanism of using <code>Readonly.Attribute</code> is already available, it would be more natural to have more concise and uniform look for both class and instance attributes:</p>
<div class="pre-lang" id="premain938728"><div>Python</div><div class="pre-action-link"><span class="copy-code" data-index="938728" id="copycode938728" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve">
<g>
<path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272
    c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729
    c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path>
<path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272
    c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068
    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001
    C291.206,428.715,289.92,430,288.341,430z"></path>	
</g>
</svg></span></div></div><pre lang="Python" data-codeblock-processed="true" id="pre938728" style="margin-top: 0px;" class="notranslate"><span class="code-keyword">class</span> Foo(ReadonlyBase): <span class="code-comment">#</span><span class="code-comment"> or make Readonly a metaclass of Foo, see above</span>
    bar = <span class="code-digit">100</span>
    test = Readonly.Attribute(<span class="code-digit">13</span>)
    <span class="code-keyword">def</span> __init__(self):
        self.a = <span class="code-digit">1</span>
        self.b = Readonly.Attribute(<span class="code-digit">3</span>.<span class="code-digit">14159</span>)</pre>
<p>So, how to achieve similar read-only effect on the instance attributes, such as <code>b</code>? This is shown below.</p>
<h2 id="heading.generalized-solution">Generalized Solution</h2>
<p>Surprisingly, applying the similar technique to instance attribute appears much trickier than with class attributes.</p>
<p>The major problem here is working with several instances of the class. Implementation of a property, read-only or not, require modification of the instance class. It can be easily done in the <code>__new__</code> method of the metaclass, but it would work only on one instantiation of this class. On the attempt of creating of the second instance, a constructor assigning <code>Readonly.Attribute</code> to the same attribute will fail, because the modified class already made to provide read-only functionality for this attribute. Therefore, we come to the situation when we need to create a separate class for each instance.</p>
<p>The real trick is to inject a hook in the class constructor, which is done via the call to <code>type.__call__</code> in the body of the method <code>__call__</code> of the metaclass.</p>
<p>When this call creates an <code>instance</code>, we need another instance of the class created dynamically. This new instance, <code>newInstance</code>, is created from the dynamically-created class <code>NewClass</code> without a constructor. Now, using two instances and two classes, new and old ones, we can manipulate instance attributes to distribute them between <code>newInstance</code> — for read-write instance attributes and <code>NewClass</code> — for read-only properties replacing instance attributes:</p>
<div class="pre-lang" id="premain8330"><div>Python</div><div class="pre-action-link"><span class="code-collapse" data-index="8330" id="preShrink8330">Shrink ▲</span> &nbsp; <span class="copy-code" data-index="8330" id="copycode8330" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve">
<g>
<path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272
    c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729
    c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path>
<path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272
    c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068
    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001
    C291.206,428.715,289.92,430,288.341,430z"></path>	
</g>
</svg></span></div></div><pre lang="Python" data-codeblock-processed="true" id="pre8330" style="margin-top: 0px;" class="notranslate"><span class="code-keyword">class</span> DefinitionSet:
    attributeContainerName = <span class="code-string">"</span><span class="code-string">."</span>

<span class="code-keyword">class</span> Readonly(type):

    <span class="code-keyword">class</span> Attribute(object):
        <span class="code-keyword">def</span> __init__(self, value):
            self.value = value

    <span class="code-sdkkeyword">@classmethod</span>
    <span class="code-keyword">def</span> Base(cls): <span class="code-comment">#</span><span class="code-comment"> base class with access control of class attribute</span>
        <span class="code-keyword">return</span> Readonly(str(), (), {})
    
    <span class="code-keyword">def</span> __new__(metaclass, className, bases, classDictionary):
        <span class="code-keyword">def</span> getAttrFromClass(attr):
            <span class="code-keyword">return</span> <span class="code-keyword">lambda</span> cls: getattr(type(cls), DefinitionSet.attributeContainerName)[attr]
        <span class="code-keyword">class</span> NewMetaclass(metaclass):
            setattr(metaclass, DefinitionSet.attributeContainerName, {})
            <span class="code-keyword">def</span> __call__(cls, *args, **kwargs):
                instance = type.__call__(cls, *args, **kwargs)
                newClass = metaclass(cls.__name__, cls.__bases__, {})
                newInstance = type.__call__(newClass)
                setattr(newClass, DefinitionSet.attributeContainerName, {})
                names = dir(instance)
                <span class="code-keyword">for</span> name <span class="code-keyword">in</span> names:
                    <span class="code-keyword">if</span> hasattr(cls, name):
                        <span class="code-keyword">continue</span>
                    value = getattr(instance, name)
                    <span class="code-keyword">if</span> isinstance(value, metaclass.Attribute):
                        <span class="code-keyword">if</span> hasattr(newInstance, name):
                            delattr(newInstance, name)
                        getattr(
                            newClass,
                            DefinitionSet.attributeContainerName)[name] = value.value
                        aProperty = <span class="code-keyword">property</span>(getAttrFromClass(name))
                        setattr(newClass, name, aProperty)
                    <span class="code-keyword">else</span>:
                        setattr(newInstance, name, getattr(instance, name))
                <span class="code-keyword">return</span> newInstance
        clone = dict(classDictionary)
        <span class="code-keyword">for</span> name, value <span class="code-keyword">in</span> clone.items():
            <span class="code-keyword">if</span> <span class="code-keyword">not</span> isinstance(value, metaclass.Attribute):
                <span class="code-keyword">continue</span>;
            getattr(NewMetaclass, DefinitionSet.attributeContainerName)[name] = value.value
            aProperty = <span class="code-keyword">property</span>(getAttrFromClass(name))
            setattr(NewMetaclass, name, aProperty)
            classDictionary[name] = aProperty
            classDictionary.pop(name, <span class="code-keyword">None</span>)               
        <span class="code-keyword">return</span> type.__new__(NewMetaclass, className, bases, classDictionary)</pre>
<p>Note that <code>getAttrFromClass</code> is reused between different classes, the class of the instance used for implementation of instance read-only properties and for metaclass, used for implementation of class read-only properties. However, the mechanism of the substitution is different.</p>
<p>Another trick is “hiding” the dictionary instance stored in the class and given the attribute name <code>DefinitionSet.attributeContainerName</code>. With such name, this attribute cannot appear as a result of “usual” operation dot-notation syntax, <code>instance.attribute = value</code>; it can only be operated via the methods <code>getattr/setattr/delattr/hasattr</code>. This seems to be really important, because it helps to avoid all possible collision with user attributes based on dot notation, even if the user uses attribute names with any number of underscores. This way, the implementation does not rely on any kind of naming conventions, so typical for Python developers.</p>
<h2 id="heading.versions">Versions</h2>
<p><strong>v.1.0.0</strong>: Initial fully-functional version.<br>
<strong>v.1.0.1</strong>: Minor fixes.<br>
<strong>v.2.0.0</strong>: Stable version; Demo comes with Python 2 and 3 unification <a href="#heading.unification-of-python-2-and-3-in-the-demo">explained above</a>.<br>
<strong>v.3.0.0</strong>: Major <a href="#heading.generalized-solution">generalization</a> of the mechanism to both class and instance attributes.</p>

<!-- Article Ends -->


						</div>
						

						
						<h2>License</h2>
						<div id="LicenseTerms"><p>This article has no explicit license attached to it but may contain usage terms in the article text or the download files themselves. If in doubt please contact the author via the discussion board below.</p><p>A list of licenses authors might use can be found <a href="https://www.codeproject.com/info/Licenses.aspx">here</a></p></div>
						

						
						<br>
						
						    <br>
						
						

						<div class="clearfix"></div>

						<div style="padding-top:8px">
							
						</div>

					

				    
					</form>

				</div>

				
				<div class="bottom-promo"> 
				    
				</div>
				
                
                

				
				
				

			</div>
			

            
            
            

        </div>
        

		
		<div class="site-footer">
			<div class="align-left">
				<a id="ctl00_PermaLink" href="https://www.codeproject.com/Articles/1227368/Python-Readonly-Attributes-Complete-Solution">Permalink</a><br>
				<br>
				<a id="ctl00_PrivacyLink" href="https://www.codeproject.com/info/privacy.aspx">Privacy</a><br>
    			<a id="ctl00_CookiePolicyLink" href="https://www.codeproject.com/info/cookie.aspx">Cookies</a><br>
                <a id="ctl00_TermsOfUseLink" href="https://www.codeproject.com/info/TermsOfUse.aspx">Terms of Use</a><br>
			</div>

            <div class="align-center">
				


<div class="page-width">
    Layout: <a id="ctl00_PageWidth_FixedT" title="Fixed width layout" rel="nofollow" class=" active" href="https://www.codeproject.com/Articles/1227368/Python-Readonly-Attributes-Complete-Solution?PageFlow=FixedWidth">fixed</a>
    |
    <a id="ctl00_PageWidth_FluidT" title="Fluid layout" rel="nofollow" href="https://www.codeproject.com/Articles/1227368/Python-Readonly-Attributes-Complete-Solution?PageFlow=Fluid">fluid</a>
</div>


				

				

	            

                <br>
			</div>
                
			<div class="align-right">
				Article Copyright 2018 by Sergey Alexandrovich Kryukov<br>Everything else
				Copyright © <a href="mailto:webmaster@codeproject.com">CodeProject</a>, 1999-2024<br>
                <br>
				Web01 
				2.8:2024-12-08:1<br>
			</div>
		</div>
		

		<br clear="all">
		
			

	</div> 
	</div> 
</div>







<script type="text/javascript"> // DEFERRED script

document.addEventListener('DOMContentLoaded', function() {

	new CodeBlocks().initialise('#contentdiv');
	
	$('.author-wrapper .description').shorten({showChars: 400});
	
	anchorAnimate();
	
	$('#__EVENTVALIDATION').attr('autocomplete', 'off');

})
</script>










<style type="text/css">.copied::after {  position: absolute;  right: 0;  display: inline-block; white-space: nowrap; content: 'copied'; color: #fff; background-color: #f90;  border-radius: 3px; padding:1px 8px; opacity: 0;  will-change: opacity, transform; animation: showcopied 1.5s ease; } @keyframes showcopied { 0% { opacity: 0; } 70% { opacity: 1; } 100% { opacity: 0; } } </style><canvas id="cv1" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas><canvas id="cv2" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas></body><grammarly-desktop-integration data-grammarly-shadow-root="true"><template shadowrootmode="open"><style>
      div.grammarly-desktop-integration {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
        -moz-user-select: none;
        -webkit-user-select: none;
        -ms-user-select:none;
        user-select:none;
      }

      div.grammarly-desktop-integration:before {
        content: attr(data-content);
      }
    </style><div aria-label="grammarly-integration" role="group" tabindex="-1" class="grammarly-desktop-integration" data-content="{&quot;mode&quot;:&quot;full&quot;,&quot;isActive&quot;:true,&quot;isUserDisabled&quot;:false}"></div></template></grammarly-desktop-integration></html>