<!DOCTYPE html>
<!-- saved from url=(0090)https://www.codeproject.com/Articles/814903/Practical-Sound-Recorder-with-Sound-Activation -->
<html lang="en" data-lt-installed="true"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

	
	<link rel="preconnect" href="https://www.google-analytics.com/">

	<link rel="preconnect" href="https://www.codeproject.com/">


	<link rel="preload" href="./Resources/logo250x135.gif" as="image">


	<link rel="preload" href="https://www.codeproject.com/App_Themes/CodeProject/Img/logo135-bg.gif" as="image">
	<link rel="preload" href="./Resources/jquery-3.4.1.min.js.download" as="script" type="text/javascript">


	<title>Practical Sound Recorder with Sound Activation- CodeProject</title> 
    
	<link type="text/css" rel="stylesheet" href="./Resources/Article.min.css">


    <script type="text/javascript" async="" src="./Resources/analytics.js.download"></script><script type="text/javascript" src="./Resources/jquery-3.4.1.min.js.download" defer=""></script>
<script type="text/javascript" src="./Resources/article.min.js.download" defer=""></script>

	
<meta http-equiv="content-language" content="en-US">

<meta name="Description" content="The convenience of this Sound Recorder is defined by its minimalism and understanding of the purpose">
<meta name="Keywords" content="VS2008, C#, .NET, Visual-Studio, HTML, CEO, Architect, Dev, WPF, Design, Beginner, Intermediate">
<meta name="Author" content="Sergey Alexandrovich Kryukov">
<meta name="Rating" content="General">
<meta name="Revisit-After" content="1 days">
<meta name="application-name" content="CodeProject">
<meta name="google-translate-customization" content="d908bb7ce7aff658-4c2f3a504525c916-g629383f736781a8a-13">



<link rel="dns-prefetch" href="https://ajax.googleapis.com/"> 
<link rel="canonical" href="https://www.codeproject.com/Articles/814903/Practical-Sound-Recorder-with-Sound-Activation">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@CodeProject">
<meta name="og:site_name" content="CodeProject">
<meta name="twitter:creator" content="@CodeProject">
<meta property="og:type" content="article">
<meta property="article:published_time" content="9/3/2014 5:44:00 PM">
<meta property="article:modified_time" content="3/11/2017 11:31:00 PM">
<meta name="twitter:label1" content="Written by">
<meta name="twitter:data1" content="Sergey Alexandrovich Kryukov">
<meta name="twitter:label2" content="Reading time">
<meta name="twitter:data2" content="12 min read">
<meta property="og:url" content="https://www.codeproject.com/Articles/814903/Practical-Sound-Recorder-with-Sound-Activation">
<meta property="og:title" content="Practical Sound Recorder with Sound Activation">
<meta property="og:description" content="The convenience of this Sound Recorder is defined by its minimalism and understanding of the purpose">


<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="apple-touch-icon" sizes="144x144" href="https://www.codeproject.com/favicon/apple-touch-icon.png"> 
<link rel="icon" type="image/png" sizes="32x32" href="https://www.codeproject.com/favicon/favicon-32x32.png"> 
<link rel="icon" type="image/png" sizes="16x16" href="https://www.codeproject.com/favicon/favicon-16x16.png"> 
<link rel="manifest" href="https://www.codeproject.com/favicon/manifest.json"> 
<link rel="mask-icon" href="https://www.codeproject.com/favicon/safari-pinned-tab.svg" color="#ff9900">
	<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "TechArticle",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.codeproject.com/Articles/814903/Practical-Sound-Recorder-with-Sound-Activation"
   },
  "name": "Practical Sound Recorder with Sound Activation",
  "headline": "Practical Sound Recorder with Sound Activation",
  "url": "https://www.codeproject.com/Articles/814903/Practical-Sound-Recorder-with-Sound-Activation",
  "discussionUrl": "#_comments",
  "isFamilyFriendly": "true",
  "image": "https://www.codeproject.com/App_Themes/CodeProject/Img/Article100.png",
  "keywords": "VS2008,C#,.NET,Visual-Studio,HTML,CEO,Architect,Dev,WPF,Design,Beginner,Intermediate",
  "commentCount": "0",
  "editor" : {
    "@type" : "Person",
    "name" : "Editor",
    "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=2291164"
  },
  "license": "http://www.codeproject.com/info/cpol10.aspx",
  "publisher" : {
    "@type" : "Organization",
    "name" : "CodeProject"
  },
  "description": "The convenience of this Sound Recorder is defined by its minimalism and understanding of the purpose",
  "articleSection": "HTML",
  "author" : [{
      "@type" : "Person",
      "name" : "Sergey Alexandrovich Kryukov",
      "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=2291164"
    }],
  "datePublished": "2014-09-03",
  "dateCreated": "2014-09-03",
  "dateModified": "2017-03-11"
,
  "contentRating" : {
    "@type" : "Rating",
    "ratingValue" : 4.88,
    "bestRating" : 5,
    "worstRating" : 1
  }
}</script>

<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
    "@type": "ListItem",
    "position": 1,
    "item" : {
      "@id" : "/script/Content/Tag.aspx?tags=web",
      "name" : "web"
    }
  },{
    "@type": "ListItem",
    "position": 2,
    "item" : {
      "@id" : "/script/Content/Tag.aspx?tags=HTML",
      "name" : "HTML"
    }
  }]
}</script>

<script type="text/javascript">
function defrm () { /* thanks twitter */
    document.write = '';
    window.top.location = window.self.location;
    setTimeout(function() { document.body.innerHTML = ''; }, 0);
    window.self.onload = function(evt) { document.body.innerHTML = ''; };
}

if (window.top !== window.self) {
    try {
        if (window.top.location.host) { /* will throw for all except chrome */ }
        else { defrm(); /* chrome */ }
    } catch (ex) { defrm(); /* everyone else */ }
}

// Specific case where a site is screwing with us.
if (typeof(DemoUrl) !== 'undefined') {
    document.write(unescape('%3Cme') + 'ta http' + '-equiv="re' + 'fresh con' +
                           'tent="1;url=' + DemoUrl + unescape('"%3CE'));
}
</script>
	





    <script async="" type="text/javascript" src="./Resources/js"></script>
    <script type="text/javascript">
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-1735123-1' , {'user_id': '42a7d533-9829-4f88-8fc6-84dc936250c9'});
    </script>

<style type="text/css"></style></head>	

<body class="chrome chrome120" data-new-gr-c-s-check-loaded="14.1215.0" data-gr-ext-installed="">



<a class="access-link" href="#Main"><img alt="Click here to Skip to main content" src="./Resources/t.gif"></a>




<div class="page-background">

	
	

	

	
    <div id="ctl00_STM" class="site-top-menu fixed narrow">
        <div class="main-content">
            

<div class="container memberbar clearfix flex-container flex-extend">

	<div id="ctl00_MemberBar_GenInfo" class="flex-item align-left">65,938 articles</div>
	
	<div id="ctl00_MemberBar_ChangeNotice" class="flex-item align-left">CodeProject
	is changing. <a href="https://www.codeproject.com/info/Changes.aspx">Read more</a>.</div>

	<div class="flex-item">
		
	</div>

	<div class="flex-item align-right">

		

		

		
	</div>
</div>
        </div>
    </div>

	
    <div id="ctl00_SH" class="site-header fixed narrow">
        <div class="main-content">
            <div class="logo"><a href="https://www.codeproject.com/"><img id="ctl00_Logo" tabindex="1" title="CodeProject" src="./Resources/logo250x135.gif" alt="Home" style="height:135px;width:250px;border-width:0px;"></a></div>
            <div class="promo"></div>
        </div>
    </div>

	
			
	

	<div id="A" class="container-content-wrap fixed narrow"> 

	<div class="container-content">

        
		<div class="clearfix">
			<div class="container-breadcrumb float-left ">
				<div><a rel="nofollow" href="https://www.codeproject.com/script/Content/SiteMap.aspx">Articles</a> / <a rel="nofollow" href="https://www.codeproject.com/script/Content/Tag.aspx?tags=web">web</a> / <a rel="nofollow" href="https://www.codeproject.com/script/Content/Tag.aspx?tags=HTML">HTML</a></div>
			</div>

            <div class="float-left">
				
			</div>

			<div class="edit-links float-right">
				



 
&nbsp;










			</div>

			<div class="article-nav float-right">
				


<div style="display:inline-block;position:relative;top:-6px;margin-right:20px">
    
</div>



 

<a id="ctl00_ActionLinks_PrintMd" data-tooltip="Print" data-enabletooltip="true" data-width="auto" href="https://www.codeproject.com/Articles/814903/Practical-Sound-Recorder-with-Sound-Activation?display=Print" class="tooltip" title="">
   <img src="./Resources/print48.png" width="24" height="24" style="border:0">
<div class="speech-bubble-container-up" style="width:auto">  <div class="speech-bubble-up" style="text-align:center"> Print</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>



<span id="ctl00_ActionLinks_R">
    
    
</span>
			</div>
		</div>

        
		<div class="extended article-container-parts">

			
		    
            

			
			<div id="AT" class="article-container  fixed narrow" style="max-width:inherit;"> 

				<div class="article">

					<form name="aspnetForm" method="post" action="https://www.codeproject.com/Articles/814903/View.aspx" id="aspnetForm" style="margin:0;padding:0">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="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">
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="10C1FD69">
</div>

					
					 
					<div class="header">
					    <a name="Main"></a>
					    <a name="_articleTop" id="_articleTop"></a>

					    
						<div>
							<span id="ctl00_TagListHorz_TagWrp" class="tags horizontal">

	
	

	
	<span id="ctl00_TagListHorz_VisibleTags"><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/VS2008" data-id="77">VS2008</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/Csharp" data-id="81">C#</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/.NET" data-id="98">.NET</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/Visual-Studio" data-id="103">Visual-Studio</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/HTML" data-id="104">HTML</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/WPF" data-id="140">WPF</a></div></span> 

	
	
</span>


						</div>
					    <div class="title">
					        <h1 id="ctl00_ArticleTitle">Practical Sound Recorder with Sound Activation</h1>
					    </div>

                        <div>
					        
					        <div class="entry flex-container">

								

                                <div class="flex-item" style="flex:1 1 auto">
                                    <div class="flex-container" style="justify-content:space-between;flex-wrap:wrap-reverse">
                                       <span id="ctl00_Authors" class="author flex-item"><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=2291164" rel="author">Sergey Alexandrovich Kryukov</a></span> 

                                        <div class="flex-item" style="margin-top:-4px;">
                                            <div id="ctl00_RateArticle_RatingTable" class="small-text" data-objectref="2_814903">

	<meta itemprop="upvoteCount" content="51">


	<div id="ctl00_RateArticle_RatingRow" class="flex-container rating-container large-stars">

					
		

		
		<div class="nowrap tooltip">

			
			<div id="ctl00_RateArticle_ResultNoHist" class="rating-result"><div class="flex-container rating-stars large-stars"><div><img src="./Resources/star-fill-lg.png" style="width:24px;height:24px"></div><div><img src="./Resources/star-fill-lg.png" style="width:24px;height:24px"></div><div><img src="./Resources/star-fill-lg.png" style="width:24px;height:24px"></div><div><img src="./Resources/star-fill-lg.png" style="width:24px;height:24px"></div><div style="width:21px;" class="clipped"><img src="./Resources/star-fill-lg.png" style="width:24px;height:24px"></div><div style="width:3px;position:relative" class="clipped"><img src="./Resources/star-empty-lg.png" style="width:24px;height:24px;position:absolute;top:0px;right:0"></div></div></div>
			

			
			

			
            

			
                

		</div>
		
	
		
		<div id="ctl00_RateArticle_VoteCountNoHist" class="rating-votes nowrap">4.88/5  (54 votes)</div>	

		

		
		<div class="rating-undo" title="Undo vote" style="margin-left:5px;display:none"></div>

		
		
	</div>

	
	

</div>

                                        </div>
                                    </div>

                                    <div class="flex-container" style="color:#666;font-size:smaller">
                                        <span id="ctl00_LastUpdated" class="date flex-item-tight" title="Date last updated">3 Sep 2014</span><a id="ctl00_LicenseLink" title="The Code Project Open License (CPOL)" class="license flex-item-tight" href="http://www.codeproject.com/info/cpol10.aspx">CPOL</a><span id="ctl00_ReadingTime" class="stats flex-item-tight">12 min read</span><span id="ctl00_HorizontalStats" class="stats flex-item-tight"><span class="stats"><span title="Views"><img src="./Resources/views32.png" style="width:16px"> 92.8K</span> &nbsp; <span title="Downloads"><img src="./Resources/download32.png" style="width:16px"> 3.9K</span> &nbsp; </span></span>
                                    </div>
                                </div>
					        </div>

                            

                        </div>

                        <div id="ctl00_DescriptionSpot" class="summary">The convenience of this Sound Recorder is defined by its minimalism and understanding of the purpose</div><span id="ctl00_ThumbnailUrl" class="date" content="https://www.codeproject.com/script/Articles/Images/article100x80.png"></span>			

                    </div>
                    
					
					

					

					
					

					
					

						
					

					

						
						<div id="contentdiv" class="text">
						



<!-- Article Starts -->

<ul class="download">
	<li><a href="Practical-Sound-Recorder-with-Sound-Activation.zip" style="">Download source code — 45.3 KB</a>&nbsp;</li></ul>

<p><img title="Sound Recorder" alt="2014-09-03.Practical-Sound-Recorder-with-Sound-Activation.webp" src="./Resources-articles/2014-09-03.Practical-Sound-Recorder-with-Sound-Activation.webp"/>&nbsp;<img title="About Sound Recorder" alt="2014-09-03.Practical-Sound-Recorder-with-Sound-Activation.about.webp" src="./Resources-articles/2014-09-03.Practical-Sound-Recorder-with-Sound-Activation.about.webp"/></p>

<h2>Table of Contents</h2>

<ul style="list-style-type: none; list-style-image: initial">
	<li><a href="#a1"><u>1. Sentiments</u></a></li>	<li><a href="#a2"><u>2. Operation</u></a></li>	<li><a href="#a3"><u>3. Key Implementation Detail</u></a>
	<ul style="list-style-type: none; list-style-image: initial; margin-top: 0; margin-bottom: 0">
		<li><a href="#a3.1"><u>3.1. The Strip Indicator</u></a></li>		<li><a href="#a3.2"><u>3.2. Using characters Instead of Bitmaps</u></a></li>		<li><a href="#a3.3"><u>3.3. Vector Graphics for the Logo</u></a></li>		<li><a href="#a3.4"><u>3.4. Some Funny Peculiarities</u></a></li>	</ul>
	</li>	<li><a href="#a4"><u>4. Application Build and Compatibility</u></a></li>	<li><a href="#a5"><u>5. Future Work</u></a></li>	<li><a href="#a6"><u>6. Conclusions</u></a></li></ul>

<h2 id="a1">1 Sentiments</h2>

<p>Software developers are often blamed for lack of understanding of the application field and narrow "programming" point of view. Is it fair? Well, sometime it reflects the ignorance of the people blaming software developers, but in some cases, this is a holy truth. All narrow specialists are limited. It is easier to find a good software development utility than anything domain-oriented in a narrow field of application. Some say, the best software is the software developed for one's own consumption. I think that's true.</p>

<p>Take those sound recorders, nearly all of off them. I don't mean those which come as a part of some sophisticated sound editors. They can do really serious job: visualization, all kinds of on-the-fly filtering, and a lot more. I mean something simple, like most of those recorders, like the one which comes with Windows. If you try to use it for any practical purpose, you will see that the author never tried to record anything for some real purpose different from testing of this piece of software.</p>

<p>A person who would immediately see that the tool is unusable could be, say, a musician trying to record those rehearsals to hear how it sounds and fix the problems. A person who wants to record a brainstorm on the meeting will also see the problem, but let's come back to a musician.</p>

<p>A musician holds a saxophone with both hands. A violin… A guitar… This person doesn't want to reach for the computer and do too much to get each record. This person wants to play the piece once again, because the previous one was almost perfect, but the string slightly slipped off the finger, so that signature brilliant bend was not so pronounced and touching as planned. So the piece should be repeated again. And again…</p>

<p>The need for sound activation is pretty obvious and well recognized, but this is not about just the sound activation. Clicking on the mouse… Operating file browser dialog and typing the file name for the next record in who-knows-which directory. Clicking all those "record", "stop" and "save" over and over. Come on.</p>

<p>Let's see if it can be done in some practically convenient way, from the standpoint of a person recoding a lot of samples, not from the standpoint of the developer of the tool.</p>

<h2 id="a2">2 Operation</h2>

<p>Actually, there is nothing sophisticated or difficult. This is just a matter of some common sense. It is actually very simple. First and foremost, with some appropriate set of options, the record can be stopped and saved in just one hit, one the wide and easy-to-reach blank-space key. It will (again, optionally) restart the recording and save the previous one. Hence, the file names are never typed. They are created based on some preliminary defined base file name, with sequential numbers, but the way preventing overwriting of any previously written files.</p>

<p>And then, what’s up with optional sound activation? It is determined by a threshold positioned on the sound volume indicator control. It is done visually. When the sound volume goes beyond the vertical bar (which is set to positive infinite value and not visible at startup, but can be moved onto the volume indicator), the recoding is activated. The state is shown by the blinking indicator, a digital watch showing "pure" (without pauses) elapsed time, as well as the <code>IsEnabled</code> states of the buttons.</p>

<p>In a nutshell, that's all. The operation is described on the help screen of the application; only the delicate detail, as basic operation is self-explanatory. The pictures on the top show the "About" box and least expanded view of the main window, which holds all the controls in one place. This is how it looks with two when both <code>Expander</code> controls are expanded:</p>

<p><img src="./Resources/soundRecorderExpanded.png"></p>

<p>Those two <code>Expander</code> controls show the options which are not changed often and not needed to be shown during repetitive recordings. Note that the sound activation threshold is kept handy, because adjusting it several times could be needed.</p>

<p>The important sound activation option under the top expander shows important parameter: the delay between detecting of the activating sound and activation of recording. This is needed to cut out the sound used for activation from the record. This technique works fairly well, and the default value of 200 ms works reasonably well, at least for the first approximation.</p>

<p>The question is: why not sound deactivation, deactivation be a period of silence? I was skeptical about it, but still tried. No, it would be utterly impractical, would cause frustrating false positives all the time. Another excuse for not doing it would be this: it's easier and faster to cut out unwanted piece of record from the end.&lt;&lt;/p&gt;</p>

<p>How about voice recognition for activation and deactivation? Would be quite possible; I tried it (not on this application). It can be a matter of taste, but I think it would also be impractical: even very few false positives and false negatives will greatly irritate. Perhaps it could do better for recoding of meetings. Anyone is welcome to try it.</p>

<p>To me, convenience is, first of all, minimalism. Nothing should distract from the main thing. How about different file types: MP3, AAC, WMA, and so on? No. If you really want to do good recording, you are not trusting embedded encoders. Who knows what they do? You will want WAV and compress them the way you want, only some selected files. Again, feature set is the matter of discussion, but I have pretty strict priorities. Of course, any kind of criticism and advice will be quite welcome, as always.</p>

<p>I also wanted to discuss a bit the persistence of the preferences. They can be saved in a file, this is clear. Predefined area per user in "Users" directory? No. I find it important to create, if possible, the applications which leave minimal to no trace on the target system and don't require installation. The user saves the file in a directory of one's choice and the preferences can be loaded later. Importantly, the base file can have the directory ".\", which means that the files can be saved to any current directory, whatever it is.</p>

<p>Can the preferences be loaded automatically? Sure. It happens in the following priority:</p>

<ol>
	<li>If the preference file name is given in the command line and exists, this file is loaded. It is convenient to make batch files to start the application with different preferences.</li>	<li>Otherwise, if the file with the "Default" name is found in the working directory before starting of the application, it will be loaded.</li>	<li>Otherwise, if the file with the "Default" name is found in the executable directory of the application, it is loaded.</li></ol>

<p>These rules provide maximum flexibility.</p>

<h2 id="a3">3 Key Implementation Detail</h2>

<p>Due to the simplicity of the tool, implementation is quite trivial. Here is the core implementation of the recording, based on "winmm.dll" and P/Invoke:</p>

<div class="pre-lang" id="premain631478"><div>C#</div><div class="pre-action-link"><span class="code-collapse" data-index="631478" id="preShrink631478">Shrink ▲</span> &nbsp; <span id="copycode631478" class="copy-code" data-index="631478" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre631478" style="margin-top:0;" class="lang-csharp notranslate" data-language="cs" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-keyword">using</span> System;
<span class="code-keyword">using</span> System.Text;
<span class="code-keyword">using</span> System.Runtime.InteropServices;
<span class="code-keyword">using</span> System.Threading;

<span class="code-keyword">internal</span> <span class="code-keyword">static</span> <span class="code-keyword">class</span> Mci {

    <span class="code-keyword">static</span> <span class="code-keyword">class</span> DefinitionSet {
        <span class="code-keyword">internal</span> <span class="code-keyword">const</span> <span class="code-keyword">string</span> DllName = <span class="code-string">"</span><span class="code-string">winmm.dll"</span>;
        <span class="code-keyword">internal</span> <span class="code-keyword">const</span> <span class="code-keyword">string</span> LevelMeterDeviceId = <span class="code-string">"</span><span class="code-string">soundLevelMeterDevice"</span>;
        <span class="code-keyword">internal</span> <span class="code-keyword">const</span> <span class="code-keyword">string</span> SoundRecordDeviceId = <span class="code-string">"</span><span class="code-string">soundRecordDevice"</span>;
        <span class="code-keyword">internal</span> <span class="code-keyword">const</span> <span class="code-keyword">string</span> OpenCommandFormat =
            <span class="code-string">"</span><span class="code-string">open new type waveaudio alias {0}"</span>;
        <span class="code-keyword">internal</span> <span class="code-keyword">const</span> <span class="code-keyword">string</span> StatusLevelCommandFormat = <span class="code-string">"</span><span class="code-string">status {0} level"</span>;
        <span class="code-keyword">internal</span> <span class="code-keyword">const</span> <span class="code-keyword">string</span> RecordCommandFormat = <span class="code-string">"</span><span class="code-string">record {0}"</span>;
        <span class="code-keyword">internal</span> <span class="code-keyword">const</span> <span class="code-keyword">string</span> PauseCommandFormat = <span class="code-string">"</span><span class="code-string">pause {0}"</span>;
        <span class="code-keyword">internal</span> <span class="code-keyword">const</span> <span class="code-keyword">string</span> StopCommandFormat = <span class="code-string">"</span><span class="code-string">stop {0}"</span>;
        <span class="code-keyword">internal</span> <span class="code-keyword">const</span> <span class="code-keyword">string</span> CloseCommandFormat = <span class="code-string">"</span><span class="code-string">close {0}"</span>;
        <span class="code-keyword">internal</span> <span class="code-keyword">const</span> <span class="code-keyword">string</span> SaveCommandFormatFormat =
            <span class="code-string">@"</span><span class="code-string">save {0} ""{{0}}"""</span>;
        <span class="code-keyword">internal</span> <span class="code-keyword">static</span> <span class="code-keyword">readonly</span> <span class="code-keyword">string</span> OpenLevelMeterCommand =
            <span class="code-keyword">string</span>.Format(OpenCommandFormat, LevelMeterDeviceId);
        <span class="code-keyword">internal</span> <span class="code-keyword">static</span> <span class="code-keyword">readonly</span> <span class="code-keyword">string</span> OpenRecorderCommand =
            <span class="code-keyword">string</span>.Format(OpenCommandFormat, SoundRecordDeviceId);
        <span class="code-keyword">internal</span> <span class="code-keyword">static</span> <span class="code-keyword">readonly</span> <span class="code-keyword">string</span> StatusLevelCommand =
            <span class="code-keyword">string</span>.Format(StatusLevelCommandFormat, LevelMeterDeviceId);
        <span class="code-keyword">internal</span> <span class="code-keyword">static</span> <span class="code-keyword">readonly</span> <span class="code-keyword">string</span> RecordCommand =
            <span class="code-keyword">string</span>.Format(RecordCommandFormat, SoundRecordDeviceId);
        <span class="code-keyword">internal</span> <span class="code-keyword">static</span> <span class="code-keyword">readonly</span> <span class="code-keyword">string</span> PauseCommand =
            <span class="code-keyword">string</span>.Format(PauseCommandFormat, SoundRecordDeviceId);
        <span class="code-keyword">internal</span> <span class="code-keyword">static</span> <span class="code-keyword">readonly</span> <span class="code-keyword">string</span> StopCommand =
            <span class="code-keyword">string</span>.Format(StopCommandFormat, SoundRecordDeviceId);
        <span class="code-keyword">internal</span> <span class="code-keyword">static</span> <span class="code-keyword">readonly</span> <span class="code-keyword">string</span> CloseRecorderCommand =
            <span class="code-keyword">string</span>.Format(CloseCommandFormat, SoundRecordDeviceId);
        <span class="code-keyword">internal</span> <span class="code-keyword">static</span> <span class="code-keyword">readonly</span> <span class="code-keyword">string</span> CloseLevelMeterCommand =
            <span class="code-keyword">string</span>.Format(CloseCommandFormat, LevelMeterDeviceId);
        <span class="code-keyword">internal</span> <span class="code-keyword">static</span> <span class="code-keyword">readonly</span> <span class="code-keyword">string</span> SaveCommandFormat =
            <span class="code-keyword">string</span>.Format(SaveCommandFormatFormat, SoundRecordDeviceId);
        <span class="code-keyword">internal</span> <span class="code-keyword">const</span> <span class="code-keyword">int</span> ReturnNumDigits = <span class="code-digit">0x10</span>;
        <span class="code-keyword">internal</span> <span class="code-keyword">const</span> <span class="code-keyword">int</span> MaximumLevel = <span class="code-digit">128</span>; <span class="code-comment">//</span><span class="code-comment">why?</span>
    } <span class="code-comment">//</span><span class="code-comment">DefinitionSet</span>

    <span class="code-keyword">internal</span> <span class="code-keyword">class</span> MciException : ApplicationException {
        <span class="code-keyword">internal</span> MciException(<span class="code-keyword">long</span> mciErrorCode) :
            <span class="code-keyword">base</span> (<span class="code-keyword">string</span>.Format(<span class="code-string">"</span><span class="code-string">MCI error {0}"</span>, mciErrorCode)) {
                <span class="code-keyword">this</span>.MciErrorCode = mciErrorCode; }
        <span class="code-keyword">internal</span> <span class="code-keyword">long</span> MciErrorCode { <span class="code-keyword">get</span>; <span class="code-keyword">private</span> <span class="code-keyword">set</span>; }
    } <span class="code-comment">//</span><span class="code-comment">class MciException</span>

    [DllImport(DefinitionSet.DllName)]
    <span class="code-keyword">private</span> <span class="code-keyword">static</span> <span class="code-keyword">extern</span> <span class="code-keyword">long</span> mciSendString(
        <span class="code-keyword">string</span> strCommand, StringBuilder strReturn, <span class="code-keyword">int</span> iReturnLength, <span class="code-sdkkeyword">IntPtr</span> oCallback);

    <span class="code-keyword">internal</span> <span class="code-keyword">static</span> <span class="code-keyword">void</span> StartLevelMeter() {
        mciSendString(DefinitionSet.OpenLevelMeterCommand, <span class="code-keyword">null</span>, <span class="code-digit">0</span>, <span class="code-sdkkeyword">IntPtr</span>.Zero);
    } <span class="code-comment">//</span><span class="code-comment">StartLevelMeter</span>

    <span class="code-keyword">internal</span> <span class="code-keyword">const</span> <span class="code-keyword">double</span> MaximumLevel = DefinitionSet.MaximumLevel;
    <span class="code-keyword">internal</span> <span class="code-keyword">static</span> <span class="code-keyword">double</span> GetLevel(<span class="code-keyword">int</span> count, <span class="code-keyword">out</span> <span class="code-keyword">double</span> maxLevel, <span class="code-keyword">int</span> delayMs) {
        <span class="code-keyword">double</span> buf = <span class="code-digit">0</span>;
        maxLevel = <span class="code-keyword">double</span>.NegativeInfinity;
        <span class="code-keyword">for</span> (<span class="code-keyword">int</span> index = <span class="code-digit">0</span>; index &lt; count; ++index) {
            StringBuilder sb = <span class="code-keyword">new</span> StringBuilder();
            mciSendString(DefinitionSet.StatusLevelCommand,
                sb, DefinitionSet.ReturnNumDigits, <span class="code-sdkkeyword">IntPtr</span>.Zero);
            <span class="code-keyword">double</span> <span class="code-sdkkeyword">value</span>;
            <span class="code-keyword">if</span> (!double.TryParse(sb.ToString(), <span class="code-keyword">out</span> <span class="code-sdkkeyword">value</span>))
                <span class="code-keyword">return</span> <span class="code-digit">0</span>;
            buf += <span class="code-sdkkeyword">value</span>;
            <span class="code-keyword">if</span> (<span class="code-sdkkeyword">value</span> &gt; maxLevel) maxLevel = <span class="code-sdkkeyword">value</span>;
            System.Threading.Thread.Sleep(delayMs);
        } <span class="code-comment">//</span><span class="code-comment">loop</span>
        <span class="code-keyword">return</span> buf / count;
    } <span class="code-comment">//</span><span class="code-comment">GetLevel</span>
    <span class="code-keyword">internal</span> <span class="code-keyword">static</span> <span class="code-keyword">double</span> GetLevel() {
        <span class="code-keyword">double</span> dummyMax;
        <span class="code-keyword">return</span> GetLevel(<span class="code-digit">1</span>, <span class="code-keyword">out</span> dummyMax, <span class="code-digit">0</span>);
    } <span class="code-comment">//</span><span class="code-comment">GetLevel</span>
    <span class="code-keyword">internal</span> <span class="code-keyword">static</span> <span class="code-keyword">void</span> CloseLevelMeter() {
        mciSendString(DefinitionSet.CloseLevelMeterCommand, <span class="code-keyword">null</span>, <span class="code-digit">0</span>, <span class="code-sdkkeyword">IntPtr</span>.Zero);
    } <span class="code-comment">//</span><span class="code-comment">CloseLevelMeter</span>

    <span class="code-keyword">internal</span> <span class="code-keyword">static</span> <span class="code-keyword">void</span> Open() {
        mciSendString(DefinitionSet.OpenRecorderCommand, <span class="code-keyword">null</span>, <span class="code-digit">0</span>, <span class="code-sdkkeyword">IntPtr</span>.Zero);
    } <span class="code-comment">//</span><span class="code-comment">Open</span>

    <span class="code-keyword">internal</span> <span class="code-keyword">static</span> <span class="code-keyword">void</span> Record() {
        mciSendString(DefinitionSet.RecordCommand, <span class="code-keyword">null</span>, <span class="code-digit">0</span>, <span class="code-sdkkeyword">IntPtr</span>.Zero);
    } <span class="code-comment">//</span><span class="code-comment">Record</span>

    <span class="code-keyword">internal</span> <span class="code-keyword">static</span> <span class="code-keyword">void</span> Pause() {
        mciSendString(DefinitionSet.PauseCommand, <span class="code-keyword">null</span>, <span class="code-digit">0</span>, <span class="code-sdkkeyword">IntPtr</span>.Zero);
    } <span class="code-comment">//</span><span class="code-comment">Pause</span>

    <span class="code-keyword">internal</span> <span class="code-keyword">static</span> <span class="code-keyword">void</span> Stop() {
        mciSendString(DefinitionSet.StopCommand, <span class="code-keyword">null</span>, <span class="code-digit">0</span>, <span class="code-sdkkeyword">IntPtr</span>.Zero);
    } <span class="code-comment">//</span><span class="code-comment">Stop</span>

    <span class="code-keyword">internal</span> <span class="code-keyword">static</span> <span class="code-keyword">void</span> Close() {
        mciSendString(DefinitionSet.CloseRecorderCommand, <span class="code-keyword">null</span>, <span class="code-digit">0</span>, <span class="code-sdkkeyword">IntPtr</span>.Zero);
    } <span class="code-comment">//</span><span class="code-comment">Close</span>

    <span class="code-keyword">internal</span> <span class="code-keyword">static</span> <span class="code-keyword">void</span> SaveRecording(<span class="code-keyword">string</span> fileName) {
        mciSendString(
            <span class="code-keyword">string</span>.Format(DefinitionSet.SaveCommandFormat, fileName), <span class="code-keyword">null</span>, <span class="code-digit">0</span>, <span class="code-sdkkeyword">IntPtr</span>.Zero);
    } <span class="code-comment">//</span><span class="code-comment">SaveRecording</span>

} <span class="code-comment">//</span><span class="code-comment">class Mci</span></pre>

<p>Now, here is the idea: the string MCI commands have a parameter called "device ID". They represent some "logical device". Several logical devices can be run on the same channel. The selection of the channel itself is relied on the system selection, which can be done, for example, using the OS volume mixer. In particular, with Windows 7, it is selected by the configuration window "Recoding Devices".</p>

<p>I open two devices, one for the audio "Level Meter", another for recording; please see the string commands <code>DefinitionSet.Open*Command</code> and <code>DefinitionSet.Close*Command</code>. The audio level can be shown in the UI by polling it using the methods <code>GetLevel</code>. Yes, this will certainly keep the CPU busy, means polling, <a href="http://en.wikipedia.org/wiki/Pull_technology"><u>pull technology</u></a> and is not efficient, but there is no other way with this API. So, the application should be used with care, as it consumes the system CPU power permanently.</p>

<p>The recording commands are used immediately in the UI; it is shown in the file "WindowsMain.Actions.cs".</p>

<h3 id="a3.1">3.1 The Strip Indicator</h3>

<p>The volume level is shown in a custom control called <code>StripIndicator</code>. There is one interesting aspect of this control: many, many developers asked on the Web about having something similar. By some funny reasons, they tried to do it based on the class <code>System.Windows.Controls.ProgressBar</code>. The problem was annoying animation shown in this control, which people tried to remove and failed. This "funny reason" is certainly the <i>inertia of thinking</i>. People though that is something looks similar to what they wanted, it should be used with some modifications.</p>

<p>But this is not how WPF works. The even funnier fact is that the solution based on <code>ProgressBar</code> were found, but the were remarkably complex, defining whole styling for the contol in XAML nearly from scratch. At the same time, creation of the similar control using simple primitive the <code>System.Windows.Shapes.Rectangle</code>, is nearly trivial. Besides, it's more flexible, because, for this very application, I also needed the indicator for the volume level set for voice activation of the recording.</p>

<p>I developed a separate more general version of this control, which makes it a really first-class sitizen to be used in XAML, which requires correct use of <i>dependency properties</i>. It is not needed in this application and is a topic for a separate article. I'll try to publish it, because, as the Web search shows, such controls are on high demand. :-)</p>

<p>Please see my article written based on the present one: <a href="http://www.codeproject.com/Articles/814902/The-Problem-of-Unwanted-WPF-ProgressBar-Animation"><u>The Problem of Unwanted WPF ProgressBar Animation: a Clearer Solution</u></a><u>.</u></p>

<h3 id="a3.2">3.2 Using characters Instead of Bitmaps</h3>

<p>WPF icons or images (glyphs used in a window content) are much more flexible that the similar elements in other UI libraries. For example, the icon of a <code>MenuItem</code> or some context of the <code>Button</code> can be the object of any type.</p>

<p>I can to the idea of using… the Unicode characters representing such glyphs. They are perfectly rendered as "Icon" or "Image" objects and can be used instead of "real" bitmaps. In this application, there is no a single bitmap or icon, except the for application icon (see below).</p>

<p>It creates a great benefit: getting rid of the problem of the author's rights for certain images. Indeed, adding images to the application can be awkward: they should be either original or be covered by one or another license. But how to create an original image, for, say, well-known glyphs for "stop", "pause" or "play"? In contrast to that, the use of the characters implemented by the system fonts is covered by the general laws governing software development. We never need to ask permission for output of the text.</p>

<h3 id="a3.3">3.3 Vector Graphics for the Logo</h3>

<p>In a number of my answers, I proposed my way of making vector graphics in a very convenient and maintainable manner. Here is the idea: the graphics is created in the wonderfully light-weight and powerful open-source application, InkScape (<a href="http://en.wikipedia.org/wiki/Inkscape"><u>http://en.wikipedia.org/wiki/Inkscape</u></a>, <a href="http://www.inkscape.org/"><u>http://www.inkscape.org</u></a>).</p>

<p>It allows saving the graphics in XAML file as the <code>Canvas</code> element. The XAML output is manually edited to scale to the parent <code>UIElement</code> and put in any resource dictionary. (Names should be removed, dictionary key for the top <code>Canvas</code> element added.) Then this element can be used in any window or custom control for presentation of dynamically resizable vector graphics. Besides, using access to inner element of the top Canvas element can be easily used for WPF animation or interactive behavior.</p>

<h3 id="a3.4">3.4 Some Funny Peculiarities</h3>

<p>For the very first time, I decided to add the valid Windows application icon also used as a window icon. The icon sizes are 16x16, 32x32, 64x64, 48x48, 96x96 and 128x128. Most of these sizes are really used in different kinds of file views in the system Shell and are represented without scaling. I only used 24-bit pixel formats though. This is the only icon in the application; everything else uses either characters (see above) or purely vector graphics (the product logo is shown in the "About" box as the XAML vector image. Nevertheless, this single icon took 310,398 byte, while the whole executable image, including this icon, takes only 672,256 bytes. That is, the single icon takes more than 46% of the size of the executable.</p>

<p>Needless to say, the same image in the vector form, which is automatically rendered to any size, takes much less memory: about 2K, even though it is embedded in text form in the "About" box XAML.</p>

<p>What did it tells us? Well: big parts of Windows API and the Shell are quite archaic: no vector graphics, not even compression.</p>

<h2 id="a4">4 Application Build and Compatibility</h2>

<p>The work targets minimal possible .NET version: v.3.5. (It could be done even on v.2.0, but I've chosen to use WPF.) It does not require any other libraries, not even DirectSound, nothing which could be considered as optional and be potentially absent.</p>

<p>The solution could be converted to any later version using, for example, Visual Studio.</p>

<p>Neither Visual Studio nor anything else is required to build the solution; the .NET framework itself is enough. The built can be done in a single click using the batch file build.3.5.bat.</p>

<h2 id="a5">5 Future Work</h2>

<p>Frankly, I cannot promise that I ever continue this work. I'll probably do it only if I need some more complex settings. In particular, it would be having more than one input channel, with different channels working at the same time. In this case, the recorder certainly will need selection of the channels in the application, configuring volume balance between channels, and, most likely, a lot more, such as selective filtering on input, different for different channels. And so on…</p>

<p>Adding any complexity to the application will certainly require better API, not the obsolete lame I've described above. I think the first candidate would be <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/bb318665%28v=vs.85%29.aspx"><u>DirectSound</u></a>. Additionally, it will allow adding a reasonable way of playing recorded samples in the application before permanently saving them on disk, and a lot more.</p>

<h2 id="a6">6 Conclusions</h2>

<p>At this moment, the application could serve merely as a replacement of the Sound Recorder which comes with Windows: nearly as minimalistic, but… usable. :-))</p>

<!-- Article Ends -->


						</div>
						

						
						<h2>License</h2>
						<div id="LicenseTerms"><p>This article, along with any associated source code and files, is licensed under <a href="http://www.codeproject.com/info/cpol10.aspx" rel="license">The Code Project Open License (CPOL)</a></p></div>
						

						
						<br>
						
						    <br>
						
						

						<div class="clearfix"></div>

						<div style="padding-top:8px">
							
						</div>

					

				    
					</form>

				</div>

				
				<div class="bottom-promo"> 
				    
				</div>
				
                
                

				
				
				

			</div>
			

            
            
            

        </div>
        

		
		<div class="site-footer">
			<div class="align-left">
				<a id="ctl00_PermaLink" href="https://www.codeproject.com/Articles/814903/Practical-Sound-Recorder-with-Sound-Activation">Permalink</a><br>
				<br>
				<a id="ctl00_PrivacyLink" href="https://www.codeproject.com/info/privacy.aspx">Privacy</a><br>
    			<a id="ctl00_CookiePolicyLink" href="https://www.codeproject.com/info/cookie.aspx">Cookies</a><br>
                <a id="ctl00_TermsOfUseLink" href="https://www.codeproject.com/info/TermsOfUse.aspx">Terms of Use</a><br>
			</div>

            <div class="align-center">
				


<div class="page-width">
    Layout: <a id="ctl00_PageWidth_FixedT" title="Fixed width layout" rel="nofollow" class=" active" href="https://www.codeproject.com/Articles/814903/Practical-Sound-Recorder-with-Sound-Activation?PageFlow=FixedWidth">fixed</a>
    |
    <a id="ctl00_PageWidth_FluidT" title="Fluid layout" rel="nofollow" href="https://www.codeproject.com/Articles/814903/Practical-Sound-Recorder-with-Sound-Activation?PageFlow=Fluid">fluid</a>
</div>


				

				

	            

                <br>
			</div>
                
			<div class="align-right">
				Article Copyright 2014 by Sergey Alexandrovich Kryukov<br>Everything else
				Copyright © <a href="mailto:webmaster@codeproject.com">CodeProject</a>, 1999-2024<br>
                <br>
				Web01 
				2.8:2024-12-08:1<br>
			</div>
		</div>
		

		<br clear="all">
		
			

	</div> 
	</div> 
</div>







<script type="text/javascript"> // DEFERRED script

document.addEventListener('DOMContentLoaded', function() {

	new CodeBlocks().initialise('#contentdiv');
	
	$('.author-wrapper .description').shorten({showChars: 400});
	
	anchorAnimate();
	
	$('#__EVENTVALIDATION').attr('autocomplete', 'off');

})
</script>










<style type="text/css">.copied::after {  position: absolute;  right: 0;  display: inline-block; white-space: nowrap; content: 'copied'; color: #fff; background-color: #f90;  border-radius: 3px; padding:1px 8px; opacity: 0;  will-change: opacity, transform; animation: showcopied 1.5s ease; } @keyframes showcopied { 0% { opacity: 0; } 70% { opacity: 1; } 100% { opacity: 0; } } </style><canvas id="cv1" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas><canvas id="cv2" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas></body><grammarly-desktop-integration data-grammarly-shadow-root="true"><template shadowrootmode="open"><style>
      div.grammarly-desktop-integration {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
        -moz-user-select: none;
        -webkit-user-select: none;
        -ms-user-select:none;
        user-select:none;
      }

      div.grammarly-desktop-integration:before {
        content: attr(data-content);
      }
    </style><div aria-label="grammarly-integration" role="group" tabindex="-1" class="grammarly-desktop-integration" data-content="{&quot;mode&quot;:&quot;full&quot;,&quot;isActive&quot;:true,&quot;isUserDisabled&quot;:false}"></div></template></grammarly-desktop-integration></html>